[Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=1,
          lineno=5,
          tokens=11,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Warning',
          body='class Warning(Exception):\n    """ Database warning\n    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=2,
          lineno=10,
          tokens=14,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Error',
          body='class Error(Exception):\n'
               '    """ Base class for error exceptions\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=3,
          lineno=15,
          tokens=16,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='InterfaceError',
          body='class InterfaceError(Error):\n'
               '    """ Error related to the database interface\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=4,
          lineno=20,
          tokens=16,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseError',
          body='class DatabaseError(Error):\n'
               '    """ Error related to the database engine\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=5,
          lineno=25,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DataError',
          body='class DataError(DatabaseError):\n'
               '    """ Error related to problems with the processed data\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=6,
          lineno=30,
          tokens=22,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='OperationalError',
          body='class OperationalError(DatabaseError):\n'
               '    """ Error related to database operation (disconnect, '
               'memory allocation etc)\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=7,
          lineno=35,
          tokens=16,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='IntegrityError',
          body='class IntegrityError(DatabaseError):\n'
               '    """ Error related to database integrity\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=8,
          lineno=40,
          tokens=17,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='InternalError',
          body='class InternalError(DatabaseError):\n'
               '    """ The database encountered an internal error\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=9,
          lineno=45,
          tokens=24,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='ProgrammingError',
          body='class ProgrammingError(DatabaseError):\n'
               '    """ Error related to database programming (SQL error, '
               'table not found etc)\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=10,
          lineno=50,
          tokens=26,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='NotSupportedError',
          body='class NotSupportedError(DatabaseError):\n'
               '    """ A method or database API was used which is not '
               'supported by the database\n'
               '    """'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=11,
          lineno=1,
          tokens=5,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Exception classes (errors)\n'),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=12,
          lineno=6,
          tokens=4,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Database warning\n    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=13,
          lineno=11,
          tokens=7,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for error exceptions\n    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=14,
          lineno=16,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Error related to the database interface\n    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=15,
          lineno=21,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Error related to the database engine\n    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=16,
          lineno=26,
          tokens=10,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Error related to problems with the processed data\n    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=17,
          lineno=31,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Error related to database operation (disconnect, memory '
               'allocation etc)\n'
               '    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=18,
          lineno=36,
          tokens=7,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Error related to database integrity\n    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=19,
          lineno=41,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' The database encountered an internal error\n    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=20,
          lineno=46,
          tokens=15,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Error related to database programming (SQL error, table not '
               'found etc)\n'
               '    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=21,
          lineno=51,
          tokens=16,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' A method or database API was used which is not supported by '
               'the database\n'
               '    '),
 Fragment(document_cs='05fb5469549a162b81b3d685d590980f7813f2fcd1c6ebbefc3581db5d2d17a6',
          id=22,
          lineno=1,
          tokens=31,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: DataError DatabaseError Error IntegrityError '
               'InterfaceError InternalError NotSupportedError '
               'OperationalError ProgrammingError Warning\n'
               '  Variables and usages: Exception\n'),
 Fragment(document_cs='0a7dd6aaeacfe353707aacff27f423c08a58b62d32ee0a5ee62b93c47d26fefa',
          id=23,
          lineno=1,
          tokens=16,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer.backend.base.format import *from '
               'dblayer.backend.base.format import *'),
 Fragment(document_cs='0a7dd6aaeacfe353707aacff27f423c08a58b62d32ee0a5ee62b93c47d26fefa',
          id=24,
          lineno=1,
          tokens=12,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Variables and usages: backend base dblayer format\n'),
 Fragment(document_cs='0bb4c12c9f8160d508c4e959c7b980907ca6e97000428303a181bba428239863',
          id=25,
          lineno=4,
          tokens=124,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Enable this to debug rolling back to savepoints on '
               'conflicting primary keys##if constants.DEBUG:##    '
               'constants.DATABASE_ID_RANGE = (1, 10)##    '
               'constants.MAX_INSERT_RETRY_COUNT = 3# Database to use for '
               "testingdbname='dblayer' user='dblayer' host='localhost' "
               "password='dblayer'# Enables dropping of the test tables after "
               'running the unit test cases# Regular expressions used by the '
               'test check '
               'constraints^[a-zA-Z_][a-zA-Z_0-9]*$^[\\w\\-\\.]+@[\\w\\-]+(?:\\.[\\w\\-]+)*$'),
 Fragment(document_cs='0bb4c12c9f8160d508c4e959c7b980907ca6e97000428303a181bba428239863',
          id=26,
          lineno=1,
          tokens=20,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Variables and usages: LEAVE_CLEAN_DATABASE RXP_EMAIL '
               'RXP_IDENTIFIER TEST_DSN\n'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=27,
          lineno=12,
          tokens=164,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseColumn',
          body='class BaseColumn:\n'
               '    """ Base class for database column models\n'
               '    """\n'
               '\n'
               '    # Serial number to record the order of column definitions\n'
               '    __definition_serial__ = 0\n'
               '\n'
               '    # Abstract name of the SQL column type\n'
               '    abstract_sql_column_type = None\n'
               '\n'
               '    # Reference to the table class containing this column\n'
               '    # NOTE: Set by __new__ of the table definition class\n'
               '    table_class = None\n'
               '\n'
               '    # Reference to the table instance containing this column '
               'or None for model columns\n'
               '    # NOTE: Filled in by Table.__init__ as part of cloning the '
               'columns from the class to the instance\n'
               '    table = None\n'
               '\n'
               '    # Name of the column\n'
               '    # NOTE: Set by __new__ of the table definition class\n'
               "    name = ''\n"
               '\n'
               '    # Makrs the '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=28,
          lineno=34,
          tokens=220,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseColumn',
          body='primary key column\n'
               '    primary_key = False\n'
               '\n'
               '    # True value indicates that this column is accessible to '
               'Python code\n'
               '    # as a filed on the associated Record subclass\n'
               '    accessible = True\n'
               '\n'
               '    # True value indicates that this column can be NULL (None '
               'in Python)\n'
               '    # NOTE: NOT NULL fields are required only if default is '
               'None.\n'
               '    null = False\n'
               '\n'
               '    # Default value for the column or None\n'
               '    # NOTE: It is a Python value, which will be converted to a '
               'database value.\n'
               '    # NOTE: Setting null=False and default=None makes this a '
               'required field.\n'
               '    default = None\n'
               '\n'
               '    # Documentation\n'
               '    doc = None\n'
               '\n'
               '    # Exclude these parameters from full repr formatting\n'
               '    full_repr_exclude = ()\n'
               '\n'
               '    @staticmethod\n'
               '    def sort_key(obj):\n'
               '        """ Sort key to preserve the lexical definition order\n'
               '        """\n'
               '        return obj.__definition_serial__\n'
               '\n'
               '    @property\n'
               '    def has_custom_default(self):\n'
               '        """ Returns True if the column has an SQL expression '
               'as its default value\n'
               '        """\n'
               '        return isinstance(self.default, '
               'function.BaseFunction)\n'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=29,
          lineno=67,
          tokens=247,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseColumn',
          body='\n'
               '    def __init__(self, doc=None):\n'
               '\n'
               '        assert self.__class__ is not BaseColumn, (\n'
               "            'Only subclasses of BaseColumn can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        # Store column documentation if any\n'
               '        if doc is not None:\n'
               '            self.doc = doc\n'
               '\n'
               '    def __str__(self):\n'
               "        return '<%s Column: %s.%s as %s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name,\n'
               '            self.__class__.__name__)\n'
               '\n'
               '    def __repr__(self):\n'
               '        if self.table is None:\n'
               '            return self.name\n'
               "        return '%s.%s' % (self.table._name, self.name)\n"
               '\n'
               '    def full_repr(self):\n'
               '        """ Gives the full representation, only for use with '
               'class level column definitions\n'
               '        """\n'
               '        fullargspec = inspect.getfullargspec(self.__init__)\n'
               '        args = fullargspec.args\n'
               '        defaults = fullargspec.defaults\n'
               '\n'
               '        arg_iter = iter(args)\n'
               '        next(arg_iter)\n'
               '\n'
               '        formatted_argument_list = []\n'
               '        class_type = type(BaseColumn)\n'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=30,
          lineno=104,
          tokens=127,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseColumn',
          body='        for i in range(len(args) - 1 - len(defaults)):\n'
               '            name = next(arg_iter)\n'
               '            if name in self.full_repr_exclude:\n'
               '                continue\n'
               '            value = getattr(self, name)\n'
               '            if type(value) == class_type:\n'
               "                formatted_argument_list.append('%s' % "
               'value.__name__)\n'
               '            elif isinstance(value, BaseColumn) and '
               'value.table_class is not self.__class__:\n'
               '                formatted_argument_list.append(\n'
               "                    '%s.%s' % (value.table_class.__name__, "
               'value.name))\n'
               '            else:\n'
               '                formatted_argument_list.append(repr(value))\n'
               '\n'
               '        class_type = type(BaseColumn)\n'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=31,
          lineno=118,
          tokens=175,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseColumn',
          body='        for name, default in zip(arg_iter, defaults):\n'
               '            if name in self.full_repr_exclude:\n'
               '                continue\n'
               '            value = getattr(self, name)\n'
               '            if value == default:\n'
               '                continue\n'
               '            if type(value) == class_type:\n'
               "                formatted_argument_list.append('%s=%s' % "
               '(name, value.__name__))\n'
               '            elif isinstance(value, BaseColumn) and '
               'value.table_class is not self.__class__:\n'
               '                formatted_argument_list.append(\n'
               "                    '%s=%s.%s' % (name, "
               'value.table_class.__name__, value.name))\n'
               '            else:\n'
               "                formatted_argument_list.append('%s=%r' % "
               '(name, value))\n'
               '\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(formatted_argument_list))\n"),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=32,
          lineno=136,
          tokens=113,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseColumn',
          body='\n'
               '    def clone(self, table):\n'
               '        """ Clone this column for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__()\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.table = table\n'
               '        return clone\n'
               '\n'
               '    def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        """ Returns list of (name, definition) tuples for the '
               'implicit definitions\n'
               '        required on the table model class level\n'
               '        \n'
               '        """\n'
               '        return []'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=33,
          lineno=156,
          tokens=73,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Custom',
          body='class Custom(BaseColumn):\n'
               '    """ Custom column type\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'Custom'\n"
               '\n'
               '    def __init__(self, sql_type=None, default=None, '
               'null=False, doc=None):\n'
               '        self.sql_type = sql_type\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=34,
          lineno=169,
          tokens=142,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='PrimaryKey',
          body='class PrimaryKey(BaseColumn):\n'
               '    """ Primary key column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'PrimaryKey'\n"
               '    primary_key = True\n'
               '\n'
               '    def __init__(self, serial=False, implicit=True, '
               'doc=None):\n'
               '        self.serial = bool(serial)\n'
               '        self.implicit = bool(implicit)\n'
               '        BaseColumn.__init__(self, doc)\n'
               '\n'
               '        # Move the primary key fields to the top of the column '
               'list\n'
               '        self.__definition_serial__ -= 1000000000\n'
               '\n'
               '    def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        if self.serial or not self.implicit:\n'
               '            return []\n'
               "        return [('pk_%s' % self.name, "
               'constraint.PrimaryKey(self))]'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=35,
          lineno=190,
          tokens=193,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='ForeignKey',
          body='class ForeignKey(BaseColumn):\n'
               '    """ Foreign key column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'ForeignKey'\n"
               '\n'
               '    # Definition of the referenced table\n'
               '    referenced_table_class = None\n'
               '\n'
               '    # Referenced table instance, filled in by '
               'Database.__init__ after\n'
               '    # creating all the database model objects\n'
               '    referenced_table = None\n'
               '\n'
               '    def __init__(self, referenced_table_class=None, '
               'default=None, null=False, implicit=True, doc=None):\n'
               '        # NOTE: The referenced table class can be set to None '
               'and filled later\n'
               '        self.referenced_table_class = referenced_table_class\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        self.implicit = bool(implicit)\n'
               '        BaseColumn.__init__(self, doc)\n'
               '\n'
               '    def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        if not self.implicit:\n'
               '            return []\n'
               "        return [('fk_%s' % self.name, "
               'constraint.ForeignKey(self))]'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=36,
          lineno=217,
          tokens=60,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Boolean',
          body='class Boolean(BaseColumn):\n'
               '    """ Boolean column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'Boolean'\n"
               '\n'
               '    def __init__(self, default=None, null=False, doc=None):\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=37,
          lineno=229,
          tokens=87,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Integer',
          body='class Integer(BaseColumn):\n'
               '    """ Integer column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'Integer'\n"
               '\n'
               '    # Number of digits\n'
               '    digits = None\n'
               '\n'
               '    def __init__(self, digits=None, default=None, null=False, '
               'doc=None):\n'
               '        self.digits = int(digits) if digits else None\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=38,
          lineno=245,
          tokens=93,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Float',
          body='class Float(BaseColumn):\n'
               '    """ Float column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'Float'\n"
               '\n'
               '    # True for double precision (8 bytes), False for single '
               'precision (4 bytes)\n'
               '    size = None\n'
               '\n'
               '    def __init__(self, double=True, default=None, null=False, '
               'doc=None):\n'
               '        self.double = bool(double)\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=39,
          lineno=261,
          tokens=133,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Decimal',
          body='class Decimal(BaseColumn):\n'
               '    """ Decimal column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'Decimal'\n"
               '\n'
               '    # Total number of decimal digits (includes both the '
               'integer and fractional part)\n'
               '    precision = None\n'
               '\n'
               '    # Number of digits after the decimal point (fractional '
               'part)\n'
               '    scale = None\n'
               '\n'
               '    def __init__(self, precision=None, scale=None, '
               'default=None, null=False, doc=None):\n'
               '        self.precision = None if precision is None else '
               'int(precision)\n'
               '        self.scale = None if scale is None else int(scale)\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=40,
          lineno=281,
          tokens=99,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Text',
          body='class Text(BaseColumn):\n'
               '    """ Unicode text column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'Text'\n"
               '\n'
               '    # Maximum number of characters in the string (unicode '
               'characters, not bytes)\n'
               '    maxlength = None\n'
               '\n'
               '    def __init__(self, maxlength=None, default=None, '
               'null=False, doc=None):\n'
               '        self.maxlength = int(maxlength) if maxlength else '
               'None\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=41,
          lineno=297,
          tokens=60,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Date',
          body='class Date(BaseColumn):\n'
               '    """ Date column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'Date'\n"
               '\n'
               '    def __init__(self, default=None, null=False, doc=None):\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=42,
          lineno=309,
          tokens=65,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Datetime',
          body='class Datetime(BaseColumn):\n'
               '    """ Datetime (timestamp) column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'Datetime'\n"
               '\n'
               '    def __init__(self, default=None, null=False, doc=None):\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=43,
          lineno=321,
          tokens=217,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='SearchDocument',
          body='class SearchDocument(BaseColumn):\n'
               '    """ Search document column\n'
               '    """\n'
               '\n'
               "    abstract_sql_column_type = 'SearchDocument'\n"
               '\n'
               '    # Do not add this as a field on the Record subclass, hide '
               'from Python code\n'
               '    accessible = False\n'
               '\n'
               '    # Expression to generate the value of this column from the '
               'other columns.\n'
               '    # It is currently limited to a tuple of columns to '
               'concatenate with space\n'
               '    # separators to build up the search document.\n'
               '    # TODO: Allow for free form expressions using the function '
               'module.\n'
               '    expression = None\n'
               '\n'
               '    def __init__(self, expression=None, implicit=True, '
               'doc=None):\n'
               '        self.expression = expression\n'
               '        self.null = False\n'
               '        self.implicit = bool(implicit)\n'
               '        BaseColumn.__init__(self, doc=doc)\n'
               '\n'
               '    def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        if not self.implicit:\n'
               '            return []\n'
               "        assert self.expression, 'Expression to build up the "
               "search document must be given!'\n"
               "        return [(self.name + '_index', "
               'index.FullTextSearchIndex(*self.expression))]'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=44,
          lineno=4,
          tokens=34,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import inspectimport typesfrom dblayer import utilfrom dblayer '
               'import utilfrom dblayer.model import index, function, '
               'constraintfrom dblayer.model import index, function, '
               'constraint'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=45,
          lineno=13,
          tokens=205,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for database column models\n'
               '    # Serial number to record the order of column definitions# '
               'Abstract name of the SQL column type# Reference to the table '
               'class containing this column# NOTE: Set by __new__ of the '
               'table definition class# Reference to the table instance '
               'containing this column or None for model columns# NOTE: Filled '
               'in by Table.__init__ as part of cloning the columns from the '
               'class to the instance# Name of the column# NOTE: Set by '
               '__new__ of the table definition class# Makrs the primary key '
               'column# True value indicates that this column is accessible to '
               'Python code# as a filed on the associated Record subclass# '
               'True value indicates that this column can be NULL (None in '
               'Python)# NOTE: NOT NULL fields are required only if default is '
               'None.# Default value for the column or None# NOTE: It is a '
               'Python value, which will be converted to a database value.# '
               'NOTE: Setting null=False and default=None makes this a '
               'required field.# Exclude these parameters from full repr '
               'formatting'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=46,
          lineno=58,
          tokens=10,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Sort key to preserve the lexical definition order\n        '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=47,
          lineno=64,
          tokens=15,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns True if the column has an SQL expression as its '
               'default value\n'
               '        '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=48,
          lineno=71,
          tokens=20,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseColumn can be instantiated!# Record the '
               'definition order# Store column documentation if any'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=49,
          lineno=81,
          tokens=13,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='<%s Column: %s.%s as %s>'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=50,
          lineno=93,
          tokens=15,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Gives the full representation, only for use with class level '
               'column definitions\n'
               '        '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=51,
          lineno=138,
          tokens=30,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Clone this column for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=52,
          lineno=149,
          tokens=24,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns list of (name, definition) tuples for the implicit '
               'definitions\n'
               '        required on the table model class level\n'
               '        \n'
               '        '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=53,
          lineno=157,
          tokens=5,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Custom column type\n    '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=54,
          lineno=170,
          tokens=5,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Primary key column\n    '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=55,
          lineno=181,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Move the primary key fields to the top of the column list'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=56,
          lineno=191,
          tokens=32,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Foreign key column\n'
               '    # Definition of the referenced table# Referenced table '
               'instance, filled in by Database.__init__ after# creating all '
               'the database model objects'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=57,
          lineno=204,
          tokens=15,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# NOTE: The referenced table class can be set to None and '
               'filled later'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=58,
          lineno=218,
          tokens=4,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Boolean column\n    '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=59,
          lineno=230,
          tokens=4,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Integer column\n    '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=60,
          lineno=251,
          tokens=17,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# True for double precision (8 bytes), False for single '
               'precision (4 bytes)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=61,
          lineno=262,
          tokens=31,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Decimal column\n'
               '    # Total number of decimal digits (includes both the '
               'integer and fractional part)# Number of digits after the '
               'decimal point (fractional part)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=62,
          lineno=282,
          tokens=20,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Unicode text column\n'
               '    # Maximum number of characters in the string (unicode '
               'characters, not bytes)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=63,
          lineno=310,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Datetime (timestamp) column\n    '),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=64,
          lineno=322,
          tokens=70,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Search document column\n'
               '    # Do not add this as a field on the Record subclass, hide '
               'from Python code# Expression to generate the value of this '
               'column from the other columns.# It is currently limited to a '
               'tuple of columns to concatenate with space# separators to '
               'build up the search document.# TODO: Allow for free form '
               'expressions using the function module.'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=65,
          lineno=345,
          tokens=11,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Expression to build up the search document must be given!'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=66,
          lineno=57,
          tokens=25,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='sort_key',
          body='def sort_key(obj):\n'
               '        """ Sort key to preserve the lexical definition order\n'
               '        """\n'
               '        return obj.__definition_serial__'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=67,
          lineno=63,
          tokens=34,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='has_custom_default',
          body='def has_custom_default(self):\n'
               '        """ Returns True if the column has an SQL expression '
               'as its default value\n'
               '        """\n'
               '        return isinstance(self.default, function.BaseFunction)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=68,
          lineno=68,
          tokens=72,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, doc=None):\n'
               '\n'
               '        assert self.__class__ is not BaseColumn, (\n'
               "            'Only subclasses of BaseColumn can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        # Store column documentation if any\n'
               '        if doc is not None:\n'
               '            self.doc = doc'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=69,
          lineno=80,
          tokens=55,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__str__',
          body='def __str__(self):\n'
               "        return '<%s Column: %s.%s as %s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name,\n'
               '            self.__class__.__name__)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=70,
          lineno=87,
          tokens=35,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               '        if self.table is None:\n'
               '            return self.name\n'
               "        return '%s.%s' % (self.table._name, self.name)"),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=71,
          lineno=92,
          tokens=206,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='full_repr',
          body='def full_repr(self):\n'
               '        """ Gives the full representation, only for use with '
               'class level column definitions\n'
               '        """\n'
               '        fullargspec = inspect.getfullargspec(self.__init__)\n'
               '        args = fullargspec.args\n'
               '        defaults = fullargspec.defaults\n'
               '\n'
               '        arg_iter = iter(args)\n'
               '        next(arg_iter)\n'
               '\n'
               '        formatted_argument_list = []\n'
               '        class_type = type(BaseColumn)\n'
               '        for i in range(len(args) - 1 - len(defaults)):\n'
               '            name = next(arg_iter)\n'
               '            if name in self.full_repr_exclude:\n'
               '                continue\n'
               '            value = getattr(self, name)\n'
               '            if type(value) == class_type:\n'
               "                formatted_argument_list.append('%s' % "
               'value.__name__)\n'
               '            elif isinstance(value, BaseColumn) and '
               'value.table_class is not self.__class__:\n'
               '                formatted_argument_list.append(\n'
               "                    '%s.%s' % (value.table_class.__name__, "
               'value.name))\n'
               '            else:\n'
               '                formatted_argument_list.append(repr(value))\n'
               '\n'
               '        class_type = type(BaseColumn)\n'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=72,
          lineno=118,
          tokens=175,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='full_repr',
          body='        for name, default in zip(arg_iter, defaults):\n'
               '            if name in self.full_repr_exclude:\n'
               '                continue\n'
               '            value = getattr(self, name)\n'
               '            if value == default:\n'
               '                continue\n'
               '            if type(value) == class_type:\n'
               "                formatted_argument_list.append('%s=%s' % "
               '(name, value.__name__))\n'
               '            elif isinstance(value, BaseColumn) and '
               'value.table_class is not self.__class__:\n'
               '                formatted_argument_list.append(\n'
               "                    '%s=%s.%s' % (name, "
               'value.table_class.__name__, value.name))\n'
               '            else:\n'
               "                formatted_argument_list.append('%s=%r' % "
               '(name, value))\n'
               '\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(formatted_argument_list))"),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=73,
          lineno=137,
          tokens=65,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='clone',
          body='def clone(self, table):\n'
               '        """ Clone this column for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__()\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.table = table\n'
               '        return clone'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=74,
          lineno=148,
          tokens=44,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_implicit_definition_list_for_table_class',
          body='def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        """ Returns list of (name, definition) tuples for the '
               'implicit definitions\n'
               '        required on the table model class level\n'
               '        \n'
               '        """\n'
               '        return []'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=75,
          lineno=162,
          tokens=50,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, sql_type=None, default=None, null=False, '
               'doc=None):\n'
               '        self.sql_type = sql_type\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=76,
          lineno=176,
          tokens=68,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, serial=False, implicit=True, doc=None):\n'
               '        self.serial = bool(serial)\n'
               '        self.implicit = bool(implicit)\n'
               '        BaseColumn.__init__(self, doc)\n'
               '\n'
               '        # Move the primary key fields to the top of the column '
               'list\n'
               '        self.__definition_serial__ -= 1000000000'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=77,
          lineno=184,
          tokens=42,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_implicit_definition_list_for_table_class',
          body='def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        if self.serial or not self.implicit:\n'
               '            return []\n'
               "        return [('pk_%s' % self.name, "
               'constraint.PrimaryKey(self))]'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=78,
          lineno=203,
          tokens=84,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, referenced_table_class=None, default=None, '
               'null=False, implicit=True, doc=None):\n'
               '        # NOTE: The referenced table class can be set to None '
               'and filled later\n'
               '        self.referenced_table_class = referenced_table_class\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        self.implicit = bool(implicit)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=79,
          lineno=211,
          tokens=39,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_implicit_definition_list_for_table_class',
          body='def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        if not self.implicit:\n'
               '            return []\n'
               "        return [('fk_%s' % self.name, "
               'constraint.ForeignKey(self))]'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=80,
          lineno=223,
          tokens=38,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, default=None, null=False, doc=None):\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=81,
          lineno=238,
          tokens=54,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, digits=None, default=None, null=False, '
               'doc=None):\n'
               '        self.digits = int(digits) if digits else None\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=82,
          lineno=254,
          tokens=48,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, double=True, default=None, null=False, '
               'doc=None):\n'
               '        self.double = bool(double)\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=83,
          lineno=273,
          tokens=71,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, precision=None, scale=None, default=None, '
               'null=False, doc=None):\n'
               '        self.precision = None if precision is None else '
               'int(precision)\n'
               '        self.scale = None if scale is None else int(scale)\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=84,
          lineno=290,
          tokens=55,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, maxlength=None, default=None, null=False, '
               'doc=None):\n'
               '        self.maxlength = int(maxlength) if maxlength else '
               'None\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=85,
          lineno=303,
          tokens=38,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, default=None, null=False, doc=None):\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=86,
          lineno=315,
          tokens=38,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, default=None, null=False, doc=None):\n'
               '        self.default = default\n'
               '        self.null = bool(null)\n'
               '        BaseColumn.__init__(self, doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=87,
          lineno=336,
          tokens=48,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, expression=None, implicit=True, doc=None):\n'
               '        self.expression = expression\n'
               '        self.null = False\n'
               '        self.implicit = bool(implicit)\n'
               '        BaseColumn.__init__(self, doc=doc)'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=88,
          lineno=342,
          tokens=59,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_implicit_definition_list_for_table_class',
          body='def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        if not self.implicit:\n'
               '            return []\n'
               "        assert self.expression, 'Expression to build up the "
               "search document must be given!'\n"
               "        return [(self.name + '_index', "
               'index.FullTextSearchIndex(*self.expression))]'),
 Fragment(document_cs='0ddf170df2b225299b87004c2c3739234ea925203de34dc0aa3da9dc3eb38aae',
          id=89,
          lineno=1,
          tokens=140,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: BaseColumn Boolean Custom Date Datetime Decimal '
               'Float ForeignKey Integer PrimaryKey SearchDocument Text\n'
               '  Methods: __init__ __repr__ __str__ clone full_repr '
               'get_implicit_definition_list_for_table_class '
               'has_custom_default sort_key\n'
               '  Variables and usages: BaseFunction FullTextSearchIndex _name '
               'abstract_sql_column_type accessible append arg_iter args '
               'class_type constraint dblayer default defaults digits double '
               'expression formatted_argument_list full_repr_exclude '
               'fullargspec function get_next_definition_serial getattr '
               'getfullargspec implicit index inspect iter join maxlength '
               'model name next null precision primary_key property range '
               'referenced_table referenced_table_class repr rsplit scale '
               'serial size sql_type staticmethod table table_class type types '
               'update util value\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=90,
          lineno=9,
          tokens=204,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='class Table:\n'
               '    """ Base class for database table models\n'
               '    \n'
               '    Subclasses are the table models.\n'
               '    \n'
               '    Instances represent actual database tables bound to a '
               'database model.\n'
               '    \n'
               '    Instances contain cloned column, constraint and index '
               'objects bound\n'
               '    to that instance. It is needed to implement cross table '
               'references\n'
               '    like foreign keys and joins.\n'
               '    \n'
               '    """\n'
               '\n'
               '    # True value indicates that this object has to be created '
               'in the database\n'
               '    _creatable = True\n'
               '\n'
               '    # True value indicates that this object is writable in the '
               'database\n'
               '    _writable = True\n'
               '\n'
               '    # Flag indicating that the model has been initialized\n'
               '    _initialized = False\n'
               '\n'
               '    # Reference to the database class containing this table\n'
               '    # NOTE: Set by __new__ of the database definition class\n'
               '    _database_class = None\n'
               '\n'
               '    # Name of the database table (never the alias name)\n'
               '    # NOTE: Set by __new__ of the database definition class\n'
               "    _table_name = ''\n"
               '\n'
               '    # Name of the tab'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=91,
          lineno=39,
          tokens=243,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='le, it can be either a database table name in the case\n'
               '    # of a physical table or an alias name while referencing '
               'from a view\n'
               '    # NOTE: Set by __new__ of the database and query '
               'definition classes\n'
               "    _name = ''\n"
               '\n'
               '    # List of column definitions in definition order\n'
               '    _column_list = ()\n'
               '\n'
               '    # List of database constraints in definition order\n'
               '    _constraint_list = ()\n'
               '\n'
               '    # List of database indexes in definition order\n'
               '    _index_list = ()\n'
               '\n'
               '    # List of database triggers in definition order\n'
               '    _trigger_list = ()\n'
               '\n'
               '    # The definition of the primary key column for this '
               'table,\n'
               '    # which is just a reference to the PrimaryKey column '
               'definition instance.\n'
               '    # It can also be None for read-only tables and views '
               'without a primary key.\n'
               '    _primary_key = None\n'
               '\n'
               '    # Foreign key column referencing this table instance '
               'inside a query if any\n'
               '    _referer = None\n'
               '\n'
               '    # Serial number to record the order of column definitions\n'
               '    __definition_serial__ = 0\n'
               '\n'
               '    def __repr__(self):\n'
               "        return '<Table: %s>' % self._name\n"
               '\n'
               '    __str__ = __repr__\n'
               '\n'
               '    @staticmethod\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=92,
          lineno=73,
          tokens=206,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='    def _sort_key(obj):\n'
               '        """ Sort key to preserve the lexical definition order\n'
               '        """\n'
               '        return obj.__definition_serial__\n'
               '\n'
               '    def __new__(cls):\n'
               '        # Initialize the class only once\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               '        return super(Table, cls).__new__(cls)\n'
               '\n'
               '    @classmethod\n'
               '    def initialize(cls):\n'
               '\n'
               '        # Mark the class as initialized\n'
               '        cls._initialized = True\n'
               '\n'
               '        # Assign name to constraints and indexes and collect '
               'them\n'
               '        cls._prepare_table_definition()\n'
               '\n'
               '    @classmethod\n'
               '    def _prepare_table_definition(cls):\n'
               '        """ Prepares the table definition before the first '
               'instantiation\n'
               '        """\n'
               '        cls._column_list = []\n'
               '        cls._constraint_list = []\n'
               '        cls._index_list = []\n'
               '        cls._trigger_list = []\n'
               '        for name in dir(cls):\n'
               '            value = getattr(cls, name)\n'
               '\n'
               '            if isinstance(value, column.BaseColumn):\n'
               '                value.name = name\n'
               '                value.table_class = cls\n'
               '                cls._column_list.append(value)\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=93,
          lineno=109,
          tokens=219,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='                if value.primary_key:\n'
               "                    assert cls._primary_key is None, 'More "
               "than one primary key columns are defined for table: %s' % "
               'cls.__name__\n'
               '                    cls._primary_key = value\n'
               '\n'
               '            elif isinstance(value, '
               'constraint.BaseConstraint):\n'
               '                value.name = name\n'
               '                value.table_class = cls\n'
               '                cls._constraint_list.append(value)\n'
               '\n'
               '            elif isinstance(value, index.BaseIndex):\n'
               '                value.name = name\n'
               '                value.table_class = cls\n'
               '                cls._index_list.append(value)\n'
               '\n'
               '            elif isinstance(value, trigger.BaseTrigger):\n'
               '                value.name = name\n'
               '                value.table_class = cls\n'
               '                cls._trigger_list.append(value)\n'
               '\n'
               '        # Sort the definition objects to keep their source '
               'code order\n'
               '        cls._column_list.sort(key=column.BaseColumn.sort_key)\n'
               '        '
               'cls._constraint_list.sort(key=constraint.BaseConstraint.sort_key)\n'
               '        cls._index_list.sort(key=index.BaseIndex.sort_key)\n'
               '        '
               'cls._trigger_list.sort(key=trigger.BaseTrigger.sort_key)\n'
               '\n'
               '        # If we have a primary key column, then it must be the '
               'first one\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=94,
          lineno=135,
          tokens=59,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='        if cls._primary_key:\n'
               '            assert cls._column_list[0] is cls._primary_key, (\n'
               "                    'The primary key column must be the first "
               "one defined for table: %s' % cls.__name__)\n"
               '\n'
               '        # Add implicit definitions required by some of the '
               'existing definitions\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=95,
          lineno=140,
          tokens=203,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='        for member in cls._column_list + cls._index_list:\n'
               '            for name, definition in '
               'member.get_implicit_definition_list_for_table_class(cls):\n'
               '                assert not hasattr(cls, name), (\n'
               "                        'Attribute name %s.%s collides with "
               "implicit %s definition required by %s.%s!' %\n"
               '                        (cls.__name__, name, '
               'definition.__class__.__name__, cls.__name__, member.name))\n'
               '                if isinstance(definition, '
               'constraint.BaseConstraint):\n'
               '                    cls._constraint_list.append(definition)\n'
               '                elif isinstance(definition, index.BaseIndex):\n'
               '                    cls._index_list.append(definition)\n'
               '                elif isinstance(definition, '
               'trigger.BaseTrigger):\n'
               '                    cls._trigger_list.append(definition)\n'
               '                else:\n'
               '                    raise TypeError(\n'
               "                        'Unsupported implicit definition "
               "required by %s.%s: %r' %\n"
               '                        (cls.__name__, member.name, '
               'definition))\n'
               '                definition.table_class = cls\n'
               '                definition.name = name\n'
               '                definition.implicit = True\n'
               '                setattr(cls, name, definition)\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=96,
          lineno=159,
          tokens=211,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='\n'
               '    def __init__(self):\n'
               '        # Do not allow initialization of the abstract base '
               'class\n'
               '        assert self.__class__ is not Table, (\n'
               "            'Only subclasses of Table can be instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        # Clone columns, constraints and indexes\n'
               '        self._column_list = [column.clone(self) for column in '
               'self._column_list]\n'
               '        self._constraint_list = [constraint.clone(self) for '
               'constraint in self._constraint_list]\n'
               '        self._index_list = [index.clone(self) for index in '
               'self._index_list]\n'
               '        self._trigger_list = [trigger.clone(self) for trigger '
               'in self._trigger_list]\n'
               '\n'
               '        # Override the model definitions with the bound '
               'instances\n'
               '        for column in self._column_list:\n'
               '            setattr(self, column.name, column)\n'
               '        for constraint in self._constraint_list:\n'
               '            setattr(self, constraint.name, constraint)\n'
               '        for index in self._index_list:\n'
               '            setattr(self, index.name, index)\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=97,
          lineno=181,
          tokens=238,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='        for trigger in self._trigger_list:\n'
               '            setattr(self, trigger.name, trigger)\n'
               '\n'
               '        # Reassign the primary key\n'
               '        if self._primary_key:\n'
               '            self._primary_key = getattr(self, '
               'self._primary_key.name)\n'
               '\n'
               '    def join(self, foreign_key_column):\n'
               '        """ Joins this table inside a query with the given '
               'foreign key\n'
               '        \n'
               '        It is an INNER JOIN for non-nullable foreign keys and '
               'a LEFT JOIN\n'
               '        for nullable ones. It just records the joined table as '
               'a source to\n'
               '        build views, does not generate actual SQL.\n'
               '        \n'
               '        Each table can be joined with a single foreign key.\n'
               '        Unjoined tables are cross-joined.\n'
               '        \n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert isinstance(foreign_key_column, '
               'column.ForeignKey)\n'
               '            assert foreign_key_column.table, (\n'
               "                'Only foreign keys bound to a table instance "
               "can be used to join tables.')\n"
               '            assert self._referer is None, (\n'
               "                    'Table or view %s has already been joined "
               "with foreign key column: %s' %\n"
               '                    (self.__class__.__name__, '
               'foreign_key_column._name))\n'
               '\n'
               '        self._referer = foreign_key_column\n'
               '\n'
               '    @classmethod\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=98,
          lineno=210,
          tokens=233,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='    def pretty_format_class(cls):\n'
               '        """ Formats source code defining the table\n'
               '        """\n'
               "        line_list = ['class %s(table.Table):' % cls.__name__]\n"
               '        append_line = line_list.append\n'
               '\n'
               '        if cls.__doc__:\n'
               "            if '\\n' in cls.__doc__:\n"
               '                append_line(\'    """%s"""\' % cls.__doc__)\n'
               '            else:\n'
               '                append_line(\'    """ %s """\' % '
               'cls.__doc__.strip())\n'
               '        else:\n'
               "            append_line('')\n"
               '\n'
               '        extra_line_list = []\n'
               '\n'
               '        for obj in cls._column_list:\n'
               '            if isinstance(obj, column.ForeignKey) and '
               'obj.referenced_table_class is cls:\n'
               '                obj.referenced_table_class = None\n'
               "                append_line('    %s = %s' % (obj.name, "
               'obj.full_repr()))\n'
               '                obj.referenced_table_class = cls\n'
               '                '
               "extra_line_list.append('%s.%s.referenced_table_class = %s' % "
               '(\n'
               '                    cls.__name__, obj.name, cls.__name__))\n'
               '            else:\n'
               "                append_line('    %s = %s' % (obj.name, "
               'obj.full_repr()))\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=99,
          lineno=235,
          tokens=130,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Table',
          body='\n'
               '        for obj in cls._constraint_list:\n'
               '            if not obj.implicit:\n'
               "                append_line('    %s = %r' % (obj.name, obj))\n"
               '\n'
               '        for obj in cls._index_list:\n'
               '            if not obj.implicit:\n'
               "                append_line('    %s = %r' % (obj.name, obj))\n"
               '\n'
               '        for obj in cls._trigger_list:\n'
               '            if not obj.implicit:\n'
               "                append_line('    %s = %r' % (obj.name, obj))\n"
               '\n'
               '        if extra_line_list:\n'
               "            append_line('')\n"
               '            line_list.extend(extra_line_list)\n'
               '\n'
               "        return '\\n'.join(line_list)"),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=100,
          lineno=4,
          tokens=38,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer import util, constantsfrom dblayer import util, '
               'constantsfrom dblayer.model import column, constraint, index, '
               'triggerfrom dblayer.model import column, constraint, index, '
               'trigger'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=101,
          lineno=1,
          tokens=7,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for database table definitions\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=102,
          lineno=10,
          tokens=248,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for database table models\n'
               '    \n'
               '    Subclasses are the table models.\n'
               '    \n'
               '    Instances represent actual database tables bound to a '
               'database model.\n'
               '    \n'
               '    Instances contain cloned column, constraint and index '
               'objects bound\n'
               '    to that instance. It is needed to implement cross table '
               'references\n'
               '    like foreign keys and joins.\n'
               '    \n'
               '    # True value indicates that this object has to be created '
               'in the database# True value indicates that this object is '
               'writable in the database# Flag indicating that the model has '
               'been initialized# Reference to the database class containing '
               'this table# NOTE: Set by __new__ of the database definition '
               'class# Name of the database table (never the alias name)# '
               'NOTE: Set by __new__ of the database definition class# Name of '
               'the table, it can be either a database table name in the case# '
               'of a physical table or an alias name while referencing from a '
               'view# NOTE: Set by __new__ of the database and query '
               'definition classes# List of column definitions in definition '
               'order# List of database constraints in definition order# List '
               'of database indexes in definition order# List of database '
               'triggers in definition order# The definition of the primary '
               'key column for this table,# which is just a reference to the '
               'PrimaryKey column definition instance.'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=103,
          lineno=58,
          tokens=39,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# It can also be None for read-only tables and views without a '
               'primary key.# Foreign key column referencing this table '
               'instance inside a query if any# Serial number to record the '
               'order of column definitions'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=104,
          lineno=74,
          tokens=10,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Sort key to preserve the lexical definition order\n        '),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=105,
          lineno=79,
          tokens=6,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Initialize the class only once'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=106,
          lineno=88,
          tokens=16,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Mark the class as initialized# Assign name to constraints '
               'and indexes and collect them'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=107,
          lineno=96,
          tokens=109,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Prepares the table definition before the first instantiation\n'
               '        More than one primary key columns are defined for '
               'table: %s# Sort the definition objects to keep their source '
               'code order# If we have a primary key column, then it must be '
               'the first oneThe primary key column must be the first one '
               'defined for table: %s# Add implicit definitions required by '
               'some of the existing definitionsAttribute name %s.%s collides '
               'with implicit %s definition required by %s.%s!Unsupported '
               'implicit definition required by %s.%s: %r'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=108,
          lineno=161,
          tokens=45,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Do not allow initialization of the abstract base classOnly '
               'subclasses of Table can be instantiated!# Record the '
               'definition order# Clone columns, constraints and indexes# '
               'Override the model definitions with the bound instances# '
               'Reassign the primary key'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=109,
          lineno=189,
          tokens=110,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Joins this table inside a query with the given foreign key\n'
               '        \n'
               '        It is an INNER JOIN for non-nullable foreign keys and '
               'a LEFT JOIN\n'
               '        for nullable ones. It just records the joined table as '
               'a source to\n'
               '        build views, does not generate actual SQL.\n'
               '        \n'
               '        Each table can be joined with a single foreign key.\n'
               '        Unjoined tables are cross-joined.\n'
               '        \n'
               '        Only foreign keys bound to a table instance can be '
               'used to join tables.Table or view %s has already been joined '
               'with foreign key column: %s'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=110,
          lineno=211,
          tokens=26,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats source code defining the table\n'
               '        class %s(table.Table):%s.%s.referenced_table_class = '
               '%s'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=111,
          lineno=67,
          tokens=18,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body="def __repr__(self):\n        return '<Table: %s>' % self._name"),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=112,
          lineno=73,
          tokens=26,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='_sort_key',
          body='def _sort_key(obj):\n'
               '        """ Sort key to preserve the lexical definition order\n'
               '        """\n'
               '        return obj.__definition_serial__'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=113,
          lineno=78,
          tokens=36,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__new__',
          body='def __new__(cls):\n'
               '        # Initialize the class only once\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               '        return super(Table, cls).__new__(cls)'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=114,
          lineno=86,
          tokens=38,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='initialize',
          body='def initialize(cls):\n'
               '\n'
               '        # Mark the class as initialized\n'
               '        cls._initialized = True\n'
               '\n'
               '        # Assign name to constraints and indexes and collect '
               'them\n'
               '        cls._prepare_table_definition()'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=115,
          lineno=95,
          tokens=94,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='_prepare_table_definition',
          body='def _prepare_table_definition(cls):\n'
               '        """ Prepares the table definition before the first '
               'instantiation\n'
               '        """\n'
               '        cls._column_list = []\n'
               '        cls._constraint_list = []\n'
               '        cls._index_list = []\n'
               '        cls._trigger_list = []\n'
               '        for name in dir(cls):\n'
               '            value = getattr(cls, name)\n'
               '\n'
               '            if isinstance(value, column.BaseColumn):\n'
               '                value.name = name\n'
               '                value.table_class = cls\n'
               '                cls._column_list.append(value)\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=116,
          lineno=109,
          tokens=219,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='_prepare_table_definition',
          body='                if value.primary_key:\n'
               "                    assert cls._primary_key is None, 'More "
               "than one primary key columns are defined for table: %s' % "
               'cls.__name__\n'
               '                    cls._primary_key = value\n'
               '\n'
               '            elif isinstance(value, '
               'constraint.BaseConstraint):\n'
               '                value.name = name\n'
               '                value.table_class = cls\n'
               '                cls._constraint_list.append(value)\n'
               '\n'
               '            elif isinstance(value, index.BaseIndex):\n'
               '                value.name = name\n'
               '                value.table_class = cls\n'
               '                cls._index_list.append(value)\n'
               '\n'
               '            elif isinstance(value, trigger.BaseTrigger):\n'
               '                value.name = name\n'
               '                value.table_class = cls\n'
               '                cls._trigger_list.append(value)\n'
               '\n'
               '        # Sort the definition objects to keep their source '
               'code order\n'
               '        cls._column_list.sort(key=column.BaseColumn.sort_key)\n'
               '        '
               'cls._constraint_list.sort(key=constraint.BaseConstraint.sort_key)\n'
               '        cls._index_list.sort(key=index.BaseIndex.sort_key)\n'
               '        '
               'cls._trigger_list.sort(key=trigger.BaseTrigger.sort_key)\n'
               '\n'
               '        # If we have a primary key column, then it must be the '
               'first one\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=117,
          lineno=135,
          tokens=59,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='_prepare_table_definition',
          body='        if cls._primary_key:\n'
               '            assert cls._column_list[0] is cls._primary_key, (\n'
               "                    'The primary key column must be the first "
               "one defined for table: %s' % cls.__name__)\n"
               '\n'
               '        # Add implicit definitions required by some of the '
               'existing definitions\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=118,
          lineno=140,
          tokens=203,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='_prepare_table_definition',
          body='        for member in cls._column_list + cls._index_list:\n'
               '            for name, definition in '
               'member.get_implicit_definition_list_for_table_class(cls):\n'
               '                assert not hasattr(cls, name), (\n'
               "                        'Attribute name %s.%s collides with "
               "implicit %s definition required by %s.%s!' %\n"
               '                        (cls.__name__, name, '
               'definition.__class__.__name__, cls.__name__, member.name))\n'
               '                if isinstance(definition, '
               'constraint.BaseConstraint):\n'
               '                    cls._constraint_list.append(definition)\n'
               '                elif isinstance(definition, index.BaseIndex):\n'
               '                    cls._index_list.append(definition)\n'
               '                elif isinstance(definition, '
               'trigger.BaseTrigger):\n'
               '                    cls._trigger_list.append(definition)\n'
               '                else:\n'
               '                    raise TypeError(\n'
               "                        'Unsupported implicit definition "
               "required by %s.%s: %r' %\n"
               '                        (cls.__name__, member.name, '
               'definition))\n'
               '                definition.table_class = cls\n'
               '                definition.name = name\n'
               '                definition.implicit = True\n'
               '                setattr(cls, name, definition)'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=119,
          lineno=160,
          tokens=209,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self):\n'
               '        # Do not allow initialization of the abstract base '
               'class\n'
               '        assert self.__class__ is not Table, (\n'
               "            'Only subclasses of Table can be instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        # Clone columns, constraints and indexes\n'
               '        self._column_list = [column.clone(self) for column in '
               'self._column_list]\n'
               '        self._constraint_list = [constraint.clone(self) for '
               'constraint in self._constraint_list]\n'
               '        self._index_list = [index.clone(self) for index in '
               'self._index_list]\n'
               '        self._trigger_list = [trigger.clone(self) for trigger '
               'in self._trigger_list]\n'
               '\n'
               '        # Override the model definitions with the bound '
               'instances\n'
               '        for column in self._column_list:\n'
               '            setattr(self, column.name, column)\n'
               '        for constraint in self._constraint_list:\n'
               '            setattr(self, constraint.name, constraint)\n'
               '        for index in self._index_list:\n'
               '            setattr(self, index.name, index)\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=120,
          lineno=181,
          tokens=48,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='        for trigger in self._trigger_list:\n'
               '            setattr(self, trigger.name, trigger)\n'
               '\n'
               '        # Reassign the primary key\n'
               '        if self._primary_key:\n'
               '            self._primary_key = getattr(self, '
               'self._primary_key.name)'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=121,
          lineno=188,
          tokens=184,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='join',
          body='def join(self, foreign_key_column):\n'
               '        """ Joins this table inside a query with the given '
               'foreign key\n'
               '        \n'
               '        It is an INNER JOIN for non-nullable foreign keys and '
               'a LEFT JOIN\n'
               '        for nullable ones. It just records the joined table as '
               'a source to\n'
               '        build views, does not generate actual SQL.\n'
               '        \n'
               '        Each table can be joined with a single foreign key.\n'
               '        Unjoined tables are cross-joined.\n'
               '        \n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert isinstance(foreign_key_column, '
               'column.ForeignKey)\n'
               '            assert foreign_key_column.table, (\n'
               "                'Only foreign keys bound to a table instance "
               "can be used to join tables.')\n"
               '            assert self._referer is None, (\n'
               "                    'Table or view %s has already been joined "
               "with foreign key column: %s' %\n"
               '                    (self.__class__.__name__, '
               'foreign_key_column._name))\n'
               '\n'
               '        self._referer = foreign_key_column'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=122,
          lineno=210,
          tokens=232,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='pretty_format_class',
          body='def pretty_format_class(cls):\n'
               '        """ Formats source code defining the table\n'
               '        """\n'
               "        line_list = ['class %s(table.Table):' % cls.__name__]\n"
               '        append_line = line_list.append\n'
               '\n'
               '        if cls.__doc__:\n'
               "            if '\\n' in cls.__doc__:\n"
               '                append_line(\'    """%s"""\' % cls.__doc__)\n'
               '            else:\n'
               '                append_line(\'    """ %s """\' % '
               'cls.__doc__.strip())\n'
               '        else:\n'
               "            append_line('')\n"
               '\n'
               '        extra_line_list = []\n'
               '\n'
               '        for obj in cls._column_list:\n'
               '            if isinstance(obj, column.ForeignKey) and '
               'obj.referenced_table_class is cls:\n'
               '                obj.referenced_table_class = None\n'
               "                append_line('    %s = %s' % (obj.name, "
               'obj.full_repr()))\n'
               '                obj.referenced_table_class = cls\n'
               '                '
               "extra_line_list.append('%s.%s.referenced_table_class = %s' % "
               '(\n'
               '                    cls.__name__, obj.name, cls.__name__))\n'
               '            else:\n'
               "                append_line('    %s = %s' % (obj.name, "
               'obj.full_repr()))\n'),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=123,
          lineno=235,
          tokens=130,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='pretty_format_class',
          body='\n'
               '        for obj in cls._constraint_list:\n'
               '            if not obj.implicit:\n'
               "                append_line('    %s = %r' % (obj.name, obj))\n"
               '\n'
               '        for obj in cls._index_list:\n'
               '            if not obj.implicit:\n'
               "                append_line('    %s = %r' % (obj.name, obj))\n"
               '\n'
               '        for obj in cls._trigger_list:\n'
               '            if not obj.implicit:\n'
               "                append_line('    %s = %r' % (obj.name, obj))\n"
               '\n'
               '        if extra_line_list:\n'
               "            append_line('')\n"
               '            line_list.extend(extra_line_list)\n'
               '\n'
               "        return '\\n'.join(line_list)"),
 Fragment(document_cs='13321be5d0fcf22fbcd978dfbb21196d4b7c459b04b2b2c2aefd5a0f1a631fb2',
          id=124,
          lineno=1,
          tokens=141,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: Table\n'
               '  Methods: __init__ __new__ __repr__ _prepare_table_definition '
               '_sort_key initialize join pretty_format_class\n'
               '  Variables and usages: BaseColumn BaseConstraint BaseIndex '
               'BaseTrigger DEBUG ForeignKey TypeError _column_list '
               '_constraint_list _creatable _database_class _index_list '
               '_initialized _name _primary_key _referer _table_name '
               '_trigger_list _writable append append_line classmethod clone '
               'column constants constraint dblayer definition extend '
               'extra_line_list foreign_key_column full_repr '
               'get_implicit_definition_list_for_table_class '
               'get_next_definition_serial getattr hasattr implicit index '
               'line_list member model name primary_key referenced_table_class '
               'setattr sort sort_key staticmethod strip table table_class '
               'trigger util value\n'),
 Fragment(document_cs='1e0cf249b460c0776143cb0a99ad7747583f0d1dda5bba9ccec313b780a03e23',
          id=125,
          lineno=2,
          tokens=22,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer.backend.base.clauses import Clausesfrom '
               'dblayer.backend.base.clauses import Clauses'),
 Fragment(document_cs='1e0cf249b460c0776143cb0a99ad7747583f0d1dda5bba9ccec313b780a03e23',
          id=126,
          lineno=1,
          tokens=7,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# noinspection PyUnresolvedReferences'),
 Fragment(document_cs='1e0cf249b460c0776143cb0a99ad7747583f0d1dda5bba9ccec313b780a03e23',
          id=127,
          lineno=1,
          tokens=14,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Variables and usages: Clauses backend base clauses dblayer\n'),
 Fragment(document_cs='2c6d1c5ff5e93ccb81c5f62864650a699a034c8ccb52150129564541c14679ef',
          id=128,
          lineno=1,
          tokens=195,
          depth=1,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Database Abstraction Layer Generator\n'
               '\n'
               'Database server support: PostgreSQL\n'
               '\n'
               '# Installation\n'
               '\n'
               '* Using pip: ```pip install dblayer```\n'
               '* From source: ```python setup.py install```\n'
               '\n'
               '# How it works\n'
               '\n'
               '## Abstraction layer\n'
               '\n'
               'Generates source code of a module implementing row classes '
               'with slots and a \n'
               'single database abstraction layer class. These classes can be '
               'used as is or \n'
               'extended by inheritance to fit your specific needs. It is also '
               'possible to \n'
               'extend the row classes to provide properties or helper '
               'methods. The generated \n'
               'code provides Python IDEs as much information as possible to '
               'make code \n'
               'completion useful. \n'
               '\n'
               '## Lightweight usage\n'
               '\n'
               'The generated abstraction layer works like an ORM (Object '
               'Relational Mapper), \n'
               'but without a direct mapping of row instances to the '
               'corresponding database \n'
               'rows. It makes this approach more lightweight than a '
               'full-blown ORM. Database \n'
               'sessions and transactions must be initiated explicitly, but '
               'there are context \n'
               'managers defined to simplify your code.\n'
               '\n'),
 Fragment(document_cs='2c6d1c5ff5e93ccb81c5f62864650a699a034c8ccb52150129564541c14679ef',
          id=129,
          lineno=29,
          tokens=177,
          depth=1,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='## Features\n'
               '\n'
               'Tables, indexes and constraints are defined in a very clean '
               'way by just \n'
               'writing Python classes. Everything is defined explicitly, no '
               'automatic \n'
               'discovery of classes. Queries on multiple tables (joins) can '
               'also be defined \n'
               'in a clean way. Table aliasing is automatic and natural, since '
               'all the \n'
               'participating tables must be given an unique name in order to '
               'build the query \n'
               'definition. Highly complex queries can be build up gradually '
               'by simple Python \n'
               'class inheritance, which helps reducing code redundancy in '
               'real world use \n'
               'cases.\n'
               '\n'
               'Constraints are enforced on the database server, not by Python '
               'code. It is \n'
               'also possible to add record finalization and validation code '
               'in Python if \n'
               'needed. There is support for defining efficient full text '
               'search indexes in a \n'
               'very simple way, so searching rows based on their textual '
               'contents is easy to \n'
               'implement.\n'
               '\n'
               '# Remarks\n'
               '\n'),
 Fragment(document_cs='2c6d1c5ff5e93ccb81c5f62864650a699a034c8ccb52150129564541c14679ef',
          id=130,
          lineno=48,
          tokens=170,
          depth=1,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='## Performance\n'
               '\n'
               'Most of the SQL is generated at compile time to reduce the '
               'runtime overhead as \n'
               'much as possible. Despite this it is possible to add runtime '
               'conditions, even \n'
               'building up complex conditions at runtime, but it will not '
               'slow down the \n'
               'simple use cases. Literal values are escaped automatically. '
               'The abstraction \n'
               'layer always returns unicode objects. You can pass str objects '
               'as literal \n'
               'values, the default encoding is UTF-8 in this case.\n'
               '\n'
               '## Limitations\n'
               '\n'
               'The only supported database server is PostgreSQL via the '
               'psycopg2 \n'
               'extension. The generated code works with gevent-psycopg2 as '
               'well. \n'
               '\n'
               'No support for defining database views, tablespaces and '
               'other \n'
               'database servers yet. \n'
               '\n'
               'No support for inspecting databases (generating the classes '
               'defining and \n'
               'existing database) yet. \n'
               '\n'
               'The unit test coverage is still not 100%.\n'),
 Fragment(document_cs='2c6d1c5ff5e93ccb81c5f62864650a699a034c8ccb52150129564541c14679ef',
          id=131,
          lineno=1,
          tokens=37,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='# Database Abstraction Layer Generator\n'
               '# Installation\n'
               '# How it works\n'
               '## Abstraction layer\n'
               '## Lightweight usage\n'
               '## Features\n'
               '# Remarks\n'
               '## Performance\n'
               '## Limitations\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=132,
          lineno=23,
          tokens=67,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestGraph',
          body='class TestGraph(unittest.TestCase):\n'
               '\n'
               '    def setUp(self) -> None:\n'
               '        model.generate()\n'
               "        self.abstraction = __import__('abstraction')\n"
               '\n'
               '    def testGML(self):\n'
               '        model_instance = '
               "model.TestDatabaseModel('TestDatabase')\n"
               '        exporter = gml.GMLExporter(model_instance)\n'
               "        exporter.export('model.gml')"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=133,
          lineno=35,
          tokens=137,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='class TestAbstraction(unittest.TestCase):\n'
               '\n'
               '    def setUp(self):\n'
               '        model.generate()\n'
               "        self.abstraction = __import__('abstraction')\n"
               '        self.db = self.abstraction.TestDatabase()\n'
               '        self.db.connect(test_constants.TEST_DSN)\n'
               '        self.db.enable_transactions()\n'
               '        with self.db.transaction():\n'
               '            self.db.drop_structure(ignore_errors=True)\n'
               '        with self.db.transaction():\n'
               '            self.db.create_structure()\n'
               '\n'
               '    def tearDown(self):\n'
               '        if test_constants.LEAVE_CLEAN_DATABASE:\n'
               '            self.db.rollback()\n'
               '            with self.db.transaction():\n'
               '                self.db.drop_structure(ignore_errors=True)\n'
               '        self.db.disable_transactions()\n'
               '        self.db.close()\n'
               '\n'
               '        # It must not fail\n'
               '        self.db.close()\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=134,
          lineno=58,
          tokens=230,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_database_session(self):\n'
               '        db2 = self.abstraction.TestDatabase()\n'
               '        self.assertTrue(not db2.connected)\n'
               '        with db2.session(test_constants.TEST_DSN):\n'
               '            self.assertTrue(db2.connected)\n'
               '            with db2.transaction():\n'
               "                hdd = db2.new_product(name='hdd')\n"
               '                db2.add_product(hdd)\n'
               '            self.assertTrue(db2.connected)\n'
               '        self.assertTrue(not db2.connected)\n'
               '\n'
               '        with self.db.transaction():\n'
               '            '
               "self.assertEqual(self.db.find_product(name='hdd').id, hdd.id)\n"
               '\n'
               '        # Automatic closing of connection in __del__ in '
               'no-error condition\n'
               '        db3 = self.abstraction.TestDatabase()\n'
               '        db3.connect(test_constants.TEST_DSN)\n'
               '        self.assertTrue(db3.connected)\n'
               '        del db3\n'
               '\n'
               '        # Automatic closing of connection in __del__ after a '
               'database error\n'
               '        db4 = self.abstraction.TestDatabase()\n'
               '        db4.connect(test_constants.TEST_DSN)\n'
               '        self.assertTrue(db4.connected)\n'
               '        with db4.cursor() as cursor:\n'
               '            self.assertRaises(db4.Error, db4.execute, cursor, '
               "'BAD SQL')\n"
               '        del db4\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=135,
          lineno=86,
          tokens=244,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_truncate(self):\n'
               '        self.assertEqual(self.db.get_user_count(), 0)\n'
               '        with self.db.transaction():\n'
               '            self.db.truncate_all_tables()\n'
               '        self.assertEqual(self.db.get_user_count(), 0)\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '        self.assertNotEqual(self.db.get_user_count(), 0)\n'
               '        with self.db.transaction():\n'
               '            self.db.truncate_all_tables()\n'
               '        self.assertEqual(self.db.get_user_count(), 0)\n'
               '\n'
               '    def test_insert_select(self):\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '        with self.db.transaction():\n'
               '            self.verify_data()\n'
               '        self.db.commit()\n'
               '\n'
               '    def test_duplicate_insert(self):\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '        user_list = self.db.get_user_list()\n'
               '        with self.db.transaction():\n'
               '            self.assertRaises(self.db.IntegrityError, '
               'self.db.add_user, user_list[0], generate_id=False)\n'
               '        with self.db.transaction():\n'
               '            self.assertRaises(self.db.IntegrityError, '
               'self.db.add_user_list, user_list, generate_id=False)\n'
               '\n'
               '    def test_update_delete(self):\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '        self.modify_data()\n'
               '        self.do_failed_transaction()\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=136,
          lineno=120,
          tokens=198,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def load_data(self, db=None):\n'
               '        """ Loads test data\n'
               '        """\n'
               '        if db is None:\n'
               '            db = self.db\n'
               '        if 0:\n'
               '            assert isinstance(db, '
               'self.abstraction.TestDatabase)\n'
               '\n'
               '        # Users\n'
               '        viktor = db.new_user(\n'
               "            email='viktor@ferenczi.eu',\n"
               "            first_name='Viktor',\n"
               "            last_name='Ferenczi',\n"
               "            phone='1234567')\n"
               '        anna = db.new_user(\n'
               "            email='anna@cx.hu',\n"
               "            first_name='Anna',\n"
               "            last_name='Szili',\n"
               "            phone='2345678')\n"
               '        isi = db.new_user(\n'
               "            email='isi@cx.hu',\n"
               "            first_name='István',\n"
               "            last_name='Horváth')\n"
               '        annacska = db.new_user(\n'
               "            email='anna@ferenczi.eu',\n"
               "            first_name='Anna',\n"
               "            last_name='Ferenczi',\n"
               '            '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=137,
          lineno=148,
          tokens=167,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body="phone='4567890')\n"
               '        self.assertTrue(viktor.id is None)\n'
               '        db.add_user(viktor)\n'
               '        self.assertFalse(viktor.id is None)\n'
               '        db.add_user_list([anna, isi])\n'
               '        self.assertFalse(anna.id is None)\n'
               '        self.assertFalse(isi.id is None)\n'
               '        db.add_user_list([annacska])\n'
               '        self.assertFalse(annacska.id is None)\n'
               '        self.assertEqual(db.get_user_count(), 4)\n'
               '        db.add_user_list([])\n'
               '        self.assertEqual(db.get_user_count(), 4)\n'
               "        self.assertNotEqual(viktor, 'not a record')\n"
               '        self.assertNotEqual(viktor, anna)\n'
               '        self.assertNotEqual(viktor.id, anna.id)\n'
               '        self.assertNotEqual(viktor.id, isi.id)\n'
               '        self.assertNotEqual(vikto'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=138,
          lineno=164,
          tokens=144,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='r.id, annacska.id)\n'
               '        user_list = db.get_user_list()\n'
               '        self.assertEqual(len(user_list), db.get_user_count())\n'
               '\n'
               '        # Groups\n'
               '        admin = db.new_group(\n'
               "            slug='admin',\n"
               "            name='Admin')\n"
               '        provider = db.new_group(\n'
               "            slug='provider',\n"
               "            name='Service provider')\n"
               '        customer = db.new_group(\n'
               "            slug='customer',\n"
               "            name='Customer')\n"
               '        group_list = sorted([admin, provider, customer], '
               'key=lambda r: r.slug)\n'
               '        db.add_group_list(group_list)\n'
               '        self.assertEqual(len(group_list), '
               'db.get_group_count())\n'
               '        self.assertEqual(group_list, '
               'sorted(list(db.get_group_iter()), key=lambda r: r.slug))'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=139,
          lineno=181,
          tokens=156,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '\n'
               '        # Associate users with groups\n'
               '        group_user_list = [\n'
               '            db.new_group_user(group=admin.id, '
               'user=viktor.id),\n'
               '            db.new_group_user(group=provider.id, '
               'user=viktor.id),\n'
               '            db.new_group_user(group=provider.id, '
               'user=annacska.id),\n'
               '            db.new_group_user(group=customer.id, '
               'user=viktor.id),\n'
               '            db.new_group_user(group=customer.id, '
               'user=anna.id),\n'
               '            db.new_group_user(group=customer.id, '
               'user=isi.id)]\n'
               '        db.add_group_user_list(group_user_list)\n'
               '\n'
               '        # Verify data\n'
               '        group_user_id_list = set([group_user.id for group_user '
               'in group_user_list])\n'
               '        self.assertEqual(len(group_user_list), '
               'len(group_user_id_list))\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=140,
          lineno=196,
          tokens=117,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='        for group_user in db.get_group_user_list():\n'
               '            self.assertTrue(group_user.id in '
               'group_user_id_list)\n'
               '        self.assertEqual(len(group_user_list), '
               'db.get_group_user_count())\n'
               '        self.assertEqual(viktor, '
               "db.find_user(email='viktor@ferenczi.eu'))\n"
               '        self.assertEqual(anna, '
               "db.find_user(last_name='Szili'))\n"
               '\n'
               '        # Add products\n'
               "        hdd = db.new_product(name='hdd')\n"
               "        consulting = db.new_product(name='consulting')\n"
               '        db.add_product_list([hdd, consulting])\n'
               '\n'
               '        # Add two invoices\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=141,
          lineno=208,
          tokens=143,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='        for m, customer in [(1, anna), (2, isi)]:\n'
               '            invoice = db.new_invoice(\n'
               "                serial='2010/%04d' % m,\n"
               '                seller=viktor.id,\n'
               '                customer=customer.id,\n'
               '                net_amount=4600 * m,\n'
               '                vat_amount=1150 * m,\n'
               '                gross_amount=5750 * m,\n'
               '                issued_date=datetime.date(2010, 3, 31),\n'
               '                due_date=datetime.date(2010, 4, 30))\n'
               '            db.add_invoice(invoice)\n'
               '            item1 = db.new_invoice_item(\n'
               '                invoice=invoice.id,\n'
               '                product=hdd.id,\n'
               '                quantity=6 * m,\n'
               '    '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=142,
          lineno=223,
          tokens=141,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='            net_amount=600 * m,\n'
               '                vat_percent=2500 * m,\n'
               '                vat_amount=150 * m,\n'
               '                gross_amount=750 * m)\n'
               '            item2 = db.new_invoice_item(\n'
               '                invoice=invoice.id,\n'
               '                product=consulting.id,\n'
               '                quantity=20 * m,\n'
               '                first_day=datetime.date(2010, 4, 1),\n'
               '                last_day=datetime.date(2010, 4, 30),\n'
               '                net_amount=4000 * m,\n'
               '                vat_percent=25000 * m,\n'
               '                vat_amount=1000 * m,\n'
               '                gross_amount=5000 * m)\n'
               '            db.add_invoice_item_list([item1, item2])\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=143,
          lineno=238,
          tokens=210,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def verify_data(self, db=None):\n'
               '        """ Do data verification\n'
               '        """\n'
               '        if db is None:\n'
               '            db = self.db\n'
               '        if 0:\n'
               '            assert isinstance(db, '
               'self.abstraction.TestDatabase)\n'
               '\n'
               "        viktor = db.find_user(email='viktor@ferenczi.eu')\n"
               '        self.assertFalse(viktor is None)\n'
               "        anna = db.find_user(email='anna@cx.hu')\n"
               '        self.assertFalse(anna is None)\n'
               '\n'
               '        viktor_groups = '
               'db.find_group_user_list(user=viktor.id)\n'
               '        self.assertEqual(len(viktor_groups), 3)\n'
               '\n'
               '        anna_groups = db.find_group_user_list(user=anna.id)\n'
               '        self.assertEqual(len(anna_groups), 1)\n'
               '\n'
               '        get_result_list = db.get_user_list()\n'
               '        find_result_list = db.find_user_list()\n'
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)\n'
               '\n'
               '    def modify_data(self, db=None):\n'
               '        """ Do data modification\n'
               '        """\n'
               '        if db is None:\n'
               '            db = self.db\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=144,
          lineno=267,
          tokens=239,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='        if 0:\n'
               '            assert isinstance(db, '
               'self.abstraction.TestDatabase)\n'
               '\n'
               "        admin = db.find_group(slug='admin')\n"
               "        anna = db.find_user(email='anna@cx.hu')\n"
               '        group_membership = db.new_group_user(group=admin.id, '
               'user=anna.id)\n'
               '        db.add_group_user(group_membership)\n'
               '        anna_groups = db.find_group_user_list(user=anna.id)\n'
               '        self.assertEqual(len(anna_groups), 2)\n'
               '\n'
               "        anna.email = 'wrong@email.address'\n"
               '        db.update_user(anna)\n'
               '\n'
               "        anna.email = 'szanna@pmgsz.hu'\n"
               '        db.update_user(anna)\n'
               '\n'
               "        anna2 = db.find_user(last_name='Szili')\n"
               '        self.assertEqual(anna, anna2)\n'
               '        self.assertEqual(repr(anna), repr(anna2))\n'
               '        self.assertEqual(repr(anna), str(anna2))\n'
               '\n'
               '        group_user_count = db.get_group_user_count()\n'
               '        db.delete_group_user(group_membership)\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'group_user_count - 1)\n'
               '        db.delete_group_user(group_membership)\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'group_user_count - 1)\n'
               '\n'
               '       '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=145,
          lineno=294,
          tokens=215,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body=' db.add_group_user(group_membership)\n'
               '\n'
               '        self.assertRaises(\n'
               '            db.IntegrityError,\n'
               '            db.add_group_user,\n'
               '            group_membership)\n'
               '        db.rollback()\n'
               '\n'
               '        user_list = db.get_user_list()\n'
               '        db.update_user_list(user_list)\n'
               '        db.update_user_list(user_list[:1])\n'
               '        db.update_user_list([])\n'
               '        db.rollback()\n'
               '\n'
               '        group_user_list = db.get_group_user_list()\n'
               '\n'
               '        db.delete_group_user(group_user_list[0])\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'len(group_user_list) - 1)\n'
               '        db.rollback()\n'
               '\n'
               '        db.delete_group_user(group_user_list[0].id)\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'len(group_user_list) - 1)\n'
               '        db.rollback()\n'
               '\n'
               '        db.delete_group_user_list(group_user_list[:2])\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'len(group_user_list) - 2)\n'
               '        db.rollback()\n'
               '\n'
               '        db.delete_group_user_list([group_user.id for '
               'group_user in group_user_list])\n'
               '        self.assertEqual(db.get_group_user_count(), 0)\n'
               '        db.rollback()\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=146,
          lineno=325,
          tokens=240,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def do_failed_transaction(self):\n'
               '        try:\n'
               '            with self.db.transaction():\n'
               "                group_x = self.db.new_group(slug='x', "
               "name='y')\n"
               '                self.db.add_group(group_x)\n'
               '                raise ValueError()\n'
               '        except ValueError:\n'
               '            pass\n'
               '\n'
               "        self.assertTrue(self.db.find_group(slug='x') is None)\n"
               '\n'
               '    def test_clauses_class(self):\n'
               '        """ Tests the Clauses class\n'
               '        """\n'
               '\n'
               '        Clauses = self.db.Clauses\n'
               '        ns = dict(clauses=clauses)\n'
               '\n'
               "        empty_clauses = Clauses(table_list=('tbl1',))\n"
               '        self.assertEqual(eval(repr(empty_clauses), ns), '
               'empty_clauses)\n'
               '\n'
               '        full_clauses = Clauses(\n'
               "            table_list=('tbl2',),\n"
               "            field_list=('a', 'b', 'c', 'COUNT(*) AS cnt'),\n"
               '            where=\'"a" = ?\',\n'
               "            group_by=('d',),\n"
               "            having='cnt > 3',\n"
               "            order_by=('b', 'c'),\n"
               '            limit=10,\n'
               '            offset=20)\n'
               '        self.assertEqual(eval(repr(full_clauses), ns), '
               'full_clauses)\n'
               '\n'
               '        empty_hash = hash(empty_clauses)\n'
               '        self.assertEqual(empty_has'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=147,
          lineno=359,
          tokens=155,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='h, hash(empty_clauses))\n'
               '        self.assertEqual(empty_clauses, empty_clauses)\n'
               '\n'
               '        full_hash = hash(full_clauses)\n'
               '        self.assertEqual(full_clauses, full_clauses)\n'
               '        self.assertEqual(full_hash, hash(full_clauses))\n'
               '\n'
               "        self.assertNotEqual(empty_clauses, 'something else')\n"
               '        self.assertNotEqual(empty_clauses, full_clauses)\n'
               '        self.assertNotEqual(empty_hash, full_hash)  # Probably '
               'and should be\n'
               '\n'
               '        clauses_cache = {}\n'
               '        clauses_cache[empty_clauses] = repr(empty_clauses)\n'
               '        self.assertEqual(clauses_cache[empty_clauses], '
               'str(empty_clauses))\n'
               '        clauses_cache[full_clauses] = repr(full_clauses)\n'
               '        self.assertEqual(clauses_cache[full_clauses], '
               'str(full_clauses))\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=148,
          lineno=375,
          tokens=202,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_random_id_selection(self):\n'
               '        """ Tests whether colliding random IDs are properly '
               'replaced\n'
               '        """\n'
               '\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        # Use a very narrow random ID range for the tests\n'
               '        original_range = constants.DATABASE_ID_RANGE\n'
               '        constants.DATABASE_ID_RANGE = (1, 10)\n'
               '        try:\n'
               '            group_list = [\n'
               "                db.new_group(slug='g%d' % n, name='G%d' % n)\n"
               '                for n in range(*constants.DATABASE_ID_RANGE)]\n'
               '\n'
               '            # Add all ten possible records multiple times\n'
               '            for n in range(10):\n'
               '                # Add ony by one\n'
               '                with db.transaction():\n'
               '                    for group in group_list:\n'
               '                        db.add_group(group)\n'
               '                    db.delete_group_list(group_list)\n'
               '\n'
               '                # Add as a list\n'
               '                with db.transaction():\n'
               '                    db.add_group_list(group_list)\n'
               '                    db.delete_group_list(group_list)\n'
               '\n'
               '            # Add them again\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=149,
          lineno=405,
          tokens=249,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='            with db.transaction():\n'
               '                db.add_group_list(group_list)\n'
               '\n'
               '            # Try to add one more, it should result in an '
               'IntegrityError all the time\n'
               "            group = db.new_group(slug='gX', name='GX')\n"
               '            for n in range(10):\n'
               '                with db.transaction():\n'
               '                    self.assertRaises(db.IntegrityError, '
               'db.add_group, group)\n'
               '\n'
               '            # Verify the detection function\n'
               '            try:\n'
               '                db.add_group_list([group, group])\n'
               '            except db.IntegrityError as reason:\n'
               '                '
               'self.assertTrue(db.is_primary_key_conflict(reason))\n'
               '            else:\n'
               '                self.assertTrue(False)\n'
               '            db.rollback()\n'
               '\n'
               '            # Verify that other unique constraint conflicts '
               'are not misdetected as an ID conflict\n'
               '            with db.transaction():\n'
               '                # Reserve a single ID for the new record\n'
               '                db.delete_group(group_list[0])\n'
               '            with db.transaction():\n'
               '                try:\n'
               "                    # Conflicting group name, but there's a "
               'free ID\n'
               '                    db.add_group(group_list[1])\n'
               '                except db.IntegrityError as reason:\n'
               '                    self.assertTrue(not '
               'db.is_primary_key_conflict(reason))\n'
               '                    db.rollback()\n'
               '                else:\n'
               '                    self.assertTrue(False)\n'
               '        finally:\n'
               '            constants.DATABASE_ID_RANGE = (1, 11)\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=150,
          lineno=438,
          tokens=246,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_user_contact_query(self):\n'
               '        """ Test the UserContact query\n'
               '        """\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        with db.transaction():\n'
               '            self.load_data()\n'
               '\n'
               '        self.assertEqual(db.query_user_contact_count(), 4)\n'
               '        '
               'self.assertEqual(db.query_user_contact_count(phone=None), 1)\n'
               '        '
               'self.assertEqual(db.query_user_contact_count(phone_ne=None), '
               '3)\n'
               '        '
               "self.assertEqual(db.query_user_contact_count(phone=''), 0)\n"
               '        '
               "self.assertEqual(db.query_user_contact_count(phone='1234567'), "
               '1)\n'
               '        '
               'self.assertEqual(db.query_user_contact_count(phone_in=()), 0)\n'
               '        '
               "self.assertEqual(db.query_user_contact_count(phone_in=('1234567',)), "
               '1)\n'
               '        '
               "self.assertEqual(db.query_user_contact_count(phone_in=['1234567', "
               "'2345678']), 2)\n"
               '        '
               "self.assertEqual(db.query_user_contact_count(phone_in=('1234567', "
               "'2345678')), 2)\n"
               '        '
               "self.assertEqual(db.query_user_contact_count(phone_not_in=['1234567']), "
               '2)\n'
               '        '
               'self.assertEqual(db.query_user_contact_count(phone_not_in=[]), '
               '4)\n'
               '        # TODO: Add tests for all the other operators here\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=151,
          lineno=460,
          tokens=167,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_product_sale_query(self):\n'
               '        """ Tests the ProductSale query\n'
               '        """\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        with db.transaction():\n'
               '            self.load_data()\n'
               '\n'
               '        product_sale_list = db.query_product_sale_list()\n'
               '        product_sale_list.sort(key=lambda r: r.product_name)\n'
               '\n'
               '        product_sale_list2 = '
               'list(db.query_product_sale_iter())\n'
               '        product_sale_list2.sort(key=lambda r: r.product_name)\n'
               '\n'
               '        self.assertEqual(product_sale_list, '
               'product_sale_list2)\n'
               '\n'
               '        self.assertEqual(len(product_sale_list), 2)\n'
               '        self.assertEqual(db.query_product_sale_count(), 2)\n'
               '\n'
               '        bar_sales, foo_sales = product_sale_list\n'
               '\n'
               '        self.assertEqual(bar_sales.product_name, '
               "'consulting')\n"
               "        self.assertEqual(foo_sales.product_name, 'hdd')\n"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=152,
          lineno=485,
          tokens=195,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_triggers(self):\n'
               '        """ Tests whether the triggers are working\n'
               '        """\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        # After insert or update trigger\n'
               '        with db.transaction():\n'
               '            # Add a product\n'
               "            hdd = db.new_product(name='hdd')\n"
               '            self.assertTrue(hdd.last_modified is None)\n'
               '            db.add_product(hdd)\n'
               '\n'
               '            # Check whether the last modified time is filled '
               'in\n'
               '            hdd = db.get_product(hdd.id)\n'
               '            created = hdd.last_modified\n'
               '            self.assertTrue(created)\n'
               '\n'
               '            # Modify the product\n'
               "            hdd.model = 'Samsung'\n"
               '            hdd.last_modified = created - '
               'datetime.timedelta(days=1)\n'
               '            db.update_product(hdd)\n'
               '\n'
               '            # Check whether the last modified time is updated\n'
               '            hdd = db.get_product(hdd.id)\n'
               '            self.assertTrue(hdd.last_modified >= created)\n'
               '\n'
               '        # TODO: Test more triggers\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=153,
          lineno=514,
          tokens=166,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_full_text_search(self):\n'
               '        """ Tests full text search index\n'
               '        """\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        with db.transaction():\n'
               '            self.load_data()\n'
               '\n'
               '        with db.transaction():\n'
               '            user_list = '
               "db.find_user_list(full_text_search='viktor:*')\n"
               '        self.assertEqual(len(user_list), 1)\n'
               "        self.assertEqual(user_list[0].first_name, 'Viktor')\n"
               '\n'
               '        with db.transaction():\n'
               '            user_list = db.find_user_list(\n'
               "                full_text_search='ferenczi', "
               "order_by=('first_name', 'last_name'))\n"
               '        self.assertEqual(len(user_list), 2)\n'
               "        self.assertEqual(user_list[0].first_name, 'Anna')\n"
               "        self.assertEqual(user_list[1].first_name, 'Viktor')\n"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=154,
          lineno=535,
          tokens=224,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_repr_str(self):\n'
               '        """ Tests whether all the objects can be printed\n'
               '        """\n'
               '        obj_list = (\n'
               '            self.db,\n'
               '            self.abstraction.TestDatabase,\n'
               '            model.User,\n'
               '            model.Product,\n'
               '            model.ProductSale)\n'
               '        for obj in obj_list:\n'
               '            for name in dir(obj):\n'
               "                if name.startswith('__'):\n"
               '                    continue\n'
               '                value = getattr(obj, name)\n'
               '                self.assertTrue(repr(value))\n'
               "                self.assertTrue(':' + str(value))\n"
               '\n'
               '    def test_tuple_dict(self):\n'
               '        """ Tests whether the field values can be acquired\n'
               '        """\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '\n'
               '        for product in self.db.get_product_iter():\n'
               '            break\n'
               '        assert isinstance(product, '
               'self.abstraction.ProductRecord)\n'
               '\n'
               '        field_dict = product.dict\n'
               '        field_tuple = product.tuple\n'
               '        self.assertEqual(len(field_dict), len(field_tuple))\n'
               '        self.assertEqual(field_tuple, tuple(field_dict[name] '
               'for name in product._column_name_list))\n'
               '        self.assertEqual(product, '
               'self.db.new_product(*field_tuple))\n'
               '        self.assertEqual(product, '
               'self.db.new_product(**field_dict))\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=155,
          lineno=569,
          tokens=198,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_order_by(self):\n'
               '\n'
               '        get_result_list = '
               "self.db.get_user_list(order_by=('first_name',))\n"
               '        find_result_list = '
               "self.db.find_user_list(order_by=('first_name',))\n"
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)\n'
               '\n'
               '        get_result_list = '
               "self.db.get_user_list(order_by=('+first_name',))\n"
               '        find_result_list = '
               "self.db.find_user_list(order_by=('+first_name',))\n"
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)\n'
               '\n'
               '        get_result_list = '
               "self.db.get_user_list(order_by=('-first_name',))\n"
               '        find_result_list = '
               "self.db.find_user_list(order_by=('-first_name',))\n"
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)\n'
               '\n'
               '        get_result_list = '
               "self.db.get_user_list(order_by=('+id',))\n"
               '        find_result_list = '
               "self.db.find_user_list(order_by=('-id',))\n"
               '        find_result_list.reverse()\n'
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=156,
          lineno=588,
          tokens=209,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_class_formatting(self):\n'
               '\n'
               '        code = model.TestDatabaseModel.pretty_format_class()\n'
               '        namespace = {}\n'
               '        exec(code, namespace, namespace)\n'
               '        database_model_class = '
               "namespace.get('TestDatabaseModel')\n"
               '        self.assertTrue(issubclass(database_model_class, '
               'model.database.Database))\n'
               '\n'
               "        with open('abstraction.py', 'rt') as module_file:\n"
               '            old_source = module_file.read()\n'
               '\n'
               '        '
               'model.generate(database_model_class=database_model_class)\n'
               '\n'
               "        with open('abstraction.py', 'rt') as module_file:\n"
               '            new_source = module_file.read()\n'
               '\n'
               '        # Ignore the module docstring, since that contains a '
               'timestamp\n'
               "        RX_TIMESTAMP = re.compile('\\d{4}-\\d{2}-\\d{2} "
               "\\d{2}:\\d{2}:\\d{2}')\n"
               "        old_source = RX_TIMESTAMP.subn('<TIMESTAMP>', "
               'old_source)[1]\n'
               "        new_source = RX_TIMESTAMP.subn('<TIMESTAMP>', "
               'new_source)[1]\n'
               '\n'
               '        self.assertEqual(old_source, new_source)\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=157,
          lineno=611,
          tokens=241,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='\n'
               '    def test_inspection(self):\n'
               '\n'
               '        from dblayer.backend.postgresql import inspector\n'
               '\n'
               '        dsn = test_constants.TEST_DSN\n'
               '        \n'
               '        db = inspector.DatabaseInspector()\n'
               "        database_class = db.inspect(dsn, 'InspectedDatabase')\n"
               '        self.assertTrue(issubclass(database_class, '
               'dblayer.model.database.Database))\n'
               '\n'
               '        source = database_class.pretty_format_class()\n'
               '\n'
               '        inspected_model_path = os.path.join(MODEL_DIR, '
               "'inspected_model.py')\n"
               "        with open(inspected_model_path, 'wt') as "
               'inspected_model_file:\n'
               '            inspected_model_file.write(source)\n'
               '\n'
               '        from dblayer.test import inspected_model\n'
               '\n'
               '        inspected_database = '
               'inspected_model.InspectedDatabase\n'
               '        self.assertTrue(inspected_database, '
               'dblayer.model.database.Database)\n'
               '\n'
               '        for table in inspected_database._table_list:\n'
               '            self.assertIsInstance(table, '
               'dblayer.model.table.Table)\n'
               '\n'
               '        model.generate(\n'
               "            module_path='inspected_abstraction.py',\n"
               '            database_model_class=inspected_database,\n'
               "            abstraction_class_name='InspectedDatabase')\n"
               '\n'
               '        from dblayer.test import inspected_abstraction\n'
               '\n'
               '        db = inspected_abstraction.InspectedDatabase()\n'
               '        with db.session(dsn):\n'
               '\n'
               '            with db.transaction():\n'
               '                self.load_data(db)\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=158,
          lineno=648,
          tokens=169,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestAbstraction',
          body='            with db.transaction():\n'
               '                self.verify_data(db)\n'
               '            with db.transaction():\n'
               '                self.modify_data(db)\n'
               '\n'
               '            for table in inspected_database._table_list:\n'
               '                with db.transaction():\n'
               '                    assert isinstance(table, '
               'dblayer.model.table.Table)\n'
               "                    fn_get = getattr(db, 'get_%s' % "
               'table._table_name)\n'
               "                    fn_find = getattr(db, 'find_%s' % "
               'table._table_name)\n'
               "                    fn_update = getattr(db, 'update_%s' % "
               'table._table_name, None)\n'
               '                    record1 = fn_find()\n'
               '                    if record1 is None:\n'
               '                        continue\n'
               '                    fn_update(record1)\n'
               '                    record2 = fn_get(id=record1.id)\n'
               "                    if hasattr(record2, 'last_modified'):\n"
               '                        record2.last_modified = '
               'record1.last_modified\n'
               '                    self.assertEqual(record1, record2)'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=159,
          lineno=3,
          tokens=91,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import datetimeimport osimport reimport unittestimport '
               'dblayerimport dblayer.model.databaseimport '
               'dblayer.model.tablefrom dblayer.test import modelfrom '
               'dblayer.test import modelfrom dblayer import constantsfrom '
               'dblayer import constantsfrom dblayer.backend.base import '
               'clausesfrom dblayer.backend.base import clausesfrom '
               'dblayer.graph import gmlfrom dblayer.graph import gmlfrom '
               'dblayer.test import constants as test_constantsfrom '
               'dblayer.test import constants as test_constants'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=160,
          lineno=614,
          tokens=31,
          depth=5,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer.backend.postgresql import inspectorfrom '
               'dblayer.backend.postgresql import inspectorfrom dblayer.test '
               'import inspected_modelfrom dblayer.test import inspected_model'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=161,
          lineno=641,
          tokens=16,
          depth=5,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer.test import inspected_abstractionfrom '
               'dblayer.test import inspected_abstraction'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=162,
          lineno=1,
          tokens=7,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# -*- coding: utf8 -*-'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=163,
          lineno=73,
          tokens=26,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Automatic closing of connection in __del__ in no-error '
               'condition# Automatic closing of connection in __del__ after a '
               'database error'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=164,
          lineno=122,
          tokens=10,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Loads test data\n        # Associate users with groups'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=165,
          lineno=240,
          tokens=5,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Do data verification\n        '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=166,
          lineno=263,
          tokens=5,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Do data modification\n        '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=167,
          lineno=338,
          tokens=12,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Tests the Clauses class\n        # Probably and should be'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=168,
          lineno=377,
          tokens=89,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Tests whether colliding random IDs are properly replaced\n'
               '        # Use a very narrow random ID range for the tests# Add '
               'all ten possible records multiple times# Try to add one more, '
               'it should result in an IntegrityError all the time# Verify the '
               'detection function# Verify that other unique constraint '
               'conflicts are not misdetected as an ID conflict# Reserve a '
               'single ID for the new record# Conflicting group name, but '
               "there's a free ID"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=169,
          lineno=440,
          tokens=18,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Test the UserContact query\n'
               '        # TODO: Add tests for all the other operators here'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=170,
          lineno=462,
          tokens=7,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Tests the ProductSale query\n        '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=171,
          lineno=487,
          tokens=43,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Tests whether the triggers are working\n'
               '        # After insert or update trigger# Check whether the '
               'last modified time is filled in# Modify the product# Check '
               'whether the last modified time is updated# TODO: Test more '
               'triggers'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=172,
          lineno=516,
          tokens=7,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Tests full text search index\n        '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=173,
          lineno=537,
          tokens=10,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Tests whether all the objects can be printed\n        '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=174,
          lineno=554,
          tokens=10,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Tests whether the field values can be acquired\n        '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=175,
          lineno=605,
          tokens=41,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Ignore the module docstring, since that contains a '
               'timestamp\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=176,
          lineno=637,
          tokens=5,
          depth=9,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='inspected_abstraction.py'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=177,
          lineno=25,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='setUp',
          body='def setUp(self) -> None:\n'
               '        model.generate()\n'
               "        self.abstraction = __import__('abstraction')"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=178,
          lineno=29,
          tokens=37,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='testGML',
          body='def testGML(self):\n'
               '        model_instance = '
               "model.TestDatabaseModel('TestDatabase')\n"
               '        exporter = gml.GMLExporter(model_instance)\n'
               "        exporter.export('model.gml')"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=179,
          lineno=37,
          tokens=72,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='setUp',
          body='def setUp(self):\n'
               '        model.generate()\n'
               "        self.abstraction = __import__('abstraction')\n"
               '        self.db = self.abstraction.TestDatabase()\n'
               '        self.db.connect(test_constants.TEST_DSN)\n'
               '        self.db.enable_transactions()\n'
               '        with self.db.transaction():\n'
               '            self.db.drop_structure(ignore_errors=True)\n'
               '        with self.db.transaction():\n'
               '            self.db.create_structure()'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=180,
          lineno=48,
          tokens=56,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='tearDown',
          body='def tearDown(self):\n'
               '        if test_constants.LEAVE_CLEAN_DATABASE:\n'
               '            self.db.rollback()\n'
               '            with self.db.transaction():\n'
               '                self.db.drop_structure(ignore_errors=True)\n'
               '        self.db.disable_transactions()\n'
               '        self.db.close()\n'
               '\n'
               '        # It must not fail\n'
               '        self.db.close()'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=181,
          lineno=59,
          tokens=227,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_database_session',
          body='def test_database_session(self):\n'
               '        db2 = self.abstraction.TestDatabase()\n'
               '        self.assertTrue(not db2.connected)\n'
               '        with db2.session(test_constants.TEST_DSN):\n'
               '            self.assertTrue(db2.connected)\n'
               '            with db2.transaction():\n'
               "                hdd = db2.new_product(name='hdd')\n"
               '                db2.add_product(hdd)\n'
               '            self.assertTrue(db2.connected)\n'
               '        self.assertTrue(not db2.connected)\n'
               '\n'
               '        with self.db.transaction():\n'
               '            '
               "self.assertEqual(self.db.find_product(name='hdd').id, hdd.id)\n"
               '\n'
               '        # Automatic closing of connection in __del__ in '
               'no-error condition\n'
               '        db3 = self.abstraction.TestDatabase()\n'
               '        db3.connect(test_constants.TEST_DSN)\n'
               '        self.assertTrue(db3.connected)\n'
               '        del db3\n'
               '\n'
               '        # Automatic closing of connection in __del__ after a '
               'database error\n'
               '        db4 = self.abstraction.TestDatabase()\n'
               '        db4.connect(test_constants.TEST_DSN)\n'
               '        self.assertTrue(db4.connected)\n'
               '        with db4.cursor() as cursor:\n'
               '            self.assertRaises(db4.Error, db4.execute, cursor, '
               "'BAD SQL')\n"
               '        del db4'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=182,
          lineno=87,
          tokens=94,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_truncate',
          body='def test_truncate(self):\n'
               '        self.assertEqual(self.db.get_user_count(), 0)\n'
               '        with self.db.transaction():\n'
               '            self.db.truncate_all_tables()\n'
               '        self.assertEqual(self.db.get_user_count(), 0)\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '        self.assertNotEqual(self.db.get_user_count(), 0)\n'
               '        with self.db.transaction():\n'
               '            self.db.truncate_all_tables()\n'
               '        self.assertEqual(self.db.get_user_count(), 0)'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=183,
          lineno=99,
          tokens=33,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_insert_select',
          body='def test_insert_select(self):\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '        with self.db.transaction():\n'
               '            self.verify_data()\n'
               '        self.db.commit()'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=184,
          lineno=106,
          tokens=84,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_duplicate_insert',
          body='def test_duplicate_insert(self):\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '        user_list = self.db.get_user_list()\n'
               '        with self.db.transaction():\n'
               '            self.assertRaises(self.db.IntegrityError, '
               'self.db.add_user, user_list[0], generate_id=False)\n'
               '        with self.db.transaction():\n'
               '            self.assertRaises(self.db.IntegrityError, '
               'self.db.add_user_list, user_list, generate_id=False)'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=185,
          lineno=115,
          tokens=28,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_update_delete',
          body='def test_update_delete(self):\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '        self.modify_data()\n'
               '        self.do_failed_transaction()'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=186,
          lineno=121,
          tokens=196,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='load_data',
          body='def load_data(self, db=None):\n'
               '        """ Loads test data\n'
               '        """\n'
               '        if db is None:\n'
               '            db = self.db\n'
               '        if 0:\n'
               '            assert isinstance(db, '
               'self.abstraction.TestDatabase)\n'
               '\n'
               '        # Users\n'
               '        viktor = db.new_user(\n'
               "            email='viktor@ferenczi.eu',\n"
               "            first_name='Viktor',\n"
               "            last_name='Ferenczi',\n"
               "            phone='1234567')\n"
               '        anna = db.new_user(\n'
               "            email='anna@cx.hu',\n"
               "            first_name='Anna',\n"
               "            last_name='Szili',\n"
               "            phone='2345678')\n"
               '        isi = db.new_user(\n'
               "            email='isi@cx.hu',\n"
               "            first_name='István',\n"
               "            last_name='Horváth')\n"
               '        annacska = db.new_user(\n'
               "            email='anna@ferenczi.eu',\n"
               "            first_name='Anna',\n"
               "            last_name='Ferenczi',\n"
               '            '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=187,
          lineno=148,
          tokens=167,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='load_data',
          body="phone='4567890')\n"
               '        self.assertTrue(viktor.id is None)\n'
               '        db.add_user(viktor)\n'
               '        self.assertFalse(viktor.id is None)\n'
               '        db.add_user_list([anna, isi])\n'
               '        self.assertFalse(anna.id is None)\n'
               '        self.assertFalse(isi.id is None)\n'
               '        db.add_user_list([annacska])\n'
               '        self.assertFalse(annacska.id is None)\n'
               '        self.assertEqual(db.get_user_count(), 4)\n'
               '        db.add_user_list([])\n'
               '        self.assertEqual(db.get_user_count(), 4)\n'
               "        self.assertNotEqual(viktor, 'not a record')\n"
               '        self.assertNotEqual(viktor, anna)\n'
               '        self.assertNotEqual(viktor.id, anna.id)\n'
               '        self.assertNotEqual(viktor.id, isi.id)\n'
               '        self.assertNotEqual(vikto'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=188,
          lineno=164,
          tokens=144,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='load_data',
          body='r.id, annacska.id)\n'
               '        user_list = db.get_user_list()\n'
               '        self.assertEqual(len(user_list), db.get_user_count())\n'
               '\n'
               '        # Groups\n'
               '        admin = db.new_group(\n'
               "            slug='admin',\n"
               "            name='Admin')\n"
               '        provider = db.new_group(\n'
               "            slug='provider',\n"
               "            name='Service provider')\n"
               '        customer = db.new_group(\n'
               "            slug='customer',\n"
               "            name='Customer')\n"
               '        group_list = sorted([admin, provider, customer], '
               'key=lambda r: r.slug)\n'
               '        db.add_group_list(group_list)\n'
               '        self.assertEqual(len(group_list), '
               'db.get_group_count())\n'
               '        self.assertEqual(group_list, '
               'sorted(list(db.get_group_iter()), key=lambda r: r.slug))'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=189,
          lineno=181,
          tokens=156,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='load_data',
          body='\n'
               '\n'
               '        # Associate users with groups\n'
               '        group_user_list = [\n'
               '            db.new_group_user(group=admin.id, '
               'user=viktor.id),\n'
               '            db.new_group_user(group=provider.id, '
               'user=viktor.id),\n'
               '            db.new_group_user(group=provider.id, '
               'user=annacska.id),\n'
               '            db.new_group_user(group=customer.id, '
               'user=viktor.id),\n'
               '            db.new_group_user(group=customer.id, '
               'user=anna.id),\n'
               '            db.new_group_user(group=customer.id, '
               'user=isi.id)]\n'
               '        db.add_group_user_list(group_user_list)\n'
               '\n'
               '        # Verify data\n'
               '        group_user_id_list = set([group_user.id for group_user '
               'in group_user_list])\n'
               '        self.assertEqual(len(group_user_list), '
               'len(group_user_id_list))\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=190,
          lineno=196,
          tokens=117,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='load_data',
          body='        for group_user in db.get_group_user_list():\n'
               '            self.assertTrue(group_user.id in '
               'group_user_id_list)\n'
               '        self.assertEqual(len(group_user_list), '
               'db.get_group_user_count())\n'
               '        self.assertEqual(viktor, '
               "db.find_user(email='viktor@ferenczi.eu'))\n"
               '        self.assertEqual(anna, '
               "db.find_user(last_name='Szili'))\n"
               '\n'
               '        # Add products\n'
               "        hdd = db.new_product(name='hdd')\n"
               "        consulting = db.new_product(name='consulting')\n"
               '        db.add_product_list([hdd, consulting])\n'
               '\n'
               '        # Add two invoices\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=191,
          lineno=208,
          tokens=143,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='load_data',
          body='        for m, customer in [(1, anna), (2, isi)]:\n'
               '            invoice = db.new_invoice(\n'
               "                serial='2010/%04d' % m,\n"
               '                seller=viktor.id,\n'
               '                customer=customer.id,\n'
               '                net_amount=4600 * m,\n'
               '                vat_amount=1150 * m,\n'
               '                gross_amount=5750 * m,\n'
               '                issued_date=datetime.date(2010, 3, 31),\n'
               '                due_date=datetime.date(2010, 4, 30))\n'
               '            db.add_invoice(invoice)\n'
               '            item1 = db.new_invoice_item(\n'
               '                invoice=invoice.id,\n'
               '                product=hdd.id,\n'
               '                quantity=6 * m,\n'
               '    '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=192,
          lineno=223,
          tokens=141,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='load_data',
          body='            net_amount=600 * m,\n'
               '                vat_percent=2500 * m,\n'
               '                vat_amount=150 * m,\n'
               '                gross_amount=750 * m)\n'
               '            item2 = db.new_invoice_item(\n'
               '                invoice=invoice.id,\n'
               '                product=consulting.id,\n'
               '                quantity=20 * m,\n'
               '                first_day=datetime.date(2010, 4, 1),\n'
               '                last_day=datetime.date(2010, 4, 30),\n'
               '                net_amount=4000 * m,\n'
               '                vat_percent=25000 * m,\n'
               '                vat_amount=1000 * m,\n'
               '                gross_amount=5000 * m)\n'
               '            db.add_invoice_item_list([item1, item2])'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=193,
          lineno=239,
          tokens=179,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='verify_data',
          body='def verify_data(self, db=None):\n'
               '        """ Do data verification\n'
               '        """\n'
               '        if db is None:\n'
               '            db = self.db\n'
               '        if 0:\n'
               '            assert isinstance(db, '
               'self.abstraction.TestDatabase)\n'
               '\n'
               "        viktor = db.find_user(email='viktor@ferenczi.eu')\n"
               '        self.assertFalse(viktor is None)\n'
               "        anna = db.find_user(email='anna@cx.hu')\n"
               '        self.assertFalse(anna is None)\n'
               '\n'
               '        viktor_groups = '
               'db.find_group_user_list(user=viktor.id)\n'
               '        self.assertEqual(len(viktor_groups), 3)\n'
               '\n'
               '        anna_groups = db.find_group_user_list(user=anna.id)\n'
               '        self.assertEqual(len(anna_groups), 1)\n'
               '\n'
               '        get_result_list = db.get_user_list()\n'
               '        find_result_list = db.find_user_list()\n'
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=194,
          lineno=262,
          tokens=28,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='modify_data',
          body='def modify_data(self, db=None):\n'
               '        """ Do data modification\n'
               '        """\n'
               '        if db is None:\n'
               '            db = self.db\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=195,
          lineno=267,
          tokens=239,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='modify_data',
          body='        if 0:\n'
               '            assert isinstance(db, '
               'self.abstraction.TestDatabase)\n'
               '\n'
               "        admin = db.find_group(slug='admin')\n"
               "        anna = db.find_user(email='anna@cx.hu')\n"
               '        group_membership = db.new_group_user(group=admin.id, '
               'user=anna.id)\n'
               '        db.add_group_user(group_membership)\n'
               '        anna_groups = db.find_group_user_list(user=anna.id)\n'
               '        self.assertEqual(len(anna_groups), 2)\n'
               '\n'
               "        anna.email = 'wrong@email.address'\n"
               '        db.update_user(anna)\n'
               '\n'
               "        anna.email = 'szanna@pmgsz.hu'\n"
               '        db.update_user(anna)\n'
               '\n'
               "        anna2 = db.find_user(last_name='Szili')\n"
               '        self.assertEqual(anna, anna2)\n'
               '        self.assertEqual(repr(anna), repr(anna2))\n'
               '        self.assertEqual(repr(anna), str(anna2))\n'
               '\n'
               '        group_user_count = db.get_group_user_count()\n'
               '        db.delete_group_user(group_membership)\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'group_user_count - 1)\n'
               '        db.delete_group_user(group_membership)\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'group_user_count - 1)\n'
               '\n'
               '      '),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=196,
          lineno=294,
          tokens=216,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='modify_data',
          body='  db.add_group_user(group_membership)\n'
               '\n'
               '        self.assertRaises(\n'
               '            db.IntegrityError,\n'
               '            db.add_group_user,\n'
               '            group_membership)\n'
               '        db.rollback()\n'
               '\n'
               '        user_list = db.get_user_list()\n'
               '        db.update_user_list(user_list)\n'
               '        db.update_user_list(user_list[:1])\n'
               '        db.update_user_list([])\n'
               '        db.rollback()\n'
               '\n'
               '        group_user_list = db.get_group_user_list()\n'
               '\n'
               '        db.delete_group_user(group_user_list[0])\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'len(group_user_list) - 1)\n'
               '        db.rollback()\n'
               '\n'
               '        db.delete_group_user(group_user_list[0].id)\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'len(group_user_list) - 1)\n'
               '        db.rollback()\n'
               '\n'
               '        db.delete_group_user_list(group_user_list[:2])\n'
               '        self.assertEqual(db.get_group_user_count(), '
               'len(group_user_list) - 2)\n'
               '        db.rollback()\n'
               '\n'
               '        db.delete_group_user_list([group_user.id for '
               'group_user in group_user_list])\n'
               '        self.assertEqual(db.get_group_user_count(), 0)\n'
               '        db.rollback()'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=197,
          lineno=326,
          tokens=64,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='do_failed_transaction',
          body='def do_failed_transaction(self):\n'
               '        try:\n'
               '            with self.db.transaction():\n'
               "                group_x = self.db.new_group(slug='x', "
               "name='y')\n"
               '                self.db.add_group(group_x)\n'
               '                raise ValueError()\n'
               '        except ValueError:\n'
               '            pass\n'
               '\n'
               "        self.assertTrue(self.db.find_group(slug='x') is None)"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=198,
          lineno=337,
          tokens=174,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_clauses_class',
          body='def test_clauses_class(self):\n'
               '        """ Tests the Clauses class\n'
               '        """\n'
               '\n'
               '        Clauses = self.db.Clauses\n'
               '        ns = dict(clauses=clauses)\n'
               '\n'
               "        empty_clauses = Clauses(table_list=('tbl1',))\n"
               '        self.assertEqual(eval(repr(empty_clauses), ns), '
               'empty_clauses)\n'
               '\n'
               '        full_clauses = Clauses(\n'
               "            table_list=('tbl2',),\n"
               "            field_list=('a', 'b', 'c', 'COUNT(*) AS cnt'),\n"
               '            where=\'"a" = ?\',\n'
               "            group_by=('d',),\n"
               "            having='cnt > 3',\n"
               "            order_by=('b', 'c'),\n"
               '            limit=10,\n'
               '            offset=20)\n'
               '        self.assertEqual(eval(repr(full_clauses), ns), '
               'full_clauses)\n'
               '\n'
               '        empty_hash = hash(empty_clauses)\n'
               '        self.assertEqual(empty_hash,'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=199,
          lineno=359,
          tokens=153,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_clauses_class',
          body=' hash(empty_clauses))\n'
               '        self.assertEqual(empty_clauses, empty_clauses)\n'
               '\n'
               '        full_hash = hash(full_clauses)\n'
               '        self.assertEqual(full_clauses, full_clauses)\n'
               '        self.assertEqual(full_hash, hash(full_clauses))\n'
               '\n'
               "        self.assertNotEqual(empty_clauses, 'something else')\n"
               '        self.assertNotEqual(empty_clauses, full_clauses)\n'
               '        self.assertNotEqual(empty_hash, full_hash)  # Probably '
               'and should be\n'
               '\n'
               '        clauses_cache = {}\n'
               '        clauses_cache[empty_clauses] = repr(empty_clauses)\n'
               '        self.assertEqual(clauses_cache[empty_clauses], '
               'str(empty_clauses))\n'
               '        clauses_cache[full_clauses] = repr(full_clauses)\n'
               '        self.assertEqual(clauses_cache[full_clauses], '
               'str(full_clauses))'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=200,
          lineno=376,
          tokens=200,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_random_id_selection',
          body='def test_random_id_selection(self):\n'
               '        """ Tests whether colliding random IDs are properly '
               'replaced\n'
               '        """\n'
               '\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        # Use a very narrow random ID range for the tests\n'
               '        original_range = constants.DATABASE_ID_RANGE\n'
               '        constants.DATABASE_ID_RANGE = (1, 10)\n'
               '        try:\n'
               '            group_list = [\n'
               "                db.new_group(slug='g%d' % n, name='G%d' % n)\n"
               '                for n in range(*constants.DATABASE_ID_RANGE)]\n'
               '\n'
               '            # Add all ten possible records multiple times\n'
               '            for n in range(10):\n'
               '                # Add ony by one\n'
               '                with db.transaction():\n'
               '                    for group in group_list:\n'
               '                        db.add_group(group)\n'
               '                    db.delete_group_list(group_list)\n'
               '\n'
               '                # Add as a list\n'
               '                with db.transaction():\n'
               '                    db.add_group_list(group_list)\n'
               '                    db.delete_group_list(group_list)\n'
               '\n'
               '            # Add them again\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=201,
          lineno=405,
          tokens=249,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_random_id_selection',
          body='            with db.transaction():\n'
               '                db.add_group_list(group_list)\n'
               '\n'
               '            # Try to add one more, it should result in an '
               'IntegrityError all the time\n'
               "            group = db.new_group(slug='gX', name='GX')\n"
               '            for n in range(10):\n'
               '                with db.transaction():\n'
               '                    self.assertRaises(db.IntegrityError, '
               'db.add_group, group)\n'
               '\n'
               '            # Verify the detection function\n'
               '            try:\n'
               '                db.add_group_list([group, group])\n'
               '            except db.IntegrityError as reason:\n'
               '                '
               'self.assertTrue(db.is_primary_key_conflict(reason))\n'
               '            else:\n'
               '                self.assertTrue(False)\n'
               '            db.rollback()\n'
               '\n'
               '            # Verify that other unique constraint conflicts '
               'are not misdetected as an ID conflict\n'
               '            with db.transaction():\n'
               '                # Reserve a single ID for the new record\n'
               '                db.delete_group(group_list[0])\n'
               '            with db.transaction():\n'
               '                try:\n'
               "                    # Conflicting group name, but there's a "
               'free ID\n'
               '                    db.add_group(group_list[1])\n'
               '                except db.IntegrityError as reason:\n'
               '                    self.assertTrue(not '
               'db.is_primary_key_conflict(reason))\n'
               '                    db.rollback()\n'
               '                else:\n'
               '                    self.assertTrue(False)\n'
               '        finally:\n'
               '            constants.DATABASE_ID_RANGE = (1, 11)'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=202,
          lineno=439,
          tokens=243,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_user_contact_query',
          body='def test_user_contact_query(self):\n'
               '        """ Test the UserContact query\n'
               '        """\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        with db.transaction():\n'
               '            self.load_data()\n'
               '\n'
               '        self.assertEqual(db.query_user_contact_count(), 4)\n'
               '        '
               'self.assertEqual(db.query_user_contact_count(phone=None), 1)\n'
               '        '
               'self.assertEqual(db.query_user_contact_count(phone_ne=None), '
               '3)\n'
               '        '
               "self.assertEqual(db.query_user_contact_count(phone=''), 0)\n"
               '        '
               "self.assertEqual(db.query_user_contact_count(phone='1234567'), "
               '1)\n'
               '        '
               'self.assertEqual(db.query_user_contact_count(phone_in=()), 0)\n'
               '        '
               "self.assertEqual(db.query_user_contact_count(phone_in=('1234567',)), "
               '1)\n'
               '        '
               "self.assertEqual(db.query_user_contact_count(phone_in=['1234567', "
               "'2345678']), 2)\n"
               '        '
               "self.assertEqual(db.query_user_contact_count(phone_in=('1234567', "
               "'2345678')), 2)\n"
               '        '
               "self.assertEqual(db.query_user_contact_count(phone_not_in=['1234567']), "
               '2)\n'
               '        '
               'self.assertEqual(db.query_user_contact_count(phone_not_in=[]), '
               '4)\n'
               '        # TODO: Add tests for all the other operators here'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=203,
          lineno=461,
          tokens=165,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_product_sale_query',
          body='def test_product_sale_query(self):\n'
               '        """ Tests the ProductSale query\n'
               '        """\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        with db.transaction():\n'
               '            self.load_data()\n'
               '\n'
               '        product_sale_list = db.query_product_sale_list()\n'
               '        product_sale_list.sort(key=lambda r: r.product_name)\n'
               '\n'
               '        product_sale_list2 = '
               'list(db.query_product_sale_iter())\n'
               '        product_sale_list2.sort(key=lambda r: r.product_name)\n'
               '\n'
               '        self.assertEqual(product_sale_list, '
               'product_sale_list2)\n'
               '\n'
               '        self.assertEqual(len(product_sale_list), 2)\n'
               '        self.assertEqual(db.query_product_sale_count(), 2)\n'
               '\n'
               '        bar_sales, foo_sales = product_sale_list\n'
               '\n'
               '        self.assertEqual(bar_sales.product_name, '
               "'consulting')\n"
               "        self.assertEqual(foo_sales.product_name, 'hdd')"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=204,
          lineno=486,
          tokens=192,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_triggers',
          body='def test_triggers(self):\n'
               '        """ Tests whether the triggers are working\n'
               '        """\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        # After insert or update trigger\n'
               '        with db.transaction():\n'
               '            # Add a product\n'
               "            hdd = db.new_product(name='hdd')\n"
               '            self.assertTrue(hdd.last_modified is None)\n'
               '            db.add_product(hdd)\n'
               '\n'
               '            # Check whether the last modified time is filled '
               'in\n'
               '            hdd = db.get_product(hdd.id)\n'
               '            created = hdd.last_modified\n'
               '            self.assertTrue(created)\n'
               '\n'
               '            # Modify the product\n'
               "            hdd.model = 'Samsung'\n"
               '            hdd.last_modified = created - '
               'datetime.timedelta(days=1)\n'
               '            db.update_product(hdd)\n'
               '\n'
               '            # Check whether the last modified time is updated\n'
               '            hdd = db.get_product(hdd.id)\n'
               '            self.assertTrue(hdd.last_modified >= created)\n'
               '\n'
               '        # TODO: Test more triggers'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=205,
          lineno=515,
          tokens=164,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_full_text_search',
          body='def test_full_text_search(self):\n'
               '        """ Tests full text search index\n'
               '        """\n'
               '        db = self.db\n'
               '        assert isinstance(db, self.abstraction.TestDatabase)\n'
               '\n'
               '        with db.transaction():\n'
               '            self.load_data()\n'
               '\n'
               '        with db.transaction():\n'
               '            user_list = '
               "db.find_user_list(full_text_search='viktor:*')\n"
               '        self.assertEqual(len(user_list), 1)\n'
               "        self.assertEqual(user_list[0].first_name, 'Viktor')\n"
               '\n'
               '        with db.transaction():\n'
               '            user_list = db.find_user_list(\n'
               "                full_text_search='ferenczi', "
               "order_by=('first_name', 'last_name'))\n"
               '        self.assertEqual(len(user_list), 2)\n'
               "        self.assertEqual(user_list[0].first_name, 'Anna')\n"
               "        self.assertEqual(user_list[1].first_name, 'Viktor')"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=206,
          lineno=536,
          tokens=95,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_repr_str',
          body='def test_repr_str(self):\n'
               '        """ Tests whether all the objects can be printed\n'
               '        """\n'
               '        obj_list = (\n'
               '            self.db,\n'
               '            self.abstraction.TestDatabase,\n'
               '            model.User,\n'
               '            model.Product,\n'
               '            model.ProductSale)\n'
               '        for obj in obj_list:\n'
               '            for name in dir(obj):\n'
               "                if name.startswith('__'):\n"
               '                    continue\n'
               '                value = getattr(obj, name)\n'
               '                self.assertTrue(repr(value))\n'
               "                self.assertTrue(':' + str(value))"),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=207,
          lineno=553,
          tokens=126,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_tuple_dict',
          body='def test_tuple_dict(self):\n'
               '        """ Tests whether the field values can be acquired\n'
               '        """\n'
               '        with self.db.transaction():\n'
               '            self.load_data()\n'
               '\n'
               '        for product in self.db.get_product_iter():\n'
               '            break\n'
               '        assert isinstance(product, '
               'self.abstraction.ProductRecord)\n'
               '\n'
               '        field_dict = product.dict\n'
               '        field_tuple = product.tuple\n'
               '        self.assertEqual(len(field_dict), len(field_tuple))\n'
               '        self.assertEqual(field_tuple, tuple(field_dict[name] '
               'for name in product._column_name_list))\n'
               '        self.assertEqual(product, '
               'self.db.new_product(*field_tuple))\n'
               '        self.assertEqual(product, '
               'self.db.new_product(**field_dict))'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=208,
          lineno=570,
          tokens=196,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_order_by',
          body='def test_order_by(self):\n'
               '\n'
               '        get_result_list = '
               "self.db.get_user_list(order_by=('first_name',))\n"
               '        find_result_list = '
               "self.db.find_user_list(order_by=('first_name',))\n"
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)\n'
               '\n'
               '        get_result_list = '
               "self.db.get_user_list(order_by=('+first_name',))\n"
               '        find_result_list = '
               "self.db.find_user_list(order_by=('+first_name',))\n"
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)\n'
               '\n'
               '        get_result_list = '
               "self.db.get_user_list(order_by=('-first_name',))\n"
               '        find_result_list = '
               "self.db.find_user_list(order_by=('-first_name',))\n"
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)\n'
               '\n'
               '        get_result_list = '
               "self.db.get_user_list(order_by=('+id',))\n"
               '        find_result_list = '
               "self.db.find_user_list(order_by=('-id',))\n"
               '        find_result_list.reverse()\n'
               '        self.assertAlmostEqual(get_result_list, '
               'find_result_list)'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=209,
          lineno=589,
          tokens=207,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_class_formatting',
          body='def test_class_formatting(self):\n'
               '\n'
               '        code = model.TestDatabaseModel.pretty_format_class()\n'
               '        namespace = {}\n'
               '        exec(code, namespace, namespace)\n'
               '        database_model_class = '
               "namespace.get('TestDatabaseModel')\n"
               '        self.assertTrue(issubclass(database_model_class, '
               'model.database.Database))\n'
               '\n'
               "        with open('abstraction.py', 'rt') as module_file:\n"
               '            old_source = module_file.read()\n'
               '\n'
               '        '
               'model.generate(database_model_class=database_model_class)\n'
               '\n'
               "        with open('abstraction.py', 'rt') as module_file:\n"
               '            new_source = module_file.read()\n'
               '\n'
               '        # Ignore the module docstring, since that contains a '
               'timestamp\n'
               "        RX_TIMESTAMP = re.compile('\\d{4}-\\d{2}-\\d{2} "
               "\\d{2}:\\d{2}:\\d{2}')\n"
               "        old_source = RX_TIMESTAMP.subn('<TIMESTAMP>', "
               'old_source)[1]\n'
               "        new_source = RX_TIMESTAMP.subn('<TIMESTAMP>', "
               'new_source)[1]\n'
               '\n'
               '        self.assertEqual(old_source, new_source)'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=210,
          lineno=612,
          tokens=239,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_inspection',
          body='def test_inspection(self):\n'
               '\n'
               '        from dblayer.backend.postgresql import inspector\n'
               '\n'
               '        dsn = test_constants.TEST_DSN\n'
               '        \n'
               '        db = inspector.DatabaseInspector()\n'
               "        database_class = db.inspect(dsn, 'InspectedDatabase')\n"
               '        self.assertTrue(issubclass(database_class, '
               'dblayer.model.database.Database))\n'
               '\n'
               '        source = database_class.pretty_format_class()\n'
               '\n'
               '        inspected_model_path = os.path.join(MODEL_DIR, '
               "'inspected_model.py')\n"
               "        with open(inspected_model_path, 'wt') as "
               'inspected_model_file:\n'
               '            inspected_model_file.write(source)\n'
               '\n'
               '        from dblayer.test import inspected_model\n'
               '\n'
               '        inspected_database = '
               'inspected_model.InspectedDatabase\n'
               '        self.assertTrue(inspected_database, '
               'dblayer.model.database.Database)\n'
               '\n'
               '        for table in inspected_database._table_list:\n'
               '            self.assertIsInstance(table, '
               'dblayer.model.table.Table)\n'
               '\n'
               '        model.generate(\n'
               "            module_path='inspected_abstraction.py',\n"
               '            database_model_class=inspected_database,\n'
               "            abstraction_class_name='InspectedDatabase')\n"
               '\n'
               '        from dblayer.test import inspected_abstraction\n'
               '\n'
               '        db = inspected_abstraction.InspectedDatabase()\n'
               '        with db.session(dsn):\n'
               '\n'
               '            with db.transaction():\n'
               '                self.load_data(db)\n'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=211,
          lineno=648,
          tokens=169,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='test_inspection',
          body='            with db.transaction():\n'
               '                self.verify_data(db)\n'
               '            with db.transaction():\n'
               '                self.modify_data(db)\n'
               '\n'
               '            for table in inspected_database._table_list:\n'
               '                with db.transaction():\n'
               '                    assert isinstance(table, '
               'dblayer.model.table.Table)\n'
               "                    fn_get = getattr(db, 'get_%s' % "
               'table._table_name)\n'
               "                    fn_find = getattr(db, 'find_%s' % "
               'table._table_name)\n'
               "                    fn_update = getattr(db, 'update_%s' % "
               'table._table_name, None)\n'
               '                    record1 = fn_find()\n'
               '                    if record1 is None:\n'
               '                        continue\n'
               '                    fn_update(record1)\n'
               '                    record2 = fn_get(id=record1.id)\n'
               "                    if hasattr(record2, 'last_modified'):\n"
               '                        record2.last_modified = '
               'record1.last_modified\n'
               '                    self.assertEqual(record1, record2)'),
 Fragment(document_cs='36692073cdf50a3546e8ed806a4b5745ed44b7abbb93733df7e8906b37b03e92',
          id=212,
          lineno=1,
          tokens=536,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: TestAbstraction TestGraph\n'
               '  Methods: do_failed_transaction load_data modify_data setUp '
               'tearDown testGML test_class_formatting test_clauses_class '
               'test_database_session test_duplicate_insert '
               'test_full_text_search test_insert_select test_inspection '
               'test_order_by test_product_sale_query test_random_id_selection '
               'test_repr_str test_triggers test_truncate test_tuple_dict '
               'test_update_delete test_user_contact_query verify_data\n'
               '  Variables and usages: Clauses DATABASE_ID_RANGE Database '
               'DatabaseInspector Error GMLExporter InspectedDatabase '
               'IntegrityError LEAVE_CLEAN_DATABASE MODEL_DIR Product '
               'ProductRecord ProductSale RX_TIMESTAMP TEST_DSN Table TestCase '
               'TestDatabase TestDatabaseModel User ValueError '
               '_column_name_list _table_list _table_name abstraction '
               'abstraction_class_name add_group add_group_list add_group_user '
               'add_group_user_list add_invoice add_invoice_item_list '
               'add_product add_product_list add_user add_user_list admin anna '
               'anna2 anna_groups annacska assertAlmostEqual assertEqual '
               'assertFalse assertIsInstance assertNotEqual assertRaises '
               'assertTrue backend bar_sales base clauses clauses_cache close '
               'code commit compile connect connected constants consulting '
               'create_structure created cursor customer database '
               'database_class database_model_class date datetime days dblayer '
               'delete_group delete_group_list delete_group_user '
               'delete_group_user_list dirname disable_transactions '
               'drop_structure due_date email empty_clauses empty_hash '
               'enable_transactions eval exec execute export exporter '
               'field_dict field_list field_tuple find_group '
               'find_group_user_list find_product find_result_list find_user '
               'find_user_list first_day first_name fn_find fn_get fn_update '
               'foo_sales full_clauses full_hash full_text_search generate '
               'generate_id get_group_count get_group_iter '
               'get_group_user_count get_group_user_list get_product '
               'get_product_iter get_result_list get_user_count get_user_list '
               'getattr graph gross_amount group group_by group_list '
               'group_membership group_user group_user_count '
               'group_user_id_list group_user_list group_x hasattr hash having '
               'ignore_errors inspect inspected_abstraction inspected_database '
               'inspected_model inspected_model_file inspected_model_path '
               'inspector invoice is_primary_key_conflict issued_date item1 '
               'item2 join last_day last_modified last_name limit model '
               'model_instance module_file module_path name namespace '
               'net_amount new_group new_group_user new_invoice '
               'new_invoice_item new_product new_source new_user obj_list '
               'offset old_source open order_by original_range path phone '
               'phone_in phone_ne phone_not_in postgresql pretty_format_class '
               'product product_name product_sale_list product_sale_list2 '
               'provider quantity query_product_sale_count '
               'query_product_sale_iter query_product_sale_list '
               'query_user_contact_count range read reason record1 record2 '
               'repr reverse rollback seller serial session slug sort sorted '
               'source startswith subn table table_list test test_constants '
               'timedelta transaction truncate_all_tables tuple unittest '
               'update_product update_user update_user_list user user_list '
               'value vat_amount vat_percent viktor viktor_groups where '
               'write\n'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=213,
          lineno=7,
          tokens=239,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseProcedure',
          body='class BaseProcedure:\n'
               '    """ Base class for stored procedures\n'
               '    """\n'
               '\n'
               '    # Serial number to record the order of procedure '
               'definitions\n'
               '    __definition_serial__ = 0\n'
               '\n'
               '    # Reference to the database class containing this '
               'procedure\n'
               '    # NOTE: Set by __new__ of the database definition class\n'
               '    database_class = None\n'
               '\n'
               '    # Name of the procedure\n'
               '    # NOTE: Set by __new__ of the database definition class\n'
               "    name = ''\n"
               '\n'
               '    @staticmethod\n'
               '    def sort_key(obj):\n'
               '        return obj.__definition_serial__\n'
               '\n'
               '    def __init__(self, language, argument_list, result, '
               'body):\n'
               '        assert self.__class__ is not BaseProcedure, (\n'
               "            'Only subclasses of BaseProcedure can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        self.language = language\n'
               '        self.argument_list = argument_list\n'
               '        self.result = result\n'
               '        self.body = body\n'
               '\n'
               '    def __str__(self):\n'
               "        return '<%s: %s%r returns %s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.name,\n'
               '            tuple(self.argument_list),\n'
               '            self.result)\n'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=214,
          lineno=44,
          tokens=135,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseProcedure',
          body='\n'
               '    def __repr__(self):\n'
               "        return '%s.%s(%r, %r, %r, %r)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               '            self.language,\n'
               '            self.argument_list,\n'
               '            self.result,\n'
               '            self.body)\n'
               '\n'
               '    def clone(self, database):\n'
               '        """ Clone this procedure for the database instance\n'
               '        \n'
               '        NOTE: It is called by Database.__init__ to bound the '
               'procedures to the database instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.database = database\n'
               '        return clone'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=215,
          lineno=66,
          tokens=12,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Procedure',
          body='class Procedure(BaseProcedure):\n'
               '    """ Stored procedure\n'
               '    """'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=216,
          lineno=4,
          tokens=10,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer import utilfrom dblayer import util'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=217,
          lineno=1,
          tokens=3,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Procedure definitions\n'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=218,
          lineno=8,
          tokens=57,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for stored procedures\n'
               '    # Serial number to record the order of procedure '
               'definitions# Reference to the database class containing this '
               'procedure# NOTE: Set by __new__ of the database definition '
               'class# Name of the procedure# NOTE: Set by __new__ of the '
               'database definition class'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=219,
          lineno=28,
          tokens=14,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseProcedure can be instantiated!# Record '
               'the definition order'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=220,
          lineno=39,
          tokens=12,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='<%s: %s%r returns %s>'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=221,
          lineno=46,
          tokens=15,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='%s.%s(%r, %r, %r, %r)'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=222,
          lineno=55,
          tokens=30,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Clone this procedure for the database instance\n'
               '        \n'
               '        NOTE: It is called by Database.__init__ to bound the '
               'procedures to the database instance.\n'
               '        \n'
               '        '),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=223,
          lineno=67,
          tokens=4,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Stored procedure\n    '),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=224,
          lineno=23,
          tokens=12,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='sort_key',
          body='def sort_key(obj):\n        return obj.__definition_serial__'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=225,
          lineno=26,
          tokens=83,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, language, argument_list, result, body):\n'
               '        assert self.__class__ is not BaseProcedure, (\n'
               "            'Only subclasses of BaseProcedure can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        self.language = language\n'
               '        self.argument_list = argument_list\n'
               '        self.result = result\n'
               '        self.body = body'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=226,
          lineno=38,
          tokens=43,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__str__',
          body='def __str__(self):\n'
               "        return '<%s: %s%r returns %s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.name,\n'
               '            tuple(self.argument_list),\n'
               '            self.result)'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=227,
          lineno=45,
          tokens=65,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s(%r, %r, %r, %r)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               '            self.language,\n'
               '            self.argument_list,\n'
               '            self.result,\n'
               '            self.body)'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=228,
          lineno=54,
          tokens=67,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='clone',
          body='def clone(self, database):\n'
               '        """ Clone this procedure for the database instance\n'
               '        \n'
               '        NOTE: It is called by Database.__init__ to bound the '
               'procedures to the database instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.database = database\n'
               '        return clone'),
 Fragment(document_cs='3946726dfe1f0a542ad81b7a8c4081f11a031be9025ffd0843366e4ff3c98d5c',
          id=229,
          lineno=1,
          tokens=52,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: BaseProcedure Procedure\n'
               '  Methods: __init__ __repr__ __str__ clone sort_key\n'
               '  Variables and usages: argument_list body database '
               'database_class dblayer get_next_definition_serial language '
               'name result rsplit staticmethod tuple update util\n'),
 Fragment(document_cs='3c32e3dc1667e2616e3f88efae8ca18a93d9de81f321e34be0c6dcffa2aa56ab',
          id=230,
          lineno=1,
          tokens=236,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Metadata-Version: 1.1\n'
               'Name: dblayer\n'
               'Version: 0.7.0\n'
               'Summary: Database Abstraction Layer Generator\n'
               'Home-page: http://code.google.com/p/dblayer\n'
               'Author: Viktor Ferenczi\n'
               'Author-email: viktor@ferenczi.eu\n'
               'License: MIT\n'
               'Description: Generates database abstraction layer in Python '
               'based on a\n'
               '        readable definition written as Python classes. '
               'Supports\n'
               '        defining of tables, basic column types, indexes,\n'
               '        constraints, full text search and complex queries.\n'
               '        Provides a light-weight approach of database access '
               'with\n'
               '        minimal runtime overhead and without any kind of '
               'hidden\n'
               '        magic, metaclasses or so. Provides maximum possible\n'
               '        support for auto completion in Python IDEs.\n'
               'Keywords: python database orm postgresql abstraction layer '
               'generator codegeneration performance\n'
               'Platform: UNKNOWN\n'
               'Classifier: Development Status :: 3 - Alpha\n'
               'Classifier: Operating System :: OS Independent\n'
               'Classifier: Intended Audience :: Developers\n'
               'Classifier: License :: OSI Approved :: MIT License\n'
               'Classifier: Topic :: Software Development :: Libraries :: '
               'Python Modules\n'
               'Classifier: Topic :: Database\n'
               'Classifier: Topic :: Software Development :: Code Generators\n'),
 Fragment(document_cs='3c32e3dc1667e2616e3f88efae8ca18a93d9de81f321e34be0c6dcffa2aa56ab',
          id=231,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='4030a166115ef2fa897010fe8d750c62e157be6b9cc0a1dfb06c394934c573b2',
          id=232,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='4374b24db9e5d713201b19f6515d4b4dd26f6f3d82e0a8281bd5ee832a93b4c4',
          id=233,
          lineno=1,
          tokens=9,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='recursive-include dblayer/generator/template *\n'),
 Fragment(document_cs='4374b24db9e5d713201b19f6515d4b4dd26f6f3d82e0a8281bd5ee832a93b4c4',
          id=234,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='449b6ca9977edf0af32f54918d2996eabebb98c1bda0c91e0ae67aef7765edd8',
          id=235,
          lineno=1,
          tokens=6,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Helpers to export database graphs\n'),
 Fragment(document_cs='449b6ca9977edf0af32f54918d2996eabebb98c1bda0c91e0ae67aef7765edd8',
          id=236,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='46dd62f01aa96f74d49d13f2436bb8dd7b82252af5d8bdadfaaa182500b68d19',
          id=237,
          lineno=1,
          tokens=3,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import psycopg2'),
 Fragment(document_cs='46dd62f01aa96f74d49d13f2436bb8dd7b82252af5d8bdadfaaa182500b68d19',
          id=238,
          lineno=1,
          tokens=28,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Variables and usages: DataError DatabaseError Error '
               'IntegrityError InterfaceError InternalError NotSupportedError '
               'OperationalError ProgrammingError Warning psycopg2\n'),
 Fragment(document_cs='49c63b31d40b8373af435f475c92071fcfaac9a3940f2ec396a04af4d9373f10',
          id=239,
          lineno=1,
          tokens=34,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Database backends\n'
               '\n'
               'The base subpackage contains generic implementation can be '
               'reused by \n'
               'the SQL server specific backend implementations.\n'
               '\n'
               'All the other subpackages contain SQL server specific '
               'implementations.\n'
               '\n'),
 Fragment(document_cs='49c63b31d40b8373af435f475c92071fcfaac9a3940f2ec396a04af4d9373f10',
          id=240,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='50107f51c991db83b2544186f6fa35be416530dc4a475a29d6c3e981d5b1d3a3',
          id=241,
          lineno=2,
          tokens=16,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer.backend.base.record import Recordfrom '
               'dblayer.backend.base.record import Record'),
 Fragment(document_cs='50107f51c991db83b2544186f6fa35be416530dc4a475a29d6c3e981d5b1d3a3',
          id=242,
          lineno=1,
          tokens=7,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# noinspection PyUnresolvedReferences'),
 Fragment(document_cs='50107f51c991db83b2544186f6fa35be416530dc4a475a29d6c3e981d5b1d3a3',
          id=243,
          lineno=1,
          tokens=13,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Variables and usages: Record backend base dblayer record\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=244,
          lineno=9,
          tokens=228,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Query',
          body='class Query(table.Table):\n'
               '    """ Query\n'
               '    """\n'
               '    # Queries need not be created and cannot be written\n'
               '    _creatable = False\n'
               '    _writable = False\n'
               '\n'
               '    # Mapping of alias names to the source Table instances\n'
               '    # NOTE: Filled in by the __new__ class method\n'
               '    _table_map = None\n'
               '\n'
               '    # Conditions\n'
               '    # NOTE: Filled in by the __new__ class method\n'
               '    _condition_list = ()\n'
               '\n'
               '    # Group by expressions (override in your subclass)\n'
               '    _group_by = ()\n'
               '\n'
               '    # Ordering expressions (override in your subclass)\n'
               '    _order_by = ()\n'
               '\n'
               '    def __new__(cls):\n'
               '        # Initialize the class only once\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               '        return super(Query, cls).__new__(cls)\n'
               '\n'
               '    @classmethod\n'
               '    def initialize(cls):\n'
               '\n'
               '        # Mark the class as initialized\n'
               "        # NOTE: It prevent Table's initialization from being "
               'executed, it is intentional\n'
               '        cls._initialized = True\n'
               '\n'
               '        # Collect objects from the class definition\n'
               '        cls._collect_result_condition_list()\n'
               '\n'
               '    @classmethod\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=245,
          lineno=48,
          tokens=205,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Query',
          body='    def _collect_result_condition_list(cls):\n'
               '        """ Collects the result column and condition '
               'definitions from the model class\n'
               '        """\n'
               '        cls._table_map = {}\n'
               '        cls._column_list = []\n'
               '        cls._condition_list = []\n'
               '        for name in dir(cls):\n'
               '            value = getattr(cls, name)\n'
               '\n'
               '            if isinstance(value, table.Table):\n'
               '                value._name = name\n'
               '                cls._table_map[name] = value\n'
               '\n'
               '            elif isinstance(value, Result):\n'
               '                value.table_class = cls\n'
               '                value.name = name\n'
               '                cls._column_list.append(value)\n'
               '\n'
               '            elif isinstance(value, Condition):\n'
               '                value.table_class = cls\n'
               '                value.name = name\n'
               '                cls._condition_list.append(value)\n'
               '\n'
               '        # Sort them by definition order\n'
               '        cls._column_list.sort(key=column.BaseColumn.sort_key)\n'
               '        cls._condition_list.sort(key=Condition.sort_key)\n'
               '\n'
               '    def __repr__(self):\n'
               "        return '<Query: %s>' % self._name\n"
               '\n'
               '    __str__ = __repr__\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=246,
          lineno=79,
          tokens=241,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Query',
          body='\n'
               '    def get_table_list(self):\n'
               '        """ Returns the table list for the clauses of the '
               'SELECT statement\n'
               '        \n'
               '        Items of the returned list can be either:\n'
               '        \n'
               '        (table_name, alias_name) to start a new cross join '
               'group or\n'
               '        (table_name, alias_name, join_type, id_field_name, '
               'referer_table_name, fk_field_name) to continue one.\n'
               '        \n'
               '        Unaliased tables are not used here.\n'
               '        \n'
               '        """\n'
               '        table_map = self._table_map.copy()\n'
               '\n'
               '        def iterate_joined_tables(referer, visited):\n'
               '            """ Appends tables referenced from the given table '
               'to the table list\n'
               '            """\n'
               '            # Iterate on all the tables remained in the table '
               'map\n'
               '            for alias_name, table in table_map.items():\n'
               '\n'
               '                # Determine the referer table for this table '
               'in the JOIN chain\n'
               '                foreign_key = table._referer\n'
               '                referer_table = foreign_key.table if '
               'foreign_key else None\n'
               '\n'
               "                # Is the referer the table we're looking for?\n"
               '                if referer_table is referer and alias_name not '
               'in visited:\n'
               '\n'
               '                    # Consider each table only once\n'
               '                    visited.add(alias_name)\n'
               '\n'
               '                    # Construct table list item\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=247,
          lineno=110,
          tokens=188,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Query',
          body='                    if referer is None:\n'
               '                        item = (\n'
               '                            # Database table name, not the '
               'alias in this query\n'
               '                            table._table_name,\n'
               '                            # Alias name in this query for '
               'this table\n'
               '                            alias_name)\n'
               '                    else:\n'
               '                        join_type = constants.LEFT_JOIN if '
               'foreign_key.null else constants.INNER_JOIN\n'
               '                        item = (\n'
               '                            # Database table name, not the '
               'alias in this query\n'
               '                            table._table_name,\n'
               '                            # Alias name in this query for '
               'this table\n'
               '                            alias_name,\n'
               '                            # Type of this joine, like INNER '
               'JOIN or LEFT JOIN\n'
               '                            join_type,\n'
               '                            # Name of the primary key column '
               'in the joined table\n'
               '                            table._primary_key.name,\n'
               '                            # Alias name of the referer '
               '(already joined) table\n'
               '                            referer_table._name,\n'
               '                            # Name of the referer foreign key '
               'column in the referer (already joined) table\n'
               '                            foreign_key.name)\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=248,
          lineno=131,
          tokens=64,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Query',
          body='\n'
               '                    if constants.DEBUG:\n'
               '                        assert not sum(1 for x in item if not '
               "x), 'Empty name(s) in join definition item: %r' % (item,)\n"
               '\n'
               '                    # Yield table list item\n'
               '                    yield item\n'
               '\n'
               '                    # Find all the referer tables below this '
               'point in the tree\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=249,
          lineno=139,
          tokens=243,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Query',
          body='                    for item in iterate_joined_tables(table, '
               'visited):\n'
               '                        yield item\n'
               '\n'
               '        visited = set()\n'
               '        table_list = list(iterate_joined_tables(None, '
               'visited))\n'
               '        assert len(visited) == len(table_map)\n'
               '\n'
               '        return table_list\n'
               '\n'
               '    @classmethod\n'
               '    def pretty_format_class(cls):\n'
               '        """ Formats source code defining the query\n'
               '        """\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               "        line_list = ['class %s(query.Query):' % cls.__name__]\n"
               '        append_line = line_list.append\n'
               '\n'
               '        if cls.__doc__:\n'
               "            if '\\n' in cls.__doc__:\n"
               '                append_line(\'    """%s"""\' % cls.__doc__)\n'
               '            else:\n'
               '                append_line(\'    """ %s """\' % '
               'cls.__doc__.strip())\n'
               '        else:\n'
               "            append_line('')\n"
               '\n'
               '        for alias, table in sorted(cls._table_map.items()):\n'
               "            append_line('    %s = %s()' % (alias, "
               'table.__class__.__name__))\n'
               "        append_line('')\n"
               '\n'
               '        for obj in cls._column_list:\n'
               "            append_line('    %s = %s' % (obj.name, "
               'obj.full_repr()))\n'
               '\n'
               "        append_line('')\n"),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=250,
          lineno=174,
          tokens=139,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Query',
          body='\n'
               '        for obj in cls._condition_list:\n'
               "            append_line('    %s = %s' % (obj.name, "
               'obj.full_repr()))\n'
               '\n'
               "        append_line('')\n"
               '\n'
               '        if cls._group_by:\n'
               "            append_line('    _group_by = %r' % "
               '(cls._group_by,))\n'
               '\n'
               '        if cls._order_by:\n'
               "            append_line('    _order_by = %r' % "
               '(cls._order_by,))\n'
               '\n'
               '        for i in range(len(line_list) - 1, 1, -1):\n'
               '            if not line_list[i] and not line_list[i - 1]:\n'
               '                del line_list[i]\n'
               '\n'
               "        return '\\n'.join(line_list)"),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=251,
          lineno=193,
          tokens=134,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseQueryResult',
          body='class BaseQueryResult(column.BaseColumn):\n'
               '    """ Base class for columns used in a query either as a '
               'result or a condition\n'
               '    \n'
               '    The expression can be a column of a source table or any '
               'expression built\n'
               '    from functions and aggregations in any way acceptable in '
               'an SQL statement.\n'
               '    \n'
               '    """\n'
               '\n'
               '    # Expression to evaluate to get the value of the given '
               'result column\n'
               '    expression = None\n'
               '\n'
               '    # Column definition for calculated results, required for '
               'expressions,\n'
               '    # filled automatically in the case of simple source column '
               'results\n'
               '    column_type = None\n'
               '\n'
               '    # True value indicates that the expression is written into '
               'the HAVING clause\n'
               '    after_group_by = False\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=252,
          lineno=210,
          tokens=221,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseQueryResult',
          body='\n'
               '    def __init__(self, expression, column_type=None, '
               'doc=None):\n'
               '        column.BaseColumn.__init__(self, doc=doc)\n'
               '\n'
               '        assert self.__class__ is not BaseQueryResult, (\n'
               "            'Only subclasses of BaseQueryResult can be "
               "instantiated!')\n"
               '\n'
               '        # Cloning the column?\n'
               '        if expression is None:\n'
               '            return\n'
               '\n'
               '        # Automatically set the column_type in the case of '
               'simple results\n'
               '        if isinstance(expression, column.BaseColumn):\n'
               "            assert column_type is None, 'Passing column_type "
               "is not required in the case of simple column references!'\n"
               '            column_type = getattr(expression.table_class, '
               'expression.name)\n'
               "            self.full_repr_exclude = ('column_type',)\n"
               '        elif isinstance(expression, '
               'index.FullTextSearchIndex):\n'
               '            column_type = column.Text\n'
               '        else:\n'
               "            assert column_type is not None, 'Passing "
               'column_type is required in the case of calculated '
               "expressions!'\n"
               "            assert column_type.table is None, 'Pass an unbound "
               "column type, not the column of a bound table!'\n"
               '\n'
               '        self.expression = expression\n'
               '        self.column_type = column_type\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=253,
          lineno=234,
          tokens=71,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseQueryResult',
          body='\n'
               '    def clone(self, table):\n'
               '        """ Clone this query result column for a table '
               'instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.table = table\n'
               '        return clone'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=254,
          lineno=247,
          tokens=13,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Result',
          body='class Result(BaseQueryResult):\n    """ Query result\n    """'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=255,
          lineno=252,
          tokens=22,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Condition',
          body='class Condition(BaseQueryResult):\n'
               '    """ Query condition precessed before processing the '
               'aggregates (where)\n'
               '    """'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=256,
          lineno=257,
          tokens=40,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='PostCondition',
          body='class PostCondition(Condition):\n'
               '    """ Query condition precessed after processing the '
               'aggregates (having)\n'
               '    """\n'
               '    # The expression is written into the HAVING clause\n'
               '    after_group_by = True'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=257,
          lineno=4,
          tokens=30,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer import constantsfrom dblayer import constantsfrom '
               'dblayer.model import table, column, indexfrom dblayer.model '
               'import table, column, index'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=258,
          lineno=1,
          tokens=6,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for query definitions\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=259,
          lineno=12,
          tokens=64,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Queries need not be created and cannot be written# Mapping '
               'of alias names to the source Table instances# NOTE: Filled in '
               'by the __new__ class method# NOTE: Filled in by the __new__ '
               'class method# Group by expressions (override in your '
               'subclass)# Ordering expressions (override in your subclass)'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=260,
          lineno=31,
          tokens=6,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Initialize the class only once'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=261,
          lineno=40,
          tokens=28,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body="# Mark the class as initialized# NOTE: It prevent Table's "
               'initialization from being executed, it is intentional# Collect '
               'objects from the class definition'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=262,
          lineno=49,
          tokens=20,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Collects the result column and condition definitions from the '
               'model class\n'
               '        # Sort them by definition order'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=263,
          lineno=81,
          tokens=81,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the table list for the clauses of the SELECT '
               'statement\n'
               '        \n'
               '        Items of the returned list can be either:\n'
               '        \n'
               '        (table_name, alias_name) to start a new cross join '
               'group or\n'
               '        (table_name, alias_name, join_type, id_field_name, '
               'referer_table_name, fk_field_name) to continue one.\n'
               '        \n'
               '        Unaliased tables are not used here.\n'
               '        \n'
               '        '),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=264,
          lineno=94,
          tokens=184,
          depth=8,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Appends tables referenced from the given table to the table '
               'list\n'
               '            # Iterate on all the tables remained in the table '
               'map# Determine the referer table for this table in the JOIN '
               "chain# Is the referer the table we're looking for?# Consider "
               'each table only once# Construct table list item# Database '
               'table name, not the alias in this query# Alias name in this '
               'query for this table# Database table name, not the alias in '
               'this query# Alias name in this query for this table# Type of '
               'this joine, like INNER JOIN or LEFT JOIN# Name of the primary '
               'key column in the joined table# Alias name of the referer '
               '(already joined) table# Name of the referer foreign key column '
               'in the referer (already joined) tableEmpty name(s) in join '
               'definition item: %r# Yield table list item# Find all the '
               'referer tables below this point in the tree'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=265,
          lineno=150,
          tokens=14,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats source code defining the query\n'
               '        class %s(query.Query):'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=266,
          lineno=194,
          tokens=97,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for columns used in a query either as a result or '
               'a condition\n'
               '    \n'
               '    The expression can be a column of a source table or any '
               'expression built\n'
               '    from functions and aggregations in any way acceptable in '
               'an SQL statement.\n'
               '    \n'
               '    # Expression to evaluate to get the value of the given '
               'result column# Column definition for calculated results, '
               'required for expressions,# filled automatically in the case of '
               'simple source column results# True value indicates that the '
               'expression is written into the HAVING clause'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=267,
          lineno=215,
          tokens=71,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseQueryResult can be instantiated!# '
               'Cloning the column?# Automatically set the column_type in the '
               'case of simple resultsPassing column_type is not required in '
               'the case of simple column references!Passing column_type is '
               'required in the case of calculated expressions!Pass an unbound '
               'column type, not the column of a bound table!'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=268,
          lineno=236,
          tokens=32,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Clone this query result column for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        '),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=269,
          lineno=253,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Query condition precessed before processing the aggregates '
               '(where)\n'
               '    '),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=270,
          lineno=258,
          tokens=23,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Query condition precessed after processing the aggregates '
               '(having)\n'
               '    # The expression is written into the HAVING clause'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=271,
          lineno=30,
          tokens=36,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__new__',
          body='def __new__(cls):\n'
               '        # Initialize the class only once\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               '        return super(Query, cls).__new__(cls)'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=272,
          lineno=38,
          tokens=53,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='initialize',
          body='def initialize(cls):\n'
               '\n'
               '        # Mark the class as initialized\n'
               "        # NOTE: It prevent Table's initialization from being "
               'executed, it is intentional\n'
               '        cls._initialized = True\n'
               '\n'
               '        # Collect objects from the class definition\n'
               '        cls._collect_result_condition_list()'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=273,
          lineno=48,
          tokens=176,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='_collect_result_condition_list',
          body='def _collect_result_condition_list(cls):\n'
               '        """ Collects the result column and condition '
               'definitions from the model class\n'
               '        """\n'
               '        cls._table_map = {}\n'
               '        cls._column_list = []\n'
               '        cls._condition_list = []\n'
               '        for name in dir(cls):\n'
               '            value = getattr(cls, name)\n'
               '\n'
               '            if isinstance(value, table.Table):\n'
               '                value._name = name\n'
               '                cls._table_map[name] = value\n'
               '\n'
               '            elif isinstance(value, Result):\n'
               '                value.table_class = cls\n'
               '                value.name = name\n'
               '                cls._column_list.append(value)\n'
               '\n'
               '            elif isinstance(value, Condition):\n'
               '                value.table_class = cls\n'
               '                value.name = name\n'
               '                cls._condition_list.append(value)\n'
               '\n'
               '        # Sort them by definition order\n'
               '        cls._column_list.sort(key=column.BaseColumn.sort_key)\n'
               '        cls._condition_list.sort(key=Condition.sort_key)'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=274,
          lineno=75,
          tokens=18,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body="def __repr__(self):\n        return '<Query: %s>' % self._name"),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=275,
          lineno=80,
          tokens=239,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_table_list',
          body='def get_table_list(self):\n'
               '        """ Returns the table list for the clauses of the '
               'SELECT statement\n'
               '        \n'
               '        Items of the returned list can be either:\n'
               '        \n'
               '        (table_name, alias_name) to start a new cross join '
               'group or\n'
               '        (table_name, alias_name, join_type, id_field_name, '
               'referer_table_name, fk_field_name) to continue one.\n'
               '        \n'
               '        Unaliased tables are not used here.\n'
               '        \n'
               '        """\n'
               '        table_map = self._table_map.copy()\n'
               '\n'
               '        def iterate_joined_tables(referer, visited):\n'
               '            """ Appends tables referenced from the given table '
               'to the table list\n'
               '            """\n'
               '            # Iterate on all the tables remained in the table '
               'map\n'
               '            for alias_name, table in table_map.items():\n'
               '\n'
               '                # Determine the referer table for this table '
               'in the JOIN chain\n'
               '                foreign_key = table._referer\n'
               '                referer_table = foreign_key.table if '
               'foreign_key else None\n'
               '\n'
               "                # Is the referer the table we're looking for?\n"
               '                if referer_table is referer and alias_name not '
               'in visited:\n'
               '\n'
               '                    # Consider each table only once\n'
               '                    visited.add(alias_name)\n'
               '\n'
               '                    # Construct table list item\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=276,
          lineno=93,
          tokens=138,
          depth=5,
          parent_id=None,
          category='function',
          summary=False,
          name='iterate_joined_tables',
          body='def iterate_joined_tables(referer, visited):\n'
               '            """ Appends tables referenced from the given table '
               'to the table list\n'
               '            """\n'
               '            # Iterate on all the tables remained in the table '
               'map\n'
               '            for alias_name, table in table_map.items():\n'
               '\n'
               '                # Determine the referer table for this table '
               'in the JOIN chain\n'
               '                foreign_key = table._referer\n'
               '                referer_table = foreign_key.table if '
               'foreign_key else None\n'
               '\n'
               "                # Is the referer the table we're looking for?\n"
               '                if referer_table is referer and alias_name not '
               'in visited:\n'
               '\n'
               '                    # Consider each table only once\n'
               '                    visited.add(alias_name)\n'
               '\n'
               '                    # Construct table list item\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=277,
          lineno=110,
          tokens=188,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_table_list',
          body='                    if referer is None:\n'
               '                        item = (\n'
               '                            # Database table name, not the '
               'alias in this query\n'
               '                            table._table_name,\n'
               '                            # Alias name in this query for '
               'this table\n'
               '                            alias_name)\n'
               '                    else:\n'
               '                        join_type = constants.LEFT_JOIN if '
               'foreign_key.null else constants.INNER_JOIN\n'
               '                        item = (\n'
               '                            # Database table name, not the '
               'alias in this query\n'
               '                            table._table_name,\n'
               '                            # Alias name in this query for '
               'this table\n'
               '                            alias_name,\n'
               '                            # Type of this joine, like INNER '
               'JOIN or LEFT JOIN\n'
               '                            join_type,\n'
               '                            # Name of the primary key column '
               'in the joined table\n'
               '                            table._primary_key.name,\n'
               '                            # Alias name of the referer '
               '(already joined) table\n'
               '                            referer_table._name,\n'
               '                            # Name of the referer foreign key '
               'column in the referer (already joined) table\n'
               '                            foreign_key.name)\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=278,
          lineno=110,
          tokens=188,
          depth=5,
          parent_id=None,
          category='function',
          summary=False,
          name='iterate_joined_tables',
          body='                    if referer is None:\n'
               '                        item = (\n'
               '                            # Database table name, not the '
               'alias in this query\n'
               '                            table._table_name,\n'
               '                            # Alias name in this query for '
               'this table\n'
               '                            alias_name)\n'
               '                    else:\n'
               '                        join_type = constants.LEFT_JOIN if '
               'foreign_key.null else constants.INNER_JOIN\n'
               '                        item = (\n'
               '                            # Database table name, not the '
               'alias in this query\n'
               '                            table._table_name,\n'
               '                            # Alias name in this query for '
               'this table\n'
               '                            alias_name,\n'
               '                            # Type of this joine, like INNER '
               'JOIN or LEFT JOIN\n'
               '                            join_type,\n'
               '                            # Name of the primary key column '
               'in the joined table\n'
               '                            table._primary_key.name,\n'
               '                            # Alias name of the referer '
               '(already joined) table\n'
               '                            referer_table._name,\n'
               '                            # Name of the referer foreign key '
               'column in the referer (already joined) table\n'
               '                            foreign_key.name)\n'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=279,
          lineno=131,
          tokens=114,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_table_list',
          body='\n'
               '                    if constants.DEBUG:\n'
               '                        assert not sum(1 for x in item if not '
               "x), 'Empty name(s) in join definition item: %r' % (item,)\n"
               '\n'
               '                    # Yield table list item\n'
               '                    yield item\n'
               '\n'
               '                    # Find all the referer tables below this '
               'point in the tree\n'
               '                    for item in iterate_joined_tables(table, '
               'visited):\n'
               '                        yield item\n'
               '\n'
               '        visited = set()\n'
               '        table_list = list(iterate_joined_tables(None, '
               'visited))\n'
               '        assert len(visited) == len(table_map)\n'
               '\n'
               '        return table_list'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=280,
          lineno=131,
          tokens=79,
          depth=5,
          parent_id=None,
          category='function',
          summary=False,
          name='iterate_joined_tables',
          body='\n'
               '                    if constants.DEBUG:\n'
               '                        assert not sum(1 for x in item if not '
               "x), 'Empty name(s) in join definition item: %r' % (item,)\n"
               '\n'
               '                    # Yield table list item\n'
               '                    yield item\n'
               '\n'
               '                    # Find all the referer tables below this '
               'point in the tree\n'
               '                    for item in iterate_joined_tables(table, '
               'visited):\n'
               '                        yield item'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=281,
          lineno=149,
          tokens=187,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='pretty_format_class',
          body='def pretty_format_class(cls):\n'
               '        """ Formats source code defining the query\n'
               '        """\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               "        line_list = ['class %s(query.Query):' % cls.__name__]\n"
               '        append_line = line_list.append\n'
               '\n'
               '        if cls.__doc__:\n'
               "            if '\\n' in cls.__doc__:\n"
               '                append_line(\'    """%s"""\' % cls.__doc__)\n'
               '            else:\n'
               '                append_line(\'    """ %s """\' % '
               'cls.__doc__.strip())\n'
               '        else:\n'
               "            append_line('')\n"
               '\n'
               '        for alias, table in sorted(cls._table_map.items()):\n'
               "            append_line('    %s = %s()' % (alias, "
               'table.__class__.__name__))\n'
               "        append_line('')\n"
               '\n'
               '        for obj in cls._column_list:\n'
               "            append_line('    %s = %s' % (obj.name, "
               'obj.full_repr()))\n'
               '\n'
               "        append_line('')\n"),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=282,
          lineno=174,
          tokens=139,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='pretty_format_class',
          body='\n'
               '        for obj in cls._condition_list:\n'
               "            append_line('    %s = %s' % (obj.name, "
               'obj.full_repr()))\n'
               '\n'
               "        append_line('')\n"
               '\n'
               '        if cls._group_by:\n'
               "            append_line('    _group_by = %r' % "
               '(cls._group_by,))\n'
               '\n'
               '        if cls._order_by:\n'
               "            append_line('    _order_by = %r' % "
               '(cls._order_by,))\n'
               '\n'
               '        for i in range(len(line_list) - 1, 1, -1):\n'
               '            if not line_list[i] and not line_list[i - 1]:\n'
               '                del line_list[i]\n'
               '\n'
               "        return '\\n'.join(line_list)"),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=283,
          lineno=211,
          tokens=218,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, expression, column_type=None, doc=None):\n'
               '        column.BaseColumn.__init__(self, doc=doc)\n'
               '\n'
               '        assert self.__class__ is not BaseQueryResult, (\n'
               "            'Only subclasses of BaseQueryResult can be "
               "instantiated!')\n"
               '\n'
               '        # Cloning the column?\n'
               '        if expression is None:\n'
               '            return\n'
               '\n'
               '        # Automatically set the column_type in the case of '
               'simple results\n'
               '        if isinstance(expression, column.BaseColumn):\n'
               "            assert column_type is None, 'Passing column_type "
               "is not required in the case of simple column references!'\n"
               '            column_type = getattr(expression.table_class, '
               'expression.name)\n'
               "            self.full_repr_exclude = ('column_type',)\n"
               '        elif isinstance(expression, '
               'index.FullTextSearchIndex):\n'
               '            column_type = column.Text\n'
               '        else:\n'
               "            assert column_type is not None, 'Passing "
               'column_type is required in the case of calculated '
               "expressions!'\n"
               "            assert column_type.table is None, 'Pass an unbound "
               "column type, not the column of a bound table!'\n"
               '\n'
               '        self.expression = expression\n'
               '        self.column_type = column_type'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=284,
          lineno=235,
          tokens=69,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='clone',
          body='def clone(self, table):\n'
               '        """ Clone this query result column for a table '
               'instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.table = table\n'
               '        return clone'),
 Fragment(document_cs='61573141ab662b59aaaabbd99f0dd061c814696a1d9e4666eab1f1efb9e7d385',
          id=285,
          lineno=1,
          tokens=154,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: BaseQueryResult Condition PostCondition Query '
               'Result\n'
               '  Methods: __init__ __new__ __repr__ '
               '_collect_result_condition_list clone get_table_list initialize '
               'iterate_joined_tables pretty_format_class\n'
               '  Variables and usages: BaseColumn DEBUG FullTextSearchIndex '
               'INNER_JOIN LEFT_JOIN Table Text _column_list _condition_list '
               '_creatable _group_by _initialized _name _order_by _primary_key '
               '_referer _table_map _table_name _writable after_group_by alias '
               'alias_name append append_line classmethod column column_type '
               'constants copy dblayer expression foreign_key full_repr '
               'full_repr_exclude getattr index item items join join_type '
               'line_list model name null range referer referer_table sort '
               'sort_key sorted strip table table_class table_list table_map '
               'update value visited\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=286,
          lineno=11,
          tokens=226,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='class DatabaseAbstraction:\n'
               '    """ Base class for generated database abstraction layers\n'
               '    """\n'
               '\n'
               '    # SQL server specific backend module implementing the '
               'formatting of SQL statements\n'
               '    _format = None\n'
               '\n'
               '    # SQL statement for the savepoint set before each identity '
               'insert statement\n'
               "    _SQL_IDENTITY_INSERT_SAVEPOINT = ''\n"
               '\n'
               '    # SQL statement to release a savepoint after a successful '
               'identity insert\n'
               "    _SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT = ''\n"
               '\n'
               '    # SQL statement for rolling back to the savepoint after a '
               'failing identity insert statement\n'
               "    _SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT = ''\n"
               '\n'
               '    # Database connection\n'
               '    connection = None\n'
               '\n'
               '    ### Connecting and disconnecting\n'
               '\n'
               '    def connect(self, dsn):\n'
               '        """ Connects to the database\n'
               '        """\n'
               "        assert self.connection is None, 'Already connected.'\n"
               '        self._connect(dsn)\n'
               '        assert self.connection is not None\n'
               '        self.named_cursor_counter = itertools.count()\n'
               '\n'
               '    def _connect(self, dsn):\n'
               '        """ Actually connects to the database\n'
               '        \n'
               '        Sets self.connection to a DBAPI2 compatible connection '
               'object.\n'
               '        \n'
               '        """\n'
               '        raise NotImplementedError()\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=287,
          lineno=47,
          tokens=231,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def close(self):\n'
               '        """ Closes the database connection if any\n'
               '        """\n'
               '        if self.connection is None:\n'
               '            return\n'
               '        self.connection.close()\n'
               '        self.connection = None\n'
               '        self.named_cursor_counter = None\n'
               '\n'
               '    def __del__(self):\n'
               '        """ Try to close the connection when the object is '
               'deallocated, but silence all known errors\n'
               '        """\n'
               '        try:\n'
               '            self.close()\n'
               '        except self.Error:\n'
               '            pass\n'
               '\n'
               '    @property\n'
               '    def connected(self):\n'
               '        return self.connection is not None\n'
               '\n'
               '    ### Database session context\n'
               '\n'
               '    @contextlib.contextmanager\n'
               '    def session(self, dsn):\n'
               '        self.connect(dsn)\n'
               '        try:\n'
               '            yield\n'
               '        finally:\n'
               '            self.close()\n'
               '\n'
               '    ### Transaction setup and helpers\n'
               '\n'
               '    def enable_transactions(self, isolation_level=1):\n'
               '        """ Enables database transactions and sets the '
               'isolation level\n'
               '        """\n'
               '        self.connection.set_isolation_level(isolation_level)\n'
               '        self.connection.rollback()\n'
               '\n'
               '    def disable_transactions(self):\n'
               '        """ Disables transactions, switches back to auto '
               'commit mode\n'
               '        """\n'
               '        self.connection.rollback()\n'
               '        self.connection.set_isolation_level(0)\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=288,
          lineno=92,
          tokens=109,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def commit(self):\n'
               '        """ Commits the current transaction\n'
               '        """\n'
               '        self.connection.commit()\n'
               '\n'
               '    def rollback(self):\n'
               '        """ Rolls back the current transaction\n'
               '        """\n'
               '        self.connection.rollback()\n'
               '\n'
               '    ### Transaction context\n'
               '\n'
               '    @contextlib.contextmanager\n'
               '    def transaction(self):\n'
               '        """ Context manager to encapsualte a transaction\n'
               '        """\n'
               '        try:\n'
               '            yield\n'
               '        except Exception:\n'
               '            self.connection.rollback()\n'
               '            raise\n'
               '        else:\n'
               '            self.connection.commit()\n'
               '\n'
               '    ### Cursor context\n'
               '\n'
               '    @contextlib.contextmanager\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=289,
          lineno=120,
          tokens=166,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='    def cursor(self, named=False):\n'
               '        """ Context manager for a single database cursor\n'
               '        """\n'
               '        # See this forum thread on why we need to use named '
               'cursors as well as unnamed ones:\n'
               '        # '
               'http://www.velocityreviews.com/forums/t649192-psycopg2-and-large-queries.html\n'
               '        if named:\n'
               "            cursor_name = 'cursor_%d' % "
               'next(self.named_cursor_counter)\n'
               '            cursor = self.connection.cursor(cursor_name)\n'
               '        else:\n'
               '            cursor = self.connection.cursor()\n'
               '\n'
               '        try:\n'
               '            yield cursor\n'
               '        finally:\n'
               '            try:\n'
               '                cursor.close()\n'
               '            except self.Error:\n'
               '                # Closing a cursor in a broken transaction '
               'state can cause an extra exception here.\n'
               '                # It can be safely suppressed, since we '
               'already have an error condition anyway.\n'
               '                pass\n'
               '\n'
               '    ### Execute helpers\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=290,
          lineno=142,
          tokens=202,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def execute(self, cursor, sql, parameter_tuple=()):\n'
               '        """ Executes a single SQL statement on the given '
               'cursor \n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statement.\n'
               '        \n'
               '        """\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: execute(%r, %r)', sql, "
               'parameter_tuple)\n'
               '\n'
               '        cursor.execute(sql, parameter_tuple)\n'
               '\n'
               '    def executemany(self, cursor, sql, parameter_tuple_list):\n'
               '        """ Executes a single SQL statement on the given '
               'cursor for each parameter_tuple\n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statement.\n'
               '        \n'
               '        """\n'
               '        if not parameter_tuple_list:\n'
               '            return\n'
               '\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: executemany(%r, %r)', "
               'sql, parameter_tuple_list)\n'
               '\n'
               '        cursor.executemany(sql, parameter_tuple_list)\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=291,
          lineno=169,
          tokens=234,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def execute_statement_list(self, cursor, statement_list, '
               'ignore_errors=False):\n'
               '        """ Executes a list of SQL statements on the given '
               'cursor \n'
               '        \n'
               '        statement_list = [(sql, parameter_tuple)*]\n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statements.\n'
               '        \n'
               '        """\n'
               '        if not statement_list:\n'
               '            return\n'
               '\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: "
               "execute_statement_list(%r)', statement_list)\n"
               '\n'
               '        if ignore_errors:\n'
               '            for sql, parameter_tuple in statement_list:\n'
               '                try:\n'
               '                    '
               "cursor.execute(self._format.format_savepoint('execute_statement_list_ignoring_errors'))\n"
               '                    cursor.execute(sql, parameter_tuple)\n'
               '                except self.ProgrammingError as reason:\n'
               "                    if str(reason).startswith('syntax "
               "error'):\n"
               '                        raise\n'
               '                    '
               "cursor.execute(self._format.format_rollback_to_savepoint('execute_statement_list_ignoring_errors'))\n"
               '                else:\n'
               '                    '
               "cursor.execute(self._format.format_release_savepoint('execute_statement_list_ignoring_errors'))\n"
               '        else:\n'
               '            for sql, parameter_tuple in statement_list:\n'
               '                cursor.execute(sql, parameter_tuple)\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=292,
          lineno=199,
          tokens=134,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def execute_and_fetch_one(self, cursor, sql, '
               'parameter_tuple=()):\n'
               '        """ Executes an SQL query on the given cursor and '
               'returns the first row of result set if any\n'
               '        \n'
               '        Returns the first row of the result set or None in the '
               'case of an empty result set.\n'
               '        \n'
               '        """\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: execute_and_fetch_one(%r, "
               "%r)', sql, parameter_tuple)\n"
               '\n'
               '        cursor.execute(sql, parameter_tuple)\n'
               '        row = cursor.fetchone()\n'
               '\n'
               '        if constants.LOG_SQL_RESULT_ROWS:\n'
               "            util.log('Returning SQL result row: %r' % (row,))\n"
               '\n'
               '        return row\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=293,
          lineno=216,
          tokens=147,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def execute_and_fetch_iter(self, cursor, sql, '
               'parameter_tuple=()):\n'
               '        """ Executes an SQL query on the given cursor and '
               'yields each row of result set\n'
               '        """\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: "
               "execute_and_fetch_iter(%r, %r)', sql, parameter_tuple)\n"
               '\n'
               '        cursor.arraysize = constants.CURSOR_ARRAYSIZE\n'
               '        cursor.execute(sql, parameter_tuple)\n'
               '\n'
               '        while 1:\n'
               '            row_list = cursor.fetchmany()\n'
               '\n'
               '            if not row_list:\n'
               '                break\n'
               '\n'
               '            for row in row_list:\n'
               '\n'
               '                if constants.LOG_SQL_RESULT_ROWS:\n'
               "                    util.log('Yielding SQL result row: %r' % "
               '(row,))\n'
               '\n'
               '                yield row\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=294,
          lineno=238,
          tokens=200,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def execute_and_fetch_dict_iter(self, cursor, sql, '
               'parameter_tuple=()):\n'
               '        """ Executes an SQL query on the given cursor and '
               'yields each row of result set as a dict\n'
               '        """\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: "
               "execute_and_fetch_dict_iter(%r, %r)', sql, parameter_tuple)\n"
               '\n'
               '        cursor.arraysize = constants.CURSOR_ARRAYSIZE\n'
               '        cursor.execute(sql, parameter_tuple)\n'
               '\n'
               '        field_name_list = None\n'
               '\n'
               '        while 1:\n'
               '            row_list = cursor.fetchmany()\n'
               '\n'
               '            if not row_list:\n'
               '                break\n'
               '\n'
               '            if field_name_list is None:\n'
               '                field_name_list = [column.name for column in '
               'cursor.description]\n'
               '\n'
               '            for row in row_list:\n'
               '\n'
               '                row = dict(zip(field_name_list, row))\n'
               '\n'
               '                if constants.LOG_SQL_RESULT_ROWS:\n'
               "                    util.log('Yielding SQL result row as dict: "
               "%r' % (row,))\n"
               '\n'
               '                yield row\n'
               '\n'
               '    ### Select query helpers\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=295,
          lineno=269,
          tokens=132,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def get_record(self, record_class, clauses, '
               'parameter_tuple=()):\n'
               '        """ Retrieves a single record form the database or '
               'None if no record found\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '            assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               '            assert isinstance(parameter_tuple, (tuple, list))\n'
               '\n'
               '        sql = self._format.format_select(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            row = self.execute_and_fetch_one(cursor, sql, '
               'parameter_tuple)\n'
               '\n'
               '        if row is None:\n'
               '            return None\n'
               '\n'
               '        return record_class(*row)\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=296,
          lineno=287,
          tokens=244,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def get_record_list(self, record_class, clauses, '
               'parameter_tuple=()):\n'
               '        """ Retrieves a list of records form the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '            assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               '            assert isinstance(parameter_tuple, (tuple, list))\n'
               '\n'
               '        sql = self._format.format_select(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            return [\n'
               '                record_class(*row)\n'
               '                for row in self.execute_and_fetch_iter(cursor, '
               'sql, parameter_tuple)]\n'
               '\n'
               '    def get_record_iter(self, record_class, clauses, '
               'parameter_tuple=()):\n'
               '        """ Yields records retrieved form the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '            assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               '            assert isinstance(parameter_tuple, (tuple, list))\n'
               '\n'
               '        sql = self._format.format_select(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            for row in self.execute_and_fetch_iter(cursor, '
               'sql, parameter_tuple):\n'
               '                yield record_class(*row)\n'
               '\n'
               '    ### Insert query helpers\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=297,
          lineno=318,
          tokens=114,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def is_primary_key_conflict(self, reason):\n'
               '        """ Returns True if the exception object might be due '
               'to the attempted\n'
               '        insertion of a conflicting primary key value. It can '
               'give false positives\n'
               '        without problems, those only degrade performance in '
               'rare exception cases\n'
               '        only.\n'
               '        """\n'
               "        return '__pk' in str(reason)\n"
               '\n'
               '    def get_last_value_of_last_sequence_used(self, cursor):\n'
               '        """ Returns the last value returned by the last '
               'sequence used\n'
               '        """\n'
               "        return self.execute_and_fetch_one(cursor, 'SELECT "
               "lastval();')[0]\n"),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=298,
          lineno=331,
          tokens=233,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def add_record(self, record_class, record, generate_id, '
               'serial):\n'
               '        """ Inserts new record into the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               "            assert isinstance(record, record_class), 'Got "
               "record of unexpected type: %r' % (record,)\n"
               '\n'
               '        record.finalize()\n'
               '\n'
               '        table_name = record_class._table_name\n'
               '        truncate_id = 1 if serial else 0\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(table_name,),\n'
               '            '
               'field_list=record_class._column_name_list[truncate_id:])\n'
               '        sql = self._format.format_insert(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '\n'
               '            # We might need to generate another ID, so the '
               'retry loop\n'
               '            for retry in range(1, '
               'constants.MAX_INSERT_RETRY_COUNT):\n'
               '\n'
               '                try:\n'
               '                    if not serial:\n'
               '                        if generate_id:\n'
               '                            record.id = util.get_random_id()\n'
               '                        elif constants.DEBUG:\n'
               "                            assert record.id, 'No record ID "
               "specified with ID generation disabled: %r' % record\n"
               '\n'
               '                    parameter_tuple = '
               'record.tuple[truncate_id:]\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=299,
          lineno=361,
          tokens=204,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '                    if self._SQL_IDENTITY_INSERT_SAVEPOINT:\n'
               '                        self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_SAVEPOINT)\n'
               '\n'
               '                    self.execute(cursor, sql, '
               'parameter_tuple)\n'
               '\n'
               '                except self.IntegrityError as reason:\n'
               '\n'
               '                    if not '
               'self.is_primary_key_conflict(reason):\n'
               '                        raise\n'
               '\n'
               '                    if '
               'self._SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT:\n'
               '                        self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT)\n'
               '\n'
               '                else:\n'
               '                    if '
               'self._SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT:\n'
               '                        self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT)\n'
               '\n'
               '                    # Fill in id field of record object\n'
               '                    if serial:\n'
               '                        record.id = '
               'self.get_last_value_of_last_sequence_used(cursor)\n'
               '\n'
               '                    return\n'
               '\n'
               '            # Reproduce the error, it will re-raise the '
               'exception\n'
               '            self.execute(cursor, sql, parameter_tuple)\n'
               '\n'
               '            # Fill in id field of record object\n'
               '            if serial:\n'
               '                record.id = '
               'self.get_last_value_of_last_sequence_used(cursor)\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=300,
          lineno=391,
          tokens=232,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def add_record_list(self, record_class, record_list, '
               'generate_id, serial):\n'
               '        """ Inserts a list of records of the same type into '
               'the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '\n'
               '        if not record_list:\n'
               '            return\n'
               '\n'
               '        if len(record_list) == 1:\n'
               '            self.add_record(record_class, record_list[0], '
               'generate_id, serial)\n'
               '            return\n'
               '\n'
               '        for record in record_list:\n'
               '            if constants.DEBUG:\n'
               "                assert isinstance(record, record_class), 'Got "
               "record of unexpected type: %r' % (record,)\n"
               '            record.finalize()\n'
               '\n'
               '        table_name = record_class._table_name\n'
               '        truncate_id = 1 if serial else 0\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(table_name,),\n'
               '            '
               'field_list=record_class._column_name_list[truncate_id:])\n'
               '        sql = self._format.format_insert(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '\n'
               '            # We need to catch conflicting ID values (rare, '
               'but possible)\n'
               '            try:\n'
               '                if not serial:\n'
               '                    if generate_id:\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=301,
          lineno=423,
          tokens=211,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='                        for record in record_list:\n'
               '                            record.id = util.get_random_id()\n'
               '                    elif constants.DEBUG:\n'
               '                        for record in record_list:\n'
               "                            assert record.id, 'No record ID "
               "specified with ID generation disabled: %r' % record\n"
               '\n'
               '                parameter_tuple_list = '
               '[record.tuple[truncate_id:] for record in record_list]\n'
               '\n'
               '                if self._SQL_IDENTITY_INSERT_SAVEPOINT:\n'
               '                    self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_SAVEPOINT)\n'
               '\n'
               '                self.executemany(cursor, sql, '
               'parameter_tuple_list)\n'
               '\n'
               '            except self.IntegrityError:\n'
               '\n'
               '                if '
               'self._SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT:\n'
               '                    self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT)\n'
               '\n'
               '                # Split the record list into two parts and try '
               'again\n'
               '                split_index = len(record_list) // 2\n'
               '                self.add_record_list(record_class, '
               'record_list[:split_index], generate_id, serial)\n'
               '                self.add_record_list(record_class, '
               'record_list[split_index:], generate_id, serial)\n'
               '\n'
               '            else:\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=302,
          lineno=447,
          tokens=99,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '                if '
               'self._SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT:\n'
               '                    self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT)\n'
               '\n'
               '            # Fill in id field of each record object\n'
               '            if serial:\n'
               '                last_id = '
               'self.get_last_value_of_last_sequence_used(cursor)\n'
               '                first_id = last_id - len(record_list) + 1\n'
               '                for record_index, record in '
               'enumerate(record_list):\n'
               '                    record.id = first_id + record_index\n'
               '\n'
               '    ### Update query helpers\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=303,
          lineno=459,
          tokens=176,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def update_record(self, record_class, record):\n'
               '        """ Updates a record already in the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               "            assert isinstance(record, record_class), 'Got "
               "record of unexpected type: %r' % (record,)\n"
               "            assert record.id is not None, 'Cannot update "
               "record which has not been added to the database!'\n"
               '\n'
               '        record.finalize()\n'
               '\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(record_class._table_name,),\n'
               '            field_list=record_class._column_name_list[1:],\n'
               "            where='id = ?')\n"
               '        sql = self._format.format_update(clauses)\n'
               '\n'
               '        parameter_tuple = record.tuple[1:] + (record.id,)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute(cursor, sql, parameter_tuple)\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=304,
          lineno=480,
          tokens=244,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def update_record_list(self, record_class, record_list):\n'
               '        """ Updates a list of records already in the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '\n'
               '        if not record_list:\n'
               '            return\n'
               '\n'
               '        if len(record_list) == 1:\n'
               '            self.update_record(record_class, record_list[0])\n'
               '            return\n'
               '\n'
               '        for record in record_list:\n'
               '            if constants.DEBUG:\n'
               "                assert isinstance(record, record_class), 'Got "
               "record of unexpected type: %r' % (record,)\n"
               "                assert record.id is not None, 'Cannot update "
               "record which has not been added to the database!'\n"
               '            record.finalize()\n'
               '\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(record_class._table_name,),\n'
               '            field_list=record_class._column_name_list[1:],\n'
               "            where='id = ?')\n"
               '        sql = self._format.format_update(clauses)\n'
               '\n'
               '        parameter_tuple_list = [\n'
               '            record.tuple[1:] + (record.id,)\n'
               '            for record in record_list]\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            self.executemany(cursor, sql, '
               'parameter_tuple_list)\n'
               '\n'
               '    ### Delete query helpers\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=305,
          lineno=514,
          tokens=122,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def delete_record(self, record_class, record_or_id):\n'
               '        """ Deletes a record from the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(record_class._table_name,),\n'
               "            where='id = ?')\n"
               '        sql = self._format.format_delete(clauses)\n'
               '\n'
               '        parameter_tuple = (record_or_id.id if '
               'isinstance(record_or_id, record_class) else record_or_id,)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute(cursor, sql, parameter_tuple)\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=306,
          lineno=530,
          tokens=215,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def delete_record_list(self, record_class, '
               'record_or_id_list):\n'
               '        """ Deletes a list of records from the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(record_class._table_name,),\n'
               "            where='id = ?')\n"
               '        sql = self._format.format_delete(clauses)\n'
               '\n'
               '        parameter_tuple_list = [\n'
               '            (record_or_id.id if isinstance(record_or_id, '
               'record_class) else record_or_id,)\n'
               '            for record_or_id in record_or_id_list]\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            self.executemany(cursor, sql, '
               'parameter_tuple_list)\n'
               '\n'
               '    ### Create helpers\n'
               '\n'
               '    def create_language(self, language, ignore_errors=True):\n'
               '        """ Creates a procedural language\n'
               '        """\n'
               '        with self.cursor() as cursor:\n'
               "            statement_list = [('CREATE LANGUAGE %s' % "
               'self._format.quote_name(language), ())]\n'
               '            self.execute_statement_list(cursor, '
               'statement_list, ignore_errors)\n'
               '\n'
               '    ### Debug helpers\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=307,
          lineno=559,
          tokens=90,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='\n'
               '    def log_analysis(self, cursor, sql, parameter_tuple):\n'
               '        """ Logs analysis of an SQL statement\n'
               '        """\n'
               "        cursor.execute('EXPLAIN ' + sql, parameter_tuple)\n"
               '        util.log(\n'
               "            'Analyzing query:\\n'\n"
               "            '%s\\n'\n"
               "            'With parameters: %r\\n'\n"
               "            '%s',\n"
               '            sql,\n'
               '            parameter_tuple,\n'
               "            '\\n'.join(row[0] for row in cursor.fetchall()))"),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=308,
          lineno=4,
          tokens=22,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import contextlibimport itertoolsimport dblayerfrom dblayer '
               'import constants, utilfrom dblayer import constants, util'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=309,
          lineno=1,
          tokens=8,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for generated database abstraction layers\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=310,
          lineno=12,
          tokens=71,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for generated database abstraction layers\n'
               '    # SQL server specific backend module implementing the '
               'formatting of SQL statements# SQL statement for the savepoint '
               'set before each identity insert statement# SQL statement to '
               'release a savepoint after a successful identity insert# SQL '
               'statement for rolling back to the savepoint after a failing '
               'identity insert statement# Database connection### Connecting '
               'and disconnecting'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=311,
          lineno=33,
          tokens=7,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Connects to the database\n        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=312,
          lineno=41,
          tokens=21,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Actually connects to the database\n'
               '        \n'
               '        Sets self.connection to a DBAPI2 compatible connection '
               'object.\n'
               '        \n'
               '        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=313,
          lineno=49,
          tokens=9,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Closes the database connection if any\n        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=314,
          lineno=58,
          tokens=19,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Try to close the connection when the object is deallocated, '
               'but silence all known errors\n'
               '        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=315,
          lineno=69,
          tokens=4,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='### Database session context'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=316,
          lineno=79,
          tokens=5,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='### Transaction setup and helpers'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=317,
          lineno=82,
          tokens=10,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Enables database transactions and sets the isolation level\n'
               '        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=318,
          lineno=88,
          tokens=12,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Disables transactions, switches back to auto commit mode\n'
               '        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=319,
          lineno=94,
          tokens=7,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Commits the current transaction\n        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=320,
          lineno=99,
          tokens=10,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Rolls back the current transaction\n'
               '        ### Transaction context'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=321,
          lineno=107,
          tokens=10,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Context manager to encapsualte a transaction\n        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=322,
          lineno=121,
          tokens=79,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Context manager for a single database cursor\n'
               '        # See this forum thread on why we need to use named '
               'cursors as well as unnamed ones:# '
               'http://www.velocityreviews.com/forums/t649192-psycopg2-and-large-queries.html# '
               'Closing a cursor in a broken transaction state can cause an '
               'extra exception here.# It can be safely suppressed, since we '
               'already have an error condition anyway.'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=323,
          lineno=144,
          tokens=48,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes a single SQL statement on the given cursor \n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statement.\n'
               '        \n'
               '        SQL statement: execute(%r, %r)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=324,
          lineno=156,
          tokens=54,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes a single SQL statement on the given cursor for each '
               'parameter_tuple\n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statement.\n'
               '        \n'
               '        SQL statement: executemany(%r, %r)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=325,
          lineno=171,
          tokens=83,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes a list of SQL statements on the given cursor \n'
               '        \n'
               '        statement_list = [(sql, parameter_tuple)*]\n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statements.\n'
               '        \n'
               '        SQL statement: '
               'execute_statement_list(%r)execute_statement_list_ignoring_errorsexecute_statement_list_ignoring_errorsexecute_statement_list_ignoring_errors'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=326,
          lineno=201,
          tokens=61,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes an SQL query on the given cursor and returns the '
               'first row of result set if any\n'
               '        \n'
               '        Returns the first row of the result set or None in the '
               'case of an empty result set.\n'
               '        \n'
               '        SQL statement: execute_and_fetch_one(%r, %r)Returning '
               'SQL result row: %r'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=327,
          lineno=218,
          tokens=38,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes an SQL query on the given cursor and yields each row '
               'of result set\n'
               '        SQL statement: execute_and_fetch_iter(%r, %r)Yielding '
               'SQL result row: %r'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=328,
          lineno=240,
          tokens=48,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes an SQL query on the given cursor and yields each row '
               'of result set as a dict\n'
               '        SQL statement: execute_and_fetch_dict_iter(%r, '
               '%r)Yielding SQL result row as dict: %r### Select query helpers'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=329,
          lineno=271,
          tokens=15,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Retrieves a single record form the database or None if no '
               'record found\n'
               '        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=330,
          lineno=289,
          tokens=10,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Retrieves a list of records form the database\n        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=331,
          lineno=304,
          tokens=13,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Yields records retrieved form the database\n'
               '        ### Insert query helpers'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=332,
          lineno=320,
          tokens=45,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns True if the exception object might be due to the '
               'attempted\n'
               '        insertion of a conflicting primary key value. It can '
               'give false positives\n'
               '        without problems, those only degrade performance in '
               'rare exception cases\n'
               '        only.\n'
               '        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=333,
          lineno=328,
          tokens=12,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the last value returned by the last sequence used\n'
               '        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=334,
          lineno=333,
          tokens=69,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Inserts new record into the database\n'
               '        Got record of unexpected type: %r# We might need to '
               'generate another ID, so the retry loopNo record ID specified '
               'with ID generation disabled: %r# Fill in id field of record '
               'object# Reproduce the error, it will re-raise the exception# '
               'Fill in id field of record object'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=335,
          lineno=393,
          tokens=72,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Inserts a list of records of the same type into the database\n'
               '        Got record of unexpected type: %r# We need to catch '
               'conflicting ID values (rare, but possible)No record ID '
               'specified with ID generation disabled: %r# Split the record '
               'list into two parts and try again# Fill in id field of each '
               'record object### Update query helpers'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=336,
          lineno=461,
          tokens=29,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Updates a record already in the database\n'
               '        Got record of unexpected type: %rCannot update record '
               'which has not been added to the database!'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=337,
          lineno=482,
          tokens=35,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Updates a list of records already in the database\n'
               '        Got record of unexpected type: %rCannot update record '
               'which has not been added to the database!### Delete query '
               'helpers'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=338,
          lineno=516,
          tokens=8,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Deletes a record from the database\n        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=339,
          lineno=532,
          tokens=10,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Deletes a list of records from the database\n        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=340,
          lineno=552,
          tokens=6,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates a procedural language\n        '),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=341,
          lineno=561,
          tokens=14,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Logs analysis of an SQL statement\n'
               '        With parameters: %r\\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=342,
          lineno=32,
          tokens=52,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='connect',
          body='def connect(self, dsn):\n'
               '        """ Connects to the database\n'
               '        """\n'
               "        assert self.connection is None, 'Already connected.'\n"
               '        self._connect(dsn)\n'
               '        assert self.connection is not None\n'
               '        self.named_cursor_counter = itertools.count()'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=343,
          lineno=40,
          tokens=36,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='_connect',
          body='def _connect(self, dsn):\n'
               '        """ Actually connects to the database\n'
               '        \n'
               '        Sets self.connection to a DBAPI2 compatible connection '
               'object.\n'
               '        \n'
               '        """\n'
               '        raise NotImplementedError()'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=344,
          lineno=48,
          tokens=44,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='close',
          body='def close(self):\n'
               '        """ Closes the database connection if any\n'
               '        """\n'
               '        if self.connection is None:\n'
               '            return\n'
               '        self.connection.close()\n'
               '        self.connection = None\n'
               '        self.named_cursor_counter = None'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=345,
          lineno=57,
          tokens=42,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__del__',
          body='def __del__(self):\n'
               '        """ Try to close the connection when the object is '
               'deallocated, but silence all known errors\n'
               '        """\n'
               '        try:\n'
               '            self.close()\n'
               '        except self.Error:\n'
               '            pass'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=346,
          lineno=66,
          tokens=11,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='connected',
          body='def connected(self):\n'
               '        return self.connection is not None'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=347,
          lineno=72,
          tokens=26,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='session',
          body='def session(self, dsn):\n'
               '        self.connect(dsn)\n'
               '        try:\n'
               '            yield\n'
               '        finally:\n'
               '            self.close()'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=348,
          lineno=81,
          tokens=39,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='enable_transactions',
          body='def enable_transactions(self, isolation_level=1):\n'
               '        """ Enables database transactions and sets the '
               'isolation level\n'
               '        """\n'
               '        self.connection.set_isolation_level(isolation_level)\n'
               '        self.connection.rollback()'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=349,
          lineno=87,
          tokens=35,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='disable_transactions',
          body='def disable_transactions(self):\n'
               '        """ Disables transactions, switches back to auto '
               'commit mode\n'
               '        """\n'
               '        self.connection.rollback()\n'
               '        self.connection.set_isolation_level(0)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=350,
          lineno=93,
          tokens=19,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='commit',
          body='def commit(self):\n'
               '        """ Commits the current transaction\n'
               '        """\n'
               '        self.connection.commit()'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=351,
          lineno=98,
          tokens=19,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='rollback',
          body='def rollback(self):\n'
               '        """ Rolls back the current transaction\n'
               '        """\n'
               '        self.connection.rollback()'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=352,
          lineno=106,
          tokens=43,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='transaction',
          body='def transaction(self):\n'
               '        """ Context manager to encapsualte a transaction\n'
               '        """\n'
               '        try:\n'
               '            yield\n'
               '        except Exception:\n'
               '            self.connection.rollback()\n'
               '            raise\n'
               '        else:\n'
               '            self.connection.commit()'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=353,
          lineno=120,
          tokens=159,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='cursor',
          body='def cursor(self, named=False):\n'
               '        """ Context manager for a single database cursor\n'
               '        """\n'
               '        # See this forum thread on why we need to use named '
               'cursors as well as unnamed ones:\n'
               '        # '
               'http://www.velocityreviews.com/forums/t649192-psycopg2-and-large-queries.html\n'
               '        if named:\n'
               "            cursor_name = 'cursor_%d' % "
               'next(self.named_cursor_counter)\n'
               '            cursor = self.connection.cursor(cursor_name)\n'
               '        else:\n'
               '            cursor = self.connection.cursor()\n'
               '\n'
               '        try:\n'
               '            yield cursor\n'
               '        finally:\n'
               '            try:\n'
               '                cursor.close()\n'
               '            except self.Error:\n'
               '                # Closing a cursor in a broken transaction '
               'state can cause an extra exception here.\n'
               '                # It can be safely suppressed, since we '
               'already have an error condition anyway.\n'
               '                pass'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=354,
          lineno=143,
          tokens=88,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='execute',
          body='def execute(self, cursor, sql, parameter_tuple=()):\n'
               '        """ Executes a single SQL statement on the given '
               'cursor \n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statement.\n'
               '        \n'
               '        """\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: execute(%r, %r)', sql, "
               'parameter_tuple)\n'
               '\n'
               '        cursor.execute(sql, parameter_tuple)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=355,
          lineno=155,
          tokens=111,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='executemany',
          body='def executemany(self, cursor, sql, parameter_tuple_list):\n'
               '        """ Executes a single SQL statement on the given '
               'cursor for each parameter_tuple\n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statement.\n'
               '        \n'
               '        """\n'
               '        if not parameter_tuple_list:\n'
               '            return\n'
               '\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: executemany(%r, %r)', "
               'sql, parameter_tuple_list)\n'
               '\n'
               '        cursor.executemany(sql, parameter_tuple_list)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=356,
          lineno=170,
          tokens=232,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='execute_statement_list',
          body='def execute_statement_list(self, cursor, statement_list, '
               'ignore_errors=False):\n'
               '        """ Executes a list of SQL statements on the given '
               'cursor \n'
               '        \n'
               '        statement_list = [(sql, parameter_tuple)*]\n'
               '        \n'
               '        NOTE: It is not suitable to retrieve a result set, '
               'since the cursor\n'
               '              is closed right after executing the statements.\n'
               '        \n'
               '        """\n'
               '        if not statement_list:\n'
               '            return\n'
               '\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: "
               "execute_statement_list(%r)', statement_list)\n"
               '\n'
               '        if ignore_errors:\n'
               '            for sql, parameter_tuple in statement_list:\n'
               '                try:\n'
               '                    '
               "cursor.execute(self._format.format_savepoint('execute_statement_list_ignoring_errors'))\n"
               '                    cursor.execute(sql, parameter_tuple)\n'
               '                except self.ProgrammingError as reason:\n'
               "                    if str(reason).startswith('syntax "
               "error'):\n"
               '                        raise\n'
               '                    '
               "cursor.execute(self._format.format_rollback_to_savepoint('execute_statement_list_ignoring_errors'))\n"
               '                else:\n'
               '                    '
               "cursor.execute(self._format.format_release_savepoint('execute_statement_list_ignoring_errors'))\n"
               '        else:\n'
               '            for sql, parameter_tuple in statement_list:\n'
               '                cursor.execute(sql, parameter_tuple)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=357,
          lineno=200,
          tokens=131,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='execute_and_fetch_one',
          body='def execute_and_fetch_one(self, cursor, sql, '
               'parameter_tuple=()):\n'
               '        """ Executes an SQL query on the given cursor and '
               'returns the first row of result set if any\n'
               '        \n'
               '        Returns the first row of the result set or None in the '
               'case of an empty result set.\n'
               '        \n'
               '        """\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: execute_and_fetch_one(%r, "
               "%r)', sql, parameter_tuple)\n"
               '\n'
               '        cursor.execute(sql, parameter_tuple)\n'
               '        row = cursor.fetchone()\n'
               '\n'
               '        if constants.LOG_SQL_RESULT_ROWS:\n'
               "            util.log('Returning SQL result row: %r' % (row,))\n"
               '\n'
               '        return row'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=358,
          lineno=217,
          tokens=144,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='execute_and_fetch_iter',
          body='def execute_and_fetch_iter(self, cursor, sql, '
               'parameter_tuple=()):\n'
               '        """ Executes an SQL query on the given cursor and '
               'yields each row of result set\n'
               '        """\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: "
               "execute_and_fetch_iter(%r, %r)', sql, parameter_tuple)\n"
               '\n'
               '        cursor.arraysize = constants.CURSOR_ARRAYSIZE\n'
               '        cursor.execute(sql, parameter_tuple)\n'
               '\n'
               '        while 1:\n'
               '            row_list = cursor.fetchmany()\n'
               '\n'
               '            if not row_list:\n'
               '                break\n'
               '\n'
               '            for row in row_list:\n'
               '\n'
               '                if constants.LOG_SQL_RESULT_ROWS:\n'
               "                    util.log('Yielding SQL result row: %r' % "
               '(row,))\n'
               '\n'
               '                yield row'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=359,
          lineno=239,
          tokens=191,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='execute_and_fetch_dict_iter',
          body='def execute_and_fetch_dict_iter(self, cursor, sql, '
               'parameter_tuple=()):\n'
               '        """ Executes an SQL query on the given cursor and '
               'yields each row of result set as a dict\n'
               '        """\n'
               '        if constants.LOG_SQL_STATEMENTS:\n'
               "            util.log('SQL statement: "
               "execute_and_fetch_dict_iter(%r, %r)', sql, parameter_tuple)\n"
               '\n'
               '        cursor.arraysize = constants.CURSOR_ARRAYSIZE\n'
               '        cursor.execute(sql, parameter_tuple)\n'
               '\n'
               '        field_name_list = None\n'
               '\n'
               '        while 1:\n'
               '            row_list = cursor.fetchmany()\n'
               '\n'
               '            if not row_list:\n'
               '                break\n'
               '\n'
               '            if field_name_list is None:\n'
               '                field_name_list = [column.name for column in '
               'cursor.description]\n'
               '\n'
               '            for row in row_list:\n'
               '\n'
               '                row = dict(zip(field_name_list, row))\n'
               '\n'
               '                if constants.LOG_SQL_RESULT_ROWS:\n'
               "                    util.log('Yielding SQL result row as dict: "
               "%r' % (row,))\n"
               '\n'
               '                yield row'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=360,
          lineno=270,
          tokens=130,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_record',
          body='def get_record(self, record_class, clauses, '
               'parameter_tuple=()):\n'
               '        """ Retrieves a single record form the database or '
               'None if no record found\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '            assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               '            assert isinstance(parameter_tuple, (tuple, list))\n'
               '\n'
               '        sql = self._format.format_select(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            row = self.execute_and_fetch_one(cursor, sql, '
               'parameter_tuple)\n'
               '\n'
               '        if row is None:\n'
               '            return None\n'
               '\n'
               '        return record_class(*row)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=361,
          lineno=288,
          tokens=119,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_record_list',
          body='def get_record_list(self, record_class, clauses, '
               'parameter_tuple=()):\n'
               '        """ Retrieves a list of records form the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '            assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               '            assert isinstance(parameter_tuple, (tuple, list))\n'
               '\n'
               '        sql = self._format.format_select(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            return [\n'
               '                record_class(*row)\n'
               '                for row in self.execute_and_fetch_iter(cursor, '
               'sql, parameter_tuple)]'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=362,
          lineno=303,
          tokens=116,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_record_iter',
          body='def get_record_iter(self, record_class, clauses, '
               'parameter_tuple=()):\n'
               '        """ Yields records retrieved form the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '            assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               '            assert isinstance(parameter_tuple, (tuple, list))\n'
               '\n'
               '        sql = self._format.format_select(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            for row in self.execute_and_fetch_iter(cursor, '
               'sql, parameter_tuple):\n'
               '                yield record_class(*row)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=363,
          lineno=319,
          tokens=67,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='is_primary_key_conflict',
          body='def is_primary_key_conflict(self, reason):\n'
               '        """ Returns True if the exception object might be due '
               'to the attempted\n'
               '        insertion of a conflicting primary key value. It can '
               'give false positives\n'
               '        without problems, those only degrade performance in '
               'rare exception cases\n'
               '        only.\n'
               '        """\n'
               "        return '__pk' in str(reason)"),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=364,
          lineno=327,
          tokens=44,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_last_value_of_last_sequence_used',
          body='def get_last_value_of_last_sequence_used(self, cursor):\n'
               '        """ Returns the last value returned by the last '
               'sequence used\n'
               '        """\n'
               "        return self.execute_and_fetch_one(cursor, 'SELECT "
               "lastval();')[0]"),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=365,
          lineno=332,
          tokens=231,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='add_record',
          body='def add_record(self, record_class, record, generate_id, '
               'serial):\n'
               '        """ Inserts new record into the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               "            assert isinstance(record, record_class), 'Got "
               "record of unexpected type: %r' % (record,)\n"
               '\n'
               '        record.finalize()\n'
               '\n'
               '        table_name = record_class._table_name\n'
               '        truncate_id = 1 if serial else 0\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(table_name,),\n'
               '            '
               'field_list=record_class._column_name_list[truncate_id:])\n'
               '        sql = self._format.format_insert(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '\n'
               '            # We might need to generate another ID, so the '
               'retry loop\n'
               '            for retry in range(1, '
               'constants.MAX_INSERT_RETRY_COUNT):\n'
               '\n'
               '                try:\n'
               '                    if not serial:\n'
               '                        if generate_id:\n'
               '                            record.id = util.get_random_id()\n'
               '                        elif constants.DEBUG:\n'
               "                            assert record.id, 'No record ID "
               "specified with ID generation disabled: %r' % record\n"
               '\n'
               '                    parameter_tuple = '
               'record.tuple[truncate_id:]\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=366,
          lineno=361,
          tokens=204,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='add_record',
          body='\n'
               '                    if self._SQL_IDENTITY_INSERT_SAVEPOINT:\n'
               '                        self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_SAVEPOINT)\n'
               '\n'
               '                    self.execute(cursor, sql, '
               'parameter_tuple)\n'
               '\n'
               '                except self.IntegrityError as reason:\n'
               '\n'
               '                    if not '
               'self.is_primary_key_conflict(reason):\n'
               '                        raise\n'
               '\n'
               '                    if '
               'self._SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT:\n'
               '                        self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT)\n'
               '\n'
               '                else:\n'
               '                    if '
               'self._SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT:\n'
               '                        self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT)\n'
               '\n'
               '                    # Fill in id field of record object\n'
               '                    if serial:\n'
               '                        record.id = '
               'self.get_last_value_of_last_sequence_used(cursor)\n'
               '\n'
               '                    return\n'
               '\n'
               '            # Reproduce the error, it will re-raise the '
               'exception\n'
               '            self.execute(cursor, sql, parameter_tuple)\n'
               '\n'
               '            # Fill in id field of record object\n'
               '            if serial:\n'
               '                record.id = '
               'self.get_last_value_of_last_sequence_used(cursor)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=367,
          lineno=392,
          tokens=230,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='add_record_list',
          body='def add_record_list(self, record_class, record_list, '
               'generate_id, serial):\n'
               '        """ Inserts a list of records of the same type into '
               'the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '\n'
               '        if not record_list:\n'
               '            return\n'
               '\n'
               '        if len(record_list) == 1:\n'
               '            self.add_record(record_class, record_list[0], '
               'generate_id, serial)\n'
               '            return\n'
               '\n'
               '        for record in record_list:\n'
               '            if constants.DEBUG:\n'
               "                assert isinstance(record, record_class), 'Got "
               "record of unexpected type: %r' % (record,)\n"
               '            record.finalize()\n'
               '\n'
               '        table_name = record_class._table_name\n'
               '        truncate_id = 1 if serial else 0\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(table_name,),\n'
               '            '
               'field_list=record_class._column_name_list[truncate_id:])\n'
               '        sql = self._format.format_insert(clauses)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '\n'
               '            # We need to catch conflicting ID values (rare, '
               'but possible)\n'
               '            try:\n'
               '                if not serial:\n'
               '                    if generate_id:\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=368,
          lineno=423,
          tokens=211,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='add_record_list',
          body='                        for record in record_list:\n'
               '                            record.id = util.get_random_id()\n'
               '                    elif constants.DEBUG:\n'
               '                        for record in record_list:\n'
               "                            assert record.id, 'No record ID "
               "specified with ID generation disabled: %r' % record\n"
               '\n'
               '                parameter_tuple_list = '
               '[record.tuple[truncate_id:] for record in record_list]\n'
               '\n'
               '                if self._SQL_IDENTITY_INSERT_SAVEPOINT:\n'
               '                    self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_SAVEPOINT)\n'
               '\n'
               '                self.executemany(cursor, sql, '
               'parameter_tuple_list)\n'
               '\n'
               '            except self.IntegrityError:\n'
               '\n'
               '                if '
               'self._SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT:\n'
               '                    self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT)\n'
               '\n'
               '                # Split the record list into two parts and try '
               'again\n'
               '                split_index = len(record_list) // 2\n'
               '                self.add_record_list(record_class, '
               'record_list[:split_index], generate_id, serial)\n'
               '                self.add_record_list(record_class, '
               'record_list[split_index:], generate_id, serial)\n'
               '\n'
               '            else:\n'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=369,
          lineno=447,
          tokens=92,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='add_record_list',
          body='\n'
               '                if '
               'self._SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT:\n'
               '                    self.execute(cursor, '
               'self._SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT)\n'
               '\n'
               '            # Fill in id field of each record object\n'
               '            if serial:\n'
               '                last_id = '
               'self.get_last_value_of_last_sequence_used(cursor)\n'
               '                first_id = last_id - len(record_list) + 1\n'
               '                for record_index, record in '
               'enumerate(record_list):\n'
               '                    record.id = first_id + record_index'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=370,
          lineno=460,
          tokens=174,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='update_record',
          body='def update_record(self, record_class, record):\n'
               '        """ Updates a record already in the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               "            assert isinstance(record, record_class), 'Got "
               "record of unexpected type: %r' % (record,)\n"
               "            assert record.id is not None, 'Cannot update "
               "record which has not been added to the database!'\n"
               '\n'
               '        record.finalize()\n'
               '\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(record_class._table_name,),\n'
               '            field_list=record_class._column_name_list[1:],\n'
               "            where='id = ?')\n"
               '        sql = self._format.format_update(clauses)\n'
               '\n'
               '        parameter_tuple = record.tuple[1:] + (record.id,)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute(cursor, sql, parameter_tuple)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=371,
          lineno=481,
          tokens=236,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='update_record_list',
          body='def update_record_list(self, record_class, record_list):\n'
               '        """ Updates a list of records already in the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '\n'
               '        if not record_list:\n'
               '            return\n'
               '\n'
               '        if len(record_list) == 1:\n'
               '            self.update_record(record_class, record_list[0])\n'
               '            return\n'
               '\n'
               '        for record in record_list:\n'
               '            if constants.DEBUG:\n'
               "                assert isinstance(record, record_class), 'Got "
               "record of unexpected type: %r' % (record,)\n"
               "                assert record.id is not None, 'Cannot update "
               "record which has not been added to the database!'\n"
               '            record.finalize()\n'
               '\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(record_class._table_name,),\n'
               '            field_list=record_class._column_name_list[1:],\n'
               "            where='id = ?')\n"
               '        sql = self._format.format_update(clauses)\n'
               '\n'
               '        parameter_tuple_list = [\n'
               '            record.tuple[1:] + (record.id,)\n'
               '            for record in record_list]\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            self.executemany(cursor, sql, '
               'parameter_tuple_list)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=372,
          lineno=515,
          tokens=120,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='delete_record',
          body='def delete_record(self, record_class, record_or_id):\n'
               '        """ Deletes a record from the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(record_class._table_name,),\n'
               "            where='id = ?')\n"
               '        sql = self._format.format_delete(clauses)\n'
               '\n'
               '        parameter_tuple = (record_or_id.id if '
               'isinstance(record_or_id, record_class) else record_or_id,)\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute(cursor, sql, parameter_tuple)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=373,
          lineno=531,
          tokens=141,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='delete_record_list',
          body='def delete_record_list(self, record_class, '
               'record_or_id_list):\n'
               '        """ Deletes a list of records from the database\n'
               '        """\n'
               '        if constants.DEBUG:\n'
               '            assert issubclass(record_class, '
               'dblayer.backend.base.record.Record)\n'
               '\n'
               '        clauses = self.Clauses(\n'
               '            table_list=(record_class._table_name,),\n'
               "            where='id = ?')\n"
               '        sql = self._format.format_delete(clauses)\n'
               '\n'
               '        parameter_tuple_list = [\n'
               '            (record_or_id.id if isinstance(record_or_id, '
               'record_class) else record_or_id,)\n'
               '            for record_or_id in record_or_id_list]\n'
               '\n'
               '        with self.cursor() as cursor:\n'
               '            self.executemany(cursor, sql, '
               'parameter_tuple_list)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=374,
          lineno=551,
          tokens=61,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='create_language',
          body='def create_language(self, language, ignore_errors=True):\n'
               '        """ Creates a procedural language\n'
               '        """\n'
               '        with self.cursor() as cursor:\n'
               "            statement_list = [('CREATE LANGUAGE %s' % "
               'self._format.quote_name(language), ())]\n'
               '            self.execute_statement_list(cursor, '
               'statement_list, ignore_errors)'),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=375,
          lineno=560,
          tokens=88,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='log_analysis',
          body='def log_analysis(self, cursor, sql, parameter_tuple):\n'
               '        """ Logs analysis of an SQL statement\n'
               '        """\n'
               "        cursor.execute('EXPLAIN ' + sql, parameter_tuple)\n"
               '        util.log(\n'
               "            'Analyzing query:\\n'\n"
               "            '%s\\n'\n"
               "            'With parameters: %r\\n'\n"
               "            '%s',\n"
               '            sql,\n'
               '            parameter_tuple,\n'
               "            '\\n'.join(row[0] for row in cursor.fetchall()))"),
 Fragment(document_cs='75533fad9c59121749bad2850f5be6b2f3a2dd486b78d05674cb5386dc6f59f0',
          id=376,
          lineno=1,
          tokens=276,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: DatabaseAbstraction\n'
               '  Methods: __del__ _connect add_record add_record_list close '
               'commit connect connected create_language cursor delete_record '
               'delete_record_list disable_transactions enable_transactions '
               'execute execute_and_fetch_dict_iter execute_and_fetch_iter '
               'execute_and_fetch_one execute_statement_list executemany '
               'get_last_value_of_last_sequence_used get_record '
               'get_record_iter get_record_list is_primary_key_conflict '
               'log_analysis rollback session transaction update_record '
               'update_record_list\n'
               '  Variables and usages: CURSOR_ARRAYSIZE Clauses DEBUG Error '
               'Exception IntegrityError LOG_SQL_RESULT_ROWS '
               'LOG_SQL_STATEMENTS MAX_INSERT_RETRY_COUNT NotImplementedError '
               'ProgrammingError Record _SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT '
               '_SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT '
               '_SQL_IDENTITY_INSERT_SAVEPOINT _column_name_list _format '
               '_table_name arraysize backend base clauses column connection '
               'constants contextlib contextmanager count cursor_name dblayer '
               'description enumerate fetchall fetchmany fetchone field_list '
               'field_name_list finalize first_id format_delete format_insert '
               'format_release_savepoint format_rollback_to_savepoint '
               'format_savepoint format_select format_update generate_id '
               'get_random_id ignore_errors isolation_level itertools join '
               'language last_id name named named_cursor_counter next '
               'parameter_tuple parameter_tuple_list property quote_name range '
               'reason record record_class record_index record_list '
               'record_or_id record_or_id_list retry row_list serial '
               'set_isolation_level split_index startswith statement_list '
               'table_list table_name truncate_id tuple util where\n'),
 Fragment(document_cs='77947e7435e4399e29143ebecaf53eba4c7ec25708798b900546cd104054f45a',
          id=377,
          lineno=1,
          tokens=8,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Unit test cases for the database package\n'),
 Fragment(document_cs='77947e7435e4399e29143ebecaf53eba4c7ec25708798b900546cd104054f45a',
          id=378,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=379,
          lineno=7,
          tokens=250,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Clauses',
          body='class Clauses:\n'
               '    """ Hashable clauses for a single query\n'
               '    """\n'
               '\n'
               '    __slots__ = (\n'
               '        # List of source tables. Possible items:\n'
               '        # table_name for non-aliased and single tables\n'
               '        # (table_name, alias_name) to start a new cross join '
               'group or\n'
               '        # (table_name, alias_name, join_type, join_condition) '
               'to continue a group.\n'
               "        'table_list',\n"
               '\n'
               '        # List of field expressions, each item must be a '
               'string\n'
               "        'field_list',\n"
               '\n'
               '        # Optional list of where conditions, they are joined '
               'by the AND operator\n'
               "        'where',\n"
               '\n'
               '        # Optional list of group by expressions, each item '
               'must be a string\n'
               "        'group_by',\n"
               '\n'
               '        # Optional list of having conditions, each item must '
               'be a string, they are joined by the AND operator\n'
               "        'having',\n"
               '\n'
               '        # Optional list of order by expressions, each item '
               'must be a string\n'
               "        'order_by',\n"
               '\n'
               '        # Optional integer limit for the number of records '
               'returned\n'
               "        'limit',\n"
               '\n'
               '        # Optional integer offset to shift the limit window '
               'over the result set\n'
               "        'offset',\n"
               '\n'
               '        # Hash value calculated from all the above for caching '
               'SQL statements\n'
               "        'hash_value')\n"),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=380,
          lineno=41,
          tokens=192,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Clauses',
          body='\n'
               '    def __init__(\n'
               '            self,\n'
               '            table_list=(),\n'
               '            field_list=(),\n'
               "            where='',\n"
               '            group_by=(),\n'
               "            having='',\n"
               '            order_by=(),\n'
               '            limit=None,\n'
               '            offset=None):\n'
               '\n'
               '        if constants.DEBUG:\n'
               '            assert isinstance(table_list, (tuple, list))\n'
               '            assert isinstance(field_list, (tuple, list))\n'
               '            assert isinstance(where, str)\n'
               '            assert isinstance(group_by, (tuple, list))\n'
               '            assert isinstance(having, str)\n'
               '            assert isinstance(order_by, (tuple, list))\n'
               '\n'
               '        self.table_list = tuple(table_list)\n'
               '        self.field_list = tuple(field_list)\n'
               '        self.where = str(where)\n'
               '        self.group_by = tuple(group_by)\n'
               '        self.having = str(having)\n'
               '        self.order_by = tuple(order_by)\n'
               '        self.limit = None if limit is None else int(limit)\n'
               '        self.offset = None if offset is None else int(offset)\n'
               '\n'
               '        self.hash_value = None\n'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=381,
          lineno=71,
          tokens=236,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Clauses',
          body='\n'
               '    def __repr__(self):\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(\n"
               "                '%s=%r' % (name, value)\n"
               '                for name, value in zip(self.__slots__, '
               'self.get_tuple())))\n'
               '\n'
               '    __str__ = __repr__\n'
               '\n'
               '    def get_tuple(self):\n'
               '        return (\n'
               '            self.table_list,\n'
               '            self.field_list,\n'
               '            self.where,\n'
               '            self.group_by,\n'
               '            self.having,\n'
               '            self.order_by,\n'
               '            self.limit,\n'
               '            self.offset)\n'
               '\n'
               '    def __hash__(self):\n'
               '        if self.hash_value is None:\n'
               '            self.hash_value = hash(self.get_tuple())\n'
               '        elif constants.DEBUG:\n'
               '            assert self.hash_value == hash(self.get_tuple()), '
               "'Clauses instance has been changed since its hash calculated "
               "the last time!'\n"
               '        return self.hash_value\n'
               '\n'
               '    def __eq__(self, other):\n'
               '        if not isinstance(other, Clauses):\n'
               '            return False\n'
               '        if hash(self) != hash(other):\n'
               '            return False\n'
               '        return self.get_tuple() == other.get_tuple()'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=382,
          lineno=4,
          tokens=10,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer import constantsfrom dblayer import constants'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=383,
          lineno=1,
          tokens=7,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Data structures for preparing SQL queries\n'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=384,
          lineno=8,
          tokens=172,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Hashable clauses for a single query\n'
               '    # List of source tables. Possible items:# table_name for '
               'non-aliased and single tables# (table_name, alias_name) to '
               'start a new cross join group or# (table_name, alias_name, '
               'join_type, join_condition) to continue a group.# List of field '
               'expressions, each item must be a string# Optional list of '
               'where conditions, they are joined by the AND operator# '
               'Optional list of group by expressions, each item must be a '
               'string# Optional list of having conditions, each item must be '
               'a string, they are joined by the AND operator# Optional list '
               'of order by expressions, each item must be a string# Optional '
               'integer limit for the number of records returned# Optional '
               'integer offset to shift the limit window over the result set# '
               'Hash value calculated from all the above for caching SQL '
               'statements'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=385,
          lineno=97,
          tokens=14,
          depth=9,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Clauses instance has been changed since its hash calculated '
               'the last time!'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=386,
          lineno=42,
          tokens=189,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(\n'
               '            self,\n'
               '            table_list=(),\n'
               '            field_list=(),\n'
               "            where='',\n"
               '            group_by=(),\n'
               "            having='',\n"
               '            order_by=(),\n'
               '            limit=None,\n'
               '            offset=None):\n'
               '\n'
               '        if constants.DEBUG:\n'
               '            assert isinstance(table_list, (tuple, list))\n'
               '            assert isinstance(field_list, (tuple, list))\n'
               '            assert isinstance(where, str)\n'
               '            assert isinstance(group_by, (tuple, list))\n'
               '            assert isinstance(having, str)\n'
               '            assert isinstance(order_by, (tuple, list))\n'
               '\n'
               '        self.table_list = tuple(table_list)\n'
               '        self.field_list = tuple(field_list)\n'
               '        self.where = str(where)\n'
               '        self.group_by = tuple(group_by)\n'
               '        self.having = str(having)\n'
               '        self.order_by = tuple(order_by)\n'
               '        self.limit = None if limit is None else int(limit)\n'
               '        self.offset = None if offset is None else int(offset)\n'
               '\n'
               '        self.hash_value = None'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=387,
          lineno=72,
          tokens=71,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(\n"
               "                '%s=%r' % (name, value)\n"
               '                for name, value in zip(self.__slots__, '
               'self.get_tuple())))'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=388,
          lineno=82,
          tokens=45,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_tuple',
          body='def get_tuple(self):\n'
               '        return (\n'
               '            self.table_list,\n'
               '            self.field_list,\n'
               '            self.where,\n'
               '            self.group_by,\n'
               '            self.having,\n'
               '            self.order_by,\n'
               '            self.limit,\n'
               '            self.offset)'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=389,
          lineno=93,
          tokens=60,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__hash__',
          body='def __hash__(self):\n'
               '        if self.hash_value is None:\n'
               '            self.hash_value = hash(self.get_tuple())\n'
               '        elif constants.DEBUG:\n'
               '            assert self.hash_value == hash(self.get_tuple()), '
               "'Clauses instance has been changed since its hash calculated "
               "the last time!'\n"
               '        return self.hash_value'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=390,
          lineno=100,
          tokens=45,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__eq__',
          body='def __eq__(self, other):\n'
               '        if not isinstance(other, Clauses):\n'
               '            return False\n'
               '        if hash(self) != hash(other):\n'
               '            return False\n'
               '        return self.get_tuple() == other.get_tuple()'),
 Fragment(document_cs='78776ee7705bd6fd5e99fda8a6e68b330fa8d5003268a7142218ba0952a0927d',
          id=391,
          lineno=1,
          tokens=57,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: Clauses\n'
               '  Methods: __eq__ __hash__ __init__ __repr__ get_tuple\n'
               '  Variables and usages: DEBUG constants dblayer field_list '
               'group_by hash hash_value having join limit name offset '
               'order_by other rsplit table_list tuple value where\n'),
 Fragment(document_cs='80f6421722e87d57619a1c9b53e07c05be38f0c0274b4430b86cd720b7b9effa',
          id=392,
          lineno=10,
          tokens=46,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='GeneratorOptions',
          body='class GeneratorOptions:\n'
               '    """ Code generation options\n'
               '    """\n'
               '    # Generate code for the following operations only\n'
               '    insert = True\n'
               '    update = True\n'
               '    delete = True\n'
               '    create = True\n'
               '    drop = True'),
 Fragment(document_cs='80f6421722e87d57619a1c9b53e07c05be38f0c0274b4430b86cd720b7b9effa',
          id=393,
          lineno=4,
          tokens=14,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import datetimeimport bottlefrom dblayer import constantsfrom '
               'dblayer import constants'),
 Fragment(document_cs='80f6421722e87d57619a1c9b53e07c05be38f0c0274b4430b86cd720b7b9effa',
          id=394,
          lineno=1,
          tokens=6,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Database abstraction layer code generator\n'),
 Fragment(document_cs='80f6421722e87d57619a1c9b53e07c05be38f0c0274b4430b86cd720b7b9effa',
          id=395,
          lineno=11,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Code generation options\n'
               '    # Generate code for the following operations only'),
 Fragment(document_cs='80f6421722e87d57619a1c9b53e07c05be38f0c0274b4430b86cd720b7b9effa',
          id=396,
          lineno=22,
          tokens=22,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Generates database abstraction layer code for the given '
               'database\n'
               '    model using the given database server specific backend '
               'module\n'
               '    '),
 Fragment(document_cs='80f6421722e87d57619a1c9b53e07c05be38f0c0274b4430b86cd720b7b9effa',
          id=397,
          lineno=21,
          tokens=151,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='generate',
          body='def generate(database, backend, abstraction_class_name, '
               'options=None):\n'
               '    """ Generates database abstraction layer code for the '
               'given database\n'
               '    model using the given database server specific backend '
               'module\n'
               '    """\n'
               '    if options is None:\n'
               '        options = GeneratorOptions()\n'
               '    else:\n'
               '        assert isinstance(options, GeneratorOptions)\n'
               '\n'
               '    format = __import__(backend.__name__, '
               "fromlist=('format',)).format\n"
               '\n'
               "    return ''.join(bottle.template(\n"
               "        'database',\n"
               '        '
               'template_lookup=[constants.GENERATOR_TEMPLATE_DIRECTORY_PATH],\n'
               '        template_settings=dict(noescape=True),\n'
               '        constants=constants,\n'
               '        database=database,\n'
               '        backend=backend,\n'
               '        options=options,\n'
               '        format=format,\n'
               '        abstraction_class_name=abstraction_class_name,\n'
               '        now=datetime.datetime.now()))'),
 Fragment(document_cs='80f6421722e87d57619a1c9b53e07c05be38f0c0274b4430b86cd720b7b9effa',
          id=398,
          lineno=1,
          tokens=50,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Functions: generate\n'
               '  Classes: GeneratorOptions\n'
               '  Variables and usages: GENERATOR_TEMPLATE_DIRECTORY_PATH '
               'abstraction_class_name backend bottle constants create '
               'database datetime dblayer delete drop format fromlist insert '
               'join noescape options template template_lookup '
               'template_settings update\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=399,
          lineno=10,
          tokens=233,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='ColumnInfo',
          body='class ColumnInfo:\n'
               '    __slots__ = (\n'
               "        'table_name',\n"
               "        'column_name',\n"
               "        'data_type',\n"
               "        'column_default',\n"
               "        'is_nullable',\n"
               "        'character_maximum_length',\n"
               "        'numeric_precision',\n"
               "        'numeric_precision_radix',\n"
               "        'numeric_scale',\n"
               '    )\n'
               '\n'
               '    def __init__(self, table_name=None, column_name=None, '
               'data_type=None, column_default=None,\n'
               '                 is_nullable=None, '
               'character_maximum_length=None, numeric_precision=None,\n'
               '                 numeric_scale=None, '
               'numeric_precision_radix=None):\n'
               '        self.table_name = table_name\n'
               '        self.column_name = column_name\n'
               '        self.data_type = data_type\n'
               '        self.column_default = column_default\n'
               '        self.is_nullable = is_nullable\n'
               '        self.character_maximum_length = '
               'character_maximum_length\n'
               '        self.numeric_precision = numeric_precision\n'
               '        self.numeric_scale = numeric_scale\n'
               '        self.numeric_precision_radix = '
               'numeric_precision_radix\n'
               '\n'
               '    def load_information_schema(self, row):\n'
               '        """ Loads column information from a row selected from '
               'information_schema.columns table\n'
               '        """\n'
               '        for name in self.__slots__:\n'
               '            setattr(self, name, row[name])\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=400,
          lineno=41,
          tokens=87,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='ColumnInfo',
          body='\n'
               '    def __repr__(self):\n'
               '        name_value_list = [(name, getattr(self, name)) for '
               'name in self.__slots__]\n'
               "        return '%s(%s)' % (\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(\n"
               "                '%s=%r' % (name, value)\n"
               '                for name, value in name_value_list\n'
               '                if value is not None))\n'
               '\n'
               '    __str__ = __repr__'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=401,
          lineno=54,
          tokens=10,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='class '
               'DatabaseInspector(postgresql_database.DatabaseAbstraction):\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=402,
          lineno=55,
          tokens=242,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='\n'
               "    def __init__(self, primary_key_column_name_set=('id',), "
               'primary_key_columns={}):\n'
               '        """ Database inspector\n'
               '        \n'
               '        Inspects an existing PostgreSQL database and builds up '
               'the database model classes runtime.\n'
               '        \n'
               '        primary_key_column_name_set: set of primary key column '
               "names, defaults to ('id', )\n"
               '        \n'
               '        primary_key_columns: primary key names by table: '
               '{table_name: primary_key_column_name_set}\n'
               '        \n'
               '        """\n'
               '        '
               'postgresql_database.DatabaseAbstraction.__init__(self)\n'
               '\n'
               '        self.primary_key_column_name_set = '
               'primary_key_column_name_set\n'
               '        self.primary_key_columns = primary_key_columns\n'
               '\n'
               '        self.COLUMN_FACTORY_MAP = {\n'
               "            'bigint': self.define_bigint_column,\n"
               "            'boolean': self.define_boolean_column,\n"
               "            'character varying': self.define_varchar_column,\n"
               "            'date': self.define_date_column,\n"
               "            'integer': self.define_integer_column,\n"
               "            'real': self.define_real_column,\n"
               "            'double precision': self.define_double_column,\n"
               "            'numeric': self.define_numeric_column,\n"
               "            'text': self.define_text_column,\n"
               "            'timestamp without time zone': "
               'self.define_timestamp_column,\n'
               "            'tsvector': self.define_tsvector_column,\n"
               '        }\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=403,
          lineno=84,
          tokens=210,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='\n'
               '    def inspect(self, dsn, database_class_name):\n'
               '        """ Inspects a database and returns database model '
               'class\n'
               '        \n'
               '        You can use the pretty_format_class() class method on '
               'the database model class returned\n'
               '        to generate source code for the model.\n'
               '        \n'
               '        """\n'
               '        with self.session(dsn):\n'
               '            table_class_list = self.inspect_tables()\n'
               '\n'
               '        class_dict = {}\n'
               '        for table_class in table_class_list:\n'
               '            assert issubclass(table_class, table.Table)\n'
               '            class_dict[table_class._table_name] = '
               'table_class()\n'
               '\n'
               '        database_class = type(database_class_name, '
               '(database.Database,), class_dict)\n'
               '        assert issubclass(database_class, database.Database)\n'
               '\n'
               '        return database_class\n'
               '\n'
               '    def inspect_tables(self):\n'
               '        """ Inspects database tables and returns list of table '
               'definition classes\n'
               '        """\n'
               '        raise NotImplementedError()\n'
               '\n'
               '    def convert_table_name_to_python(self, table_name):\n'
               '        """ Converts underscore table name used in the '
               'database to CapitalizedWords format\n'
               '        """\n'
               "        return ''.join(word.capitalize() for word in "
               "table_name.split('_'))\n"),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=404,
          lineno=114,
          tokens=179,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='\n'
               '    def inspect_tables(self):\n'
               '\n'
               "        sql = '''\n"
               'SELECT * \n'
               'FROM information_schema.columns \n'
               "WHERE table_schema = 'public'\n"
               'ORDER BY table_name, ordinal_position;\n'
               "'''\n"
               '\n'
               '        get_column_factory = self.COLUMN_FACTORY_MAP.get\n'
               '\n'
               '        table_class_map = {}\n'
               '        with self.cursor() as cursor:\n'
               '            for row in '
               'self.execute_and_fetch_dict_iter(cursor, sql):\n'
               '\n'
               '                column_info = ColumnInfo()\n'
               '                column_info.load_information_schema(row)\n'
               '\n'
               '                table_class = '
               'table_class_map.get(column_info.table_name)\n'
               '                if table_class is None:\n'
               '                    class_name = '
               'str(self.convert_table_name_to_python(column_info.table_name))\n'
               '                    table_class = type(class_name, '
               '(table.Table,), {})\n'
               '                    table_class._table_name = '
               'column_info.table_name\n'
               '                    table_class_map[column_info.table_name] = '
               'table_class\n'
               '\n'
               '                table_pk_columns = '
               'self.primary_key_columns.get(column_info.column_name, ())\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=405,
          lineno=141,
          tokens=132,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='                if (column_info.column_name in '
               'self.primary_key_column_name_set or\n'
               '                        column_info.column_name in '
               'table_pk_columns):\n'
               '                    column_factory = '
               'self.define_primary_key_column\n'
               '                else:\n'
               '                    column_factory = get_column_factory(\n'
               '                        column_info.data_type, '
               'self.define_custom_column)\n'
               '\n'
               '                try:\n'
               '                    column_definition = '
               'column_factory(column_info)\n'
               '                except ValueError:\n'
               '                    util.log(\n'
               "                        'WARNING: Skipping column due to "
               "unparsable column info: %r' % column_info)\n"
               '                    continue\n'
               '                assert isinstance(column_definition, '
               'column.BaseColumn)\n'
               '\n'
               '                setattr(table_class, column_info.column_name, '
               'column_definition)\n'
               '\n'
               '        return table_class_map.values()\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=406,
          lineno=159,
          tokens=204,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='\n'
               '    def define_custom_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Custom(\n'
               '            sql_type=column_info.data_type,\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'
               '\n'
               '    def define_primary_key_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               "        serial = 'nextval' in (column_info.column_default or "
               "'').lower()\n"
               '        column_definition = column.PrimaryKey(serial=serial)\n'
               '        return column_definition\n'
               '\n'
               '    def define_bigint_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Integer(\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'
               '\n'
               '    def define_boolean_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Boolean(\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=407,
          lineno=187,
          tokens=222,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='\n'
               '    def define_varchar_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Text(\n'
               '            maxlength=column_info.character_maximum_length,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'
               '\n'
               '    def define_date_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Date(\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'
               '\n'
               '    def define_integer_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        if isinstance(column_info.column_default, str):\n'
               '            default = '
               'function.Custom(column_info.column_default)\n'
               '        else:\n'
               '            default = column_info.column_default\n'
               '        column_definition = column.Integer(\n'
               '            default=default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'
               '\n'
               '    def define_real_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Float(\n'
               '            double=False,\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=408,
          lineno=220,
          tokens=245,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='\n'
               '    def define_double_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Float(\n'
               '            double=True,\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'
               '\n'
               '    def define_numeric_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        if column_info.numeric_precision_radix != 10:\n'
               '            raise NotImplementedError()\n'
               '        if not column_info.numeric_scale:\n'
               '            column_definition = column.Integer(\n'
               '                digits=column_info.numeric_precision,\n'
               '                default=column_info.column_default,\n'
               '                null=column_info.is_nullable)\n'
               '        else:\n'
               '            assert column_info.numeric_precision is not None\n'
               '            column_definition = column.Decimal(\n'
               '                precision=column_info.numeric_precision,\n'
               '                scale=column_info.numeric_scale,\n'
               '                default=column_info.column_default,\n'
               '                null=column_info.is_nullable)\n'
               '        return column_definition\n'
               '\n'
               '    def define_text_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Text(\n'
               '            maxlength=column_info.character_maximum_length,\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=409,
          lineno=254,
          tokens=84,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseInspector',
          body='\n'
               '    def define_timestamp_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Datetime(\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition\n'
               '\n'
               '    def define_tsvector_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = '
               'column.SearchDocument(implicit=False)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=410,
          lineno=4,
          tokens=58,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer import utilfrom dblayer import utilfrom '
               'dblayer.backend.postgresql import database as '
               'postgresql_databasefrom dblayer.backend.postgresql import '
               'database as postgresql_databasefrom dblayer.model import '
               'database, table, column, functionfrom dblayer.model import '
               'database, table, column, function'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=411,
          lineno=1,
          tokens=5,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Database inspector for PostgreSQL\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=412,
          lineno=17,
          tokens=7,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='character_maximum_lengthnumeric_precision_radix'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=413,
          lineno=37,
          tokens=14,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Loads column information from a row selected from '
               'information_schema.columns table\n'
               '        '),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=414,
          lineno=57,
          tokens=68,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Database inspector\n'
               '        \n'
               '        Inspects an existing PostgreSQL database and builds up '
               'the database model classes runtime.\n'
               '        \n'
               '        primary_key_column_name_set: set of primary key column '
               "names, defaults to ('id', )\n"
               '        \n'
               '        primary_key_columns: primary key names by table: '
               '{table_name: primary_key_column_name_set}\n'
               '        \n'
               '        timestamp without time zone'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=415,
          lineno=86,
          tokens=39,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Inspects a database and returns database model class\n'
               '        \n'
               '        You can use the pretty_format_class() class method on '
               'the database model class returned\n'
               '        to generate source code for the model.\n'
               '        \n'
               '        '),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=416,
          lineno=106,
          tokens=13,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Inspects database tables and returns list of table definition '
               'classes\n'
               '        '),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=417,
          lineno=111,
          tokens=15,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Converts underscore table name used in the database to '
               'CapitalizedWords format\n'
               '        '),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=418,
          lineno=117,
          tokens=38,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='\n'
               'SELECT * \n'
               'FROM information_schema.columns \n'
               "WHERE table_schema = 'public'\n"
               'ORDER BY table_name, ordinal_position;\n'
               'WARNING: Skipping column due to unparsable column info: %r'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=419,
          lineno=23,
          tokens=127,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, table_name=None, column_name=None, '
               'data_type=None, column_default=None,\n'
               '                 is_nullable=None, '
               'character_maximum_length=None, numeric_precision=None,\n'
               '                 numeric_scale=None, '
               'numeric_precision_radix=None):\n'
               '        self.table_name = table_name\n'
               '        self.column_name = column_name\n'
               '        self.data_type = data_type\n'
               '        self.column_default = column_default\n'
               '        self.is_nullable = is_nullable\n'
               '        self.character_maximum_length = '
               'character_maximum_length\n'
               '        self.numeric_precision = numeric_precision\n'
               '        self.numeric_scale = numeric_scale\n'
               '        self.numeric_precision_radix = numeric_precision_radix'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=420,
          lineno=36,
          tokens=43,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='load_information_schema',
          body='def load_information_schema(self, row):\n'
               '        """ Loads column information from a row selected from '
               'information_schema.columns table\n'
               '        """\n'
               '        for name in self.__slots__:\n'
               '            setattr(self, name, row[name])'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=421,
          lineno=42,
          tokens=77,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               '        name_value_list = [(name, getattr(self, name)) for '
               'name in self.__slots__]\n'
               "        return '%s(%s)' % (\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(\n"
               "                '%s=%r' % (name, value)\n"
               '                for name, value in name_value_list\n'
               '                if value is not None))'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=422,
          lineno=56,
          tokens=240,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body="def __init__(self, primary_key_column_name_set=('id',), "
               'primary_key_columns={}):\n'
               '        """ Database inspector\n'
               '        \n'
               '        Inspects an existing PostgreSQL database and builds up '
               'the database model classes runtime.\n'
               '        \n'
               '        primary_key_column_name_set: set of primary key column '
               "names, defaults to ('id', )\n"
               '        \n'
               '        primary_key_columns: primary key names by table: '
               '{table_name: primary_key_column_name_set}\n'
               '        \n'
               '        """\n'
               '        '
               'postgresql_database.DatabaseAbstraction.__init__(self)\n'
               '\n'
               '        self.primary_key_column_name_set = '
               'primary_key_column_name_set\n'
               '        self.primary_key_columns = primary_key_columns\n'
               '\n'
               '        self.COLUMN_FACTORY_MAP = {\n'
               "            'bigint': self.define_bigint_column,\n"
               "            'boolean': self.define_boolean_column,\n"
               "            'character varying': self.define_varchar_column,\n"
               "            'date': self.define_date_column,\n"
               "            'integer': self.define_integer_column,\n"
               "            'real': self.define_real_column,\n"
               "            'double precision': self.define_double_column,\n"
               "            'numeric': self.define_numeric_column,\n"
               "            'text': self.define_text_column,\n"
               "            'timestamp without time zone': "
               'self.define_timestamp_column,\n'
               "            'tsvector': self.define_tsvector_column,\n"
               '        }'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=423,
          lineno=85,
          tokens=136,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='inspect',
          body='def inspect(self, dsn, database_class_name):\n'
               '        """ Inspects a database and returns database model '
               'class\n'
               '        \n'
               '        You can use the pretty_format_class() class method on '
               'the database model class returned\n'
               '        to generate source code for the model.\n'
               '        \n'
               '        """\n'
               '        with self.session(dsn):\n'
               '            table_class_list = self.inspect_tables()\n'
               '\n'
               '        class_dict = {}\n'
               '        for table_class in table_class_list:\n'
               '            assert issubclass(table_class, table.Table)\n'
               '            class_dict[table_class._table_name] = '
               'table_class()\n'
               '\n'
               '        database_class = type(database_class_name, '
               '(database.Database,), class_dict)\n'
               '        assert issubclass(database_class, database.Database)\n'
               '\n'
               '        return database_class'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=424,
          lineno=105,
          tokens=25,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='inspect_tables',
          body='def inspect_tables(self):\n'
               '        """ Inspects database tables and returns list of table '
               'definition classes\n'
               '        """\n'
               '        raise NotImplementedError()'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=425,
          lineno=110,
          tokens=44,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='convert_table_name_to_python',
          body='def convert_table_name_to_python(self, table_name):\n'
               '        """ Converts underscore table name used in the '
               'database to CapitalizedWords format\n'
               '        """\n'
               "        return ''.join(word.capitalize() for word in "
               "table_name.split('_'))"),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=426,
          lineno=115,
          tokens=177,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='inspect_tables',
          body='def inspect_tables(self):\n'
               '\n'
               "        sql = '''\n"
               'SELECT * \n'
               'FROM information_schema.columns \n'
               "WHERE table_schema = 'public'\n"
               'ORDER BY table_name, ordinal_position;\n'
               "'''\n"
               '\n'
               '        get_column_factory = self.COLUMN_FACTORY_MAP.get\n'
               '\n'
               '        table_class_map = {}\n'
               '        with self.cursor() as cursor:\n'
               '            for row in '
               'self.execute_and_fetch_dict_iter(cursor, sql):\n'
               '\n'
               '                column_info = ColumnInfo()\n'
               '                column_info.load_information_schema(row)\n'
               '\n'
               '                table_class = '
               'table_class_map.get(column_info.table_name)\n'
               '                if table_class is None:\n'
               '                    class_name = '
               'str(self.convert_table_name_to_python(column_info.table_name))\n'
               '                    table_class = type(class_name, '
               '(table.Table,), {})\n'
               '                    table_class._table_name = '
               'column_info.table_name\n'
               '                    table_class_map[column_info.table_name] = '
               'table_class\n'
               '\n'
               '                table_pk_columns = '
               'self.primary_key_columns.get(column_info.column_name, ())\n'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=427,
          lineno=141,
          tokens=132,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='inspect_tables',
          body='                if (column_info.column_name in '
               'self.primary_key_column_name_set or\n'
               '                        column_info.column_name in '
               'table_pk_columns):\n'
               '                    column_factory = '
               'self.define_primary_key_column\n'
               '                else:\n'
               '                    column_factory = get_column_factory(\n'
               '                        column_info.data_type, '
               'self.define_custom_column)\n'
               '\n'
               '                try:\n'
               '                    column_definition = '
               'column_factory(column_info)\n'
               '                except ValueError:\n'
               '                    util.log(\n'
               "                        'WARNING: Skipping column due to "
               "unparsable column info: %r' % column_info)\n"
               '                    continue\n'
               '                assert isinstance(column_definition, '
               'column.BaseColumn)\n'
               '\n'
               '                setattr(table_class, column_info.column_name, '
               'column_definition)\n'
               '\n'
               '        return table_class_map.values()'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=428,
          lineno=160,
          tokens=54,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_custom_column',
          body='def define_custom_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Custom(\n'
               '            sql_type=column_info.data_type,\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=429,
          lineno=168,
          tokens=50,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_primary_key_column',
          body='def define_primary_key_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               "        serial = 'nextval' in (column_info.column_default or "
               "'').lower()\n"
               '        column_definition = column.PrimaryKey(serial=serial)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=430,
          lineno=174,
          tokens=46,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_bigint_column',
          body='def define_bigint_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Integer(\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=431,
          lineno=181,
          tokens=45,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_boolean_column',
          body='def define_boolean_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Boolean(\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=432,
          lineno=188,
          tokens=47,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_varchar_column',
          body='def define_varchar_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Text(\n'
               '            maxlength=column_info.character_maximum_length,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=433,
          lineno=195,
          tokens=45,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_date_column',
          body='def define_date_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Date(\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=434,
          lineno=202,
          tokens=72,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_integer_column',
          body='def define_integer_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        if isinstance(column_info.column_default, str):\n'
               '            default = '
               'function.Custom(column_info.column_default)\n'
               '        else:\n'
               '            default = column_info.column_default\n'
               '        column_definition = column.Integer(\n'
               '            default=default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=435,
          lineno=213,
          tokens=49,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_real_column',
          body='def define_real_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Float(\n'
               '            double=False,\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=436,
          lineno=221,
          tokens=49,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_double_column',
          body='def define_double_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Float(\n'
               '            double=True,\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=437,
          lineno=229,
          tokens=135,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_numeric_column',
          body='def define_numeric_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        if column_info.numeric_precision_radix != 10:\n'
               '            raise NotImplementedError()\n'
               '        if not column_info.numeric_scale:\n'
               '            column_definition = column.Integer(\n'
               '                digits=column_info.numeric_precision,\n'
               '                default=column_info.column_default,\n'
               '                null=column_info.is_nullable)\n'
               '        else:\n'
               '            assert column_info.numeric_precision is not None\n'
               '            column_definition = column.Decimal(\n'
               '                precision=column_info.numeric_precision,\n'
               '                scale=column_info.numeric_scale,\n'
               '                default=column_info.column_default,\n'
               '                null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=438,
          lineno=247,
          tokens=54,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_text_column',
          body='def define_text_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Text(\n'
               '            maxlength=column_info.character_maximum_length,\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=439,
          lineno=255,
          tokens=46,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_timestamp_column',
          body='def define_timestamp_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = column.Datetime(\n'
               '            default=column_info.column_default,\n'
               '            null=column_info.is_nullable)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=440,
          lineno=262,
          tokens=34,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='define_tsvector_column',
          body='def define_tsvector_column(self, column_info):\n'
               '        assert isinstance(column_info, ColumnInfo)\n'
               '        column_definition = '
               'column.SearchDocument(implicit=False)\n'
               '        return column_definition'),
 Fragment(document_cs='85b4510ccf193ea3968ed579124e3a34ce6560c322e39b69bb5287798c97ee06',
          id=441,
          lineno=1,
          tokens=211,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: ColumnInfo DatabaseInspector\n'
               '  Methods: __init__ __repr__ convert_table_name_to_python '
               'define_bigint_column define_boolean_column '
               'define_custom_column define_date_column define_double_column '
               'define_integer_column define_numeric_column '
               'define_primary_key_column define_real_column '
               'define_text_column define_timestamp_column '
               'define_tsvector_column define_varchar_column inspect '
               'inspect_tables load_information_schema\n'
               '  Variables and usages: BaseColumn Boolean COLUMN_FACTORY_MAP '
               'Custom Database DatabaseAbstraction Date Datetime Decimal '
               'Float Integer NotImplementedError PrimaryKey SearchDocument '
               'Table Text ValueError _table_name backend capitalize '
               'character_maximum_length class_dict class_name column '
               'column_default column_definition column_factory column_info '
               'column_name cursor data_type database database_class '
               'database_class_name dblayer default digits double '
               'execute_and_fetch_dict_iter function get_column_factory '
               'getattr implicit is_nullable join lower maxlength model name '
               'name_value_list null numeric_precision numeric_precision_radix '
               'numeric_scale postgresql postgresql_database precision '
               'primary_key_column_name_set primary_key_columns scale serial '
               'session setattr split sql_type table table_class '
               'table_class_list table_class_map table_name table_pk_columns '
               'type util value values word\n'),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=442,
          lineno=5,
          tokens=232,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Record',
          body='class Record:\n'
               '    """ Base class for the generated record classes\n'
               '    """\n'
               '\n'
               '    # Name of the corresponding database table storing the '
               'actual records\n'
               "    _table_name = ''\n"
               '\n'
               '    ### Runtime column information\n'
               '\n'
               '    # List of column names\n'
               '    _column_name_list = ()\n'
               '\n'
               '    # Set of names of nullable columns\n'
               '    _nullable_column_name_set = set()\n'
               '\n'
               "    # Map of column names to default field values (if there's "
               'one)\n'
               '    _column_default_map = {}\n'
               '\n'
               '    ### Optimization\n'
               '\n'
               '    # Subclasses will define record fields as slots\n'
               '    __slots__ = ()\n'
               '\n'
               '    ### Textual representation for logging and debugging\n'
               '\n'
               '    def __repr__(self):\n'
               '        get_default_field_value = '
               'self._column_default_map.get\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(\n"
               "                '%s=%r' % (name, getattr(self, name))\n"
               '                for name in self._column_name_list\n'
               '                if getattr(self, name) is not '
               'get_default_field_value(name)))\n'
               '\n'
               '    __str__ = __repr__\n'),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=443,
          lineno=41,
          tokens=126,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Record',
          body='\n'
               '    def __eq__(self, other):\n'
               '        if other.__class__ is not self.__class__:\n'
               '            return False\n'
               '        for name in self._column_name_list:\n'
               '            if getattr(self, name) != getattr(other, name):\n'
               '                return False\n'
               '        return True\n'
               '\n'
               '    def finalize(self):\n'
               '        """ Finalizes the record\n'
               '        \n'
               '        Override in your subclass to provide calculated field '
               'values\n'
               '        right before storing or updating the record into the '
               'database.\n'
               '        Finalization should not raise exceptions normally.\n'
               '        \n'
               '        This method should only access this single record,\n'
               '        it must not execute queries for its operation.\n'
               '        \n'
               '        """'),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=444,
          lineno=1,
          tokens=8,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for the generated record classes\n'),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=445,
          lineno=6,
          tokens=67,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for the generated record classes\n'
               '    # Name of the corresponding database table storing the '
               'actual records### Runtime column information# List of column '
               'names# Set of names of nullable columns# Map of column names '
               "to default field values (if there's one)# Subclasses will "
               'define record fields as slots### Textual representation for '
               'logging and debugging'),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=446,
          lineno=51,
          tokens=60,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Finalizes the record\n'
               '        \n'
               '        Override in your subclass to provide calculated field '
               'values\n'
               '        right before storing or updating the record into the '
               'database.\n'
               '        Finalization should not raise exceptions normally.\n'
               '        \n'
               '        This method should only access this single record,\n'
               '        it must not execute queries for its operation.\n'
               '        \n'
               '        '),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=447,
          lineno=30,
          tokens=97,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               '        get_default_field_value = '
               'self._column_default_map.get\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(\n"
               "                '%s=%r' % (name, getattr(self, name))\n"
               '                for name in self._column_name_list\n'
               '                if getattr(self, name) is not '
               'get_default_field_value(name)))'),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=448,
          lineno=42,
          tokens=55,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__eq__',
          body='def __eq__(self, other):\n'
               '        if other.__class__ is not self.__class__:\n'
               '            return False\n'
               '        for name in self._column_name_list:\n'
               '            if getattr(self, name) != getattr(other, name):\n'
               '                return False\n'
               '        return True'),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=449,
          lineno=50,
          tokens=67,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='finalize',
          body='def finalize(self):\n'
               '        """ Finalizes the record\n'
               '        \n'
               '        Override in your subclass to provide calculated field '
               'values\n'
               '        right before storing or updating the record into the '
               'database.\n'
               '        Finalization should not raise exceptions normally.\n'
               '        \n'
               '        This method should only access this single record,\n'
               '        it must not execute queries for its operation.\n'
               '        \n'
               '        """'),
 Fragment(document_cs='890f6003bff0b6602d60cc88105dd2915e8167179920868b0664c8ca56ae0005',
          id=450,
          lineno=1,
          tokens=49,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: Record\n'
               '  Methods: __eq__ __repr__ finalize\n'
               '  Variables and usages: _column_default_map _column_name_list '
               '_nullable_column_name_set _table_name get_default_field_value '
               'getattr join name other rsplit\n'),
 Fragment(document_cs='8f8cdf9fc578461e52a24107a5d327e78d830e29473842db0748909c785246dc',
          id=451,
          lineno=1,
          tokens=5,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Database abstraction layer generator\n'),
 Fragment(document_cs='8f8cdf9fc578461e52a24107a5d327e78d830e29473842db0748909c785246dc',
          id=452,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=453,
          lineno=7,
          tokens=227,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseConstraint',
          body='class BaseConstraint:\n'
               '    """ Base class for database constraints\n'
               '    """\n'
               '\n'
               '    # Serial number to record the order of constraint '
               'definitions\n'
               '    __definition_serial__ = 0\n'
               '\n'
               '    # Reference to the table class containing this constraint\n'
               '    # NOTE: Set by __new__ of the table definition class\n'
               '    table_class = None\n'
               '\n'
               '    # Reference to the table instance containing this '
               'constraint or None for model constraints\n'
               '    # NOTE: Filled in by Table.__init__ as part of cloning the '
               'constraints from the class to the instance\n'
               '    table = None\n'
               '\n'
               '    # Name of the constraint\n'
               '    # NOTE: Set by __new__ of the table definition class\n'
               "    name = ''\n"
               '\n'
               '    # Indicates that this model object is added implicitly by '
               'some other model object\n'
               '    implicit = False\n'
               '\n'
               '    @staticmethod\n'
               '    def sort_key(obj):\n'
               '        return obj.__definition_serial__\n'
               '\n'
               '    def __init__(self):\n'
               '        assert self.__class__ is not BaseConstraint, (\n'
               "            'Only subclasses of BaseConstraint can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=454,
          lineno=39,
          tokens=153,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseConstraint',
          body='\n'
               '    def __str__(self):\n'
               "        return '<%s Constraint: %s.%s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name)\n'
               '\n'
               '    def __repr__(self):\n'
               "        return '%s.%s()' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__)\n'
               '\n'
               '    def clone(self, table):\n'
               '        """ Clone this constraint for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'constraints to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.table = table\n'
               '        return clone'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=455,
          lineno=63,
          tokens=214,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseColumnConstraint',
          body='class BaseColumnConstraint(BaseConstraint):\n'
               '    """ Base class for constraints applied on a single column '
               'or a set of columns\n'
               '    """\n'
               '    # Tuple of the member columns\n'
               '    columns = ()\n'
               '\n'
               '    def __init__(self, *columns):\n'
               '        BaseConstraint.__init__(self)\n'
               '\n'
               '        assert self.__class__ is not BaseColumnConstraint, (\n'
               "            'Only subclasses of BaseColumnConstraint can be "
               "instantiated!')\n"
               '\n'
               "        assert columns, 'This constraint must be applied to at "
               "least one column!'\n"
               '        self.columns = columns\n'
               '\n'
               '    def __str__(self):\n'
               "        return '<%s Constraint: %s.%s on %r>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name,\n'
               '            tuple(column.name for column in self.columns))\n'
               '\n'
               '    def __repr__(self):\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(column.name for column in "
               'self.columns))\n'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=456,
          lineno=90,
          tokens=38,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseColumnConstraint',
          body='\n'
               '    def clone(self, table):\n'
               '        clone = BaseConstraint.clone(self, table)\n'
               '        clone.columns = [getattr(table, column.name) for '
               'column in self.columns]\n'
               '        return clone'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=457,
          lineno=97,
          tokens=15,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='PrimaryKey',
          body='class PrimaryKey(BaseColumnConstraint):\n'
               '    """ Primary key constraint\n'
               '    """'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=458,
          lineno=102,
          tokens=14,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='ForeignKey',
          body='class ForeignKey(BaseColumnConstraint):\n'
               '    """ Foreign key constraint\n'
               '    """'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=459,
          lineno=107,
          tokens=14,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Unique',
          body='class Unique(BaseColumnConstraint):\n'
               '    """ Unique index constraint\n'
               '    """'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=460,
          lineno=112,
          tokens=87,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Check',
          body='class Check(BaseConstraint):\n'
               '    """ Constraint given as a free expression on the record '
               'fields\n'
               '    """\n'
               '\n'
               '    def __init__(self, expression):\n'
               '        BaseConstraint.__init__(self)\n'
               '        self.expression = expression\n'
               '\n'
               '    def __repr__(self):\n'
               "        return '%s.%s(%r)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               '            self.expression)'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=461,
          lineno=4,
          tokens=10,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer import utilfrom dblayer import util'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=462,
          lineno=1,
          tokens=3,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Constraint definitions\n'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=463,
          lineno=8,
          tokens=108,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for database constraints\n'
               '    # Serial number to record the order of constraint '
               'definitions# Reference to the table class containing this '
               'constraint# NOTE: Set by __new__ of the table definition '
               'class# Reference to the table instance containing this '
               'constraint or None for model constraints# NOTE: Filled in by '
               'Table.__init__ as part of cloning the constraints from the '
               'class to the instance# Name of the constraint# NOTE: Set by '
               '__new__ of the table definition class# Indicates that this '
               'model object is added implicitly by some other model object'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=464,
          lineno=35,
          tokens=14,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseConstraint can be instantiated!# Record '
               'the definition order'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=465,
          lineno=41,
          tokens=10,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='<%s Constraint: %s.%s>'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=466,
          lineno=52,
          tokens=30,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Clone this constraint for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'constraints to the table instance.\n'
               '        \n'
               '        '),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=467,
          lineno=64,
          tokens=22,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for constraints applied on a single column or a '
               'set of columns\n'
               '    # Tuple of the member columns'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=468,
          lineno=73,
          tokens=21,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseColumnConstraint can be '
               'instantiated!This constraint must be applied to at least one '
               'column!'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=469,
          lineno=79,
          tokens=13,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='<%s Constraint: %s.%s on %r>'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=470,
          lineno=98,
          tokens=5,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Primary key constraint\n    '),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=471,
          lineno=103,
          tokens=5,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Foreign key constraint\n    '),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=472,
          lineno=108,
          tokens=5,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Unique index constraint\n    '),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=473,
          lineno=113,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Constraint given as a free expression on the record fields\n'
               '    '),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=474,
          lineno=30,
          tokens=12,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='sort_key',
          body='def sort_key(obj):\n        return obj.__definition_serial__'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=475,
          lineno=33,
          tokens=49,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self):\n'
               '        assert self.__class__ is not BaseConstraint, (\n'
               "            'Only subclasses of BaseConstraint can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=476,
          lineno=40,
          tokens=45,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__str__',
          body='def __str__(self):\n'
               "        return '<%s Constraint: %s.%s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name)'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=477,
          lineno=46,
          tokens=37,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s()' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__)'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=478,
          lineno=51,
          tokens=67,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='clone',
          body='def clone(self, table):\n'
               '        """ Clone this constraint for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'constraints to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.table = table\n'
               '        return clone'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=479,
          lineno=69,
          tokens=63,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, *columns):\n'
               '        BaseConstraint.__init__(self)\n'
               '\n'
               '        assert self.__class__ is not BaseColumnConstraint, (\n'
               "            'Only subclasses of BaseColumnConstraint can be "
               "instantiated!')\n"
               '\n'
               "        assert columns, 'This constraint must be applied to at "
               "least one column!'\n"
               '        self.columns = columns'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=480,
          lineno=78,
          tokens=58,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__str__',
          body='def __str__(self):\n'
               "        return '<%s Constraint: %s.%s on %r>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name,\n'
               '            tuple(column.name for column in self.columns))'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=481,
          lineno=85,
          tokens=51,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(column.name for column in self.columns))"),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=482,
          lineno=91,
          tokens=36,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='clone',
          body='def clone(self, table):\n'
               '        clone = BaseConstraint.clone(self, table)\n'
               '        clone.columns = [getattr(table, column.name) for '
               'column in self.columns]\n'
               '        return clone'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=483,
          lineno=116,
          tokens=21,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, expression):\n'
               '        BaseConstraint.__init__(self)\n'
               '        self.expression = expression'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=484,
          lineno=120,
          tokens=43,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s(%r)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               '            self.expression)'),
 Fragment(document_cs='8fd94e2be85f341ed208bfa8471075d0334169bffbb0a44a6fb6f8e384a21a30',
          id=485,
          lineno=1,
          tokens=60,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: BaseColumnConstraint BaseConstraint Check '
               'ForeignKey PrimaryKey Unique\n'
               '  Methods: __init__ __repr__ __str__ clone sort_key\n'
               '  Variables and usages: column columns dblayer expression '
               'get_next_definition_serial getattr implicit join name rsplit '
               'staticmethod table table_class tuple update util\n'),
 Fragment(document_cs='992c01f9ce7206ff0f3854b2424b079f8cab289fd76d496e2bd5ecbae37293bb',
          id=486,
          lineno=1,
          tokens=2,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import setuptools'),
 Fragment(document_cs='992c01f9ce7206ff0f3854b2424b079f8cab289fd76d496e2bd5ecbae37293bb',
          id=487,
          lineno=12,
          tokens=158,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Database Abstraction Layer Generator\\\n'
               'Generates database abstraction layer in Python based on a\n'
               'readable definition written as Python classes. Supports\n'
               'defining of tables, basic column types, indexes,\n'
               'constraints, full text search and complex queries.\n'
               'Provides a light-weight approach of database access with\n'
               'minimal runtime overhead and without any kind of hidden\n'
               'magic, metaclasses or so. Provides maximum possible\n'
               'support for auto completion in Python IDEs.Development Status '
               ':: 3 - AlphaOperating System :: OS IndependentIntended '
               'Audience :: DevelopersLicense :: OSI Approved :: MIT '
               'LicenseTopic :: Software Development :: Libraries :: Python '
               'ModulesTopic :: Software Development :: Code Generatorspython '
               'database orm postgresql abstraction layer generator '
               'codegeneration '
               'performancehttp://code.google.com/p/dblayerdblayer.backend.basedblayer.backend.postgresql'),
 Fragment(document_cs='992c01f9ce7206ff0f3854b2424b079f8cab289fd76d496e2bd5ecbae37293bb',
          id=488,
          lineno=1,
          tokens=34,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Variables and usages: author author_email classifiers '
               'description exec include_package_data install_requires '
               'keywords license long_description name open package_data '
               'packages setup setuptools test_suite version zip_safe\n'),
 Fragment(document_cs='a1fb014a052c0eb1fd75a0e0632deb3ba6c0ea9d7aeb894f69535ccfa7fca2d2',
          id=489,
          lineno=1,
          tokens=30,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' DBLayer - Database Abstraction Layer Generator\n'
               '# FIXME: Require the first column to be the primary key one in '
               'all writable tables (not views).'),
 Fragment(document_cs='a1fb014a052c0eb1fd75a0e0632deb3ba6c0ea9d7aeb894f69535ccfa7fca2d2',
          id=490,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=491,
          lineno=14,
          tokens=50,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='SlugMixin',
          body='class SlugMixin:\n'
               '    """ Adds a slug field with the proper constraints\n'
               '    """\n'
               '    slug = column.Text(maxlength=30)\n'
               '    validate_slug = constraint.Check(function.Match(slug, '
               'constants.RXP_IDENTIFIER))\n'
               '    unique_slug = constraint.Unique(slug)'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=492,
          lineno=24,
          tokens=153,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='User',
          body='class User(table.Table):\n'
               '    """ User\n'
               '    """\n'
               '    id = column.PrimaryKey(serial=True)\n'
               '    email = column.Text(maxlength=150)\n'
               '    first_name = column.Text(maxlength=150)\n'
               '    last_name = column.Text(maxlength=150)\n'
               '    phone = column.Text(maxlength=100, null=True)\n'
               "    notes = column.Text(null=True, doc='Custom notes')\n"
               '\n'
               '    validate_email = constraint.Check(function.Match(email, '
               'constants.RXP_EMAIL))\n'
               '    unique_email = constraint.Unique(email)\n'
               '\n'
               '    real_name_index = index.Index(first_name, last_name)\n'
               '\n'
               '    full_text = column.SearchDocument(\n'
               '        expression=(email, first_name, last_name, phone, '
               'notes),\n'
               "        doc='Full text search document to find users by all of "
               "their text attributes')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=493,
          lineno=44,
          tokens=51,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Group',
          body='class Group(table.Table, SlugMixin):\n'
               '    """ Group\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               '    name = column.Text(maxlength=100)\n'
               '    unique_name = constraint.Unique(name)\n'
               "    notes = column.Text(null=True, doc='Custom notes')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=494,
          lineno=53,
          tokens=46,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='GroupUser',
          body='class GroupUser(table.Table):\n'
               '    """ User associated to group\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               '    group = column.ForeignKey(Group)\n'
               '    user = column.ForeignKey(User)\n'
               '    unique_group_user = constraint.Unique(group, user)'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=495,
          lineno=62,
          tokens=51,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Role',
          body='class Role(table.Table, SlugMixin):\n'
               '    """ Role\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               '    name = column.Text(maxlength=100)\n'
               '    unique_name = constraint.Unique(name)\n'
               "    notes = column.Text(null=True, doc='Custom notes')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=496,
          lineno=71,
          tokens=46,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='GroupRole',
          body='class GroupRole(table.Table):\n'
               '    """ Role associated to group\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               '    group = column.ForeignKey(Group)\n'
               '    role = column.ForeignKey(Role)\n'
               '    unique_group_role = constraint.Unique(group, role)'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=497,
          lineno=80,
          tokens=99,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Activation',
          body='class Activation(table.Table):\n'
               '    """ Activation attempt\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               '    user = column.ForeignKey(User)\n'
               "    secret = column.Integer(digits=30, doc='Secret activation "
               "code needs to be presented.')\n"
               "    issued = column.Datetime(doc='Timestamp of the activation "
               "e-mail sent to the user.')\n"
               "    valid_until = column.Datetime(doc='The user is deleted if "
               "not activated before this time limit.')\n"
               "    passed = column.Boolean(doc='Successful activation sets "
               "this field to True.')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=498,
          lineno=91,
          tokens=166,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Product',
          body='class Product(table.Table):\n'
               '    """ Product or service\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               "    base = column.ForeignKey(null=True, doc='Base (parent) "
               "product or service')\n"
               '    predecessor = column.ForeignKey(null=True, '
               "doc='Predecessor')\n"
               "    active = column.Boolean(default=True, doc='Only active "
               "products should be ordered')\n"
               "    model = column.Text(null=True, maxlength=50, doc='Model "
               'number or other internal product identifier for fast '
               "searching')\n"
               "    name = column.Text(maxlength=200, doc='Official name of "
               "the product')\n"
               '    unique_name = constraint.Unique(name)\n'
               "    notes = column.Text(null=True, doc='Custom notes')\n"
               "    last_modified = column.Datetime(null=True, doc='Last "
               "modification date and time')\n"
               '    set_last_modified = '
               "trigger.BeforeInsertOrUpdateRow('fn_set_last_modified')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=499,
          lineno=110,
          tokens=153,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Invoice',
          body='class Invoice(table.Table):\n'
               '    """ Invoice\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               "    serial = column.Text(maxlength=30, doc='Strictly serially "
               'incremented invoice number, generated only as the very last '
               "step.')\n"
               '    unique_serial = constraint.Unique(serial)\n'
               '    seller = column.ForeignKey(User)\n'
               '    customer = column.ForeignKey(User)\n'
               '    net_amount = column.Decimal(precision=18, scale=2)\n'
               '    vat_amount = column.Integer(digits=18, default=0)\n'
               '    gross_amount = column.Decimal(precision=18, scale=2)\n'
               '    issued_date = column.Date()\n'
               '    due_date = column.Date()\n'
               "    paid_date = column.Date(null=True, doc='Date of the last "
               'payment which was sufficient to fully pay this invoice in FIFO '
               "order.')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=500,
          lineno=126,
          tokens=184,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='InvoiceItem',
          body='class InvoiceItem(table.Table):\n'
               '    """ Service\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               "    invoice = column.ForeignKey(Invoice, doc='The invoice this "
               "item is belonging to.')\n"
               "    product = column.ForeignKey(Product, doc='Product or "
               "service sold.')\n"
               "    first_day = column.Date(null=True, doc='First day of "
               "service if applicable.')\n"
               "    last_day = column.Date(null=True, doc='Last day of service "
               "if applicable.')\n"
               '    quantity = column.Integer(digits=9, null=True, '
               "doc='Quantity sold if applicable.')\n"
               '    net_amount = column.Decimal(precision=18, scale=2)\n'
               '    vat_percent = column.Float(double=False, default=0)\n'
               '    vat_amount = column.Integer(digits=18, default=0)\n'
               '    gross_amount = column.Decimal(precision=18, scale=2)\n'
               "    notes = column.Text(null=True, maxlength=200, doc='Custom "
               "notes for this item if any.')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=501,
          lineno=142,
          tokens=114,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Payment',
          body='class Payment(table.Table):\n'
               '    """ Payment\n'
               '    """\n'
               '    id = column.PrimaryKey()\n'
               "    invoice = column.ForeignKey(Invoice, doc='Invoice this "
               "payment is for.')\n"
               "    user = column.ForeignKey(User, doc='Actual user paying for "
               "the invoice. It should match the user on the invoice.')\n"
               "    payment_date = column.Date(doc='Effective date of "
               "payment.')\n"
               "    amount = column.Integer(digits=18, doc='Amount payed. It "
               "is accounted against the gross amount of the invoice.')\n"
               '    commission_percent = column.Float(default=0.0, '
               "doc='Commission percentage')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=502,
          lineno=155,
          tokens=93,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='UserContact',
          body='class UserContact(query.Query):\n'
               '    """ Contact details of the users\n'
               '    """\n'
               '    # Source tables\n'
               '    user = User()\n'
               '\n'
               '    # Result fields\n'
               '    id = query.Result(user.id)\n'
               '    first_name = query.Result(user.first_name)\n'
               '    last_name = query.Result(user.last_name)\n'
               '    email = query.Result(user.email)\n'
               '    phone = query.Result(user.phone)\n'
               '\n'
               '    # Order by\n'
               "    _order_by = ('first_name', 'last_name')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=503,
          lineno=172,
          tokens=126,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='ProductSale',
          body='class ProductSale(query.Query):\n'
               '    """ Sales by product based on the invoices\n'
               '    """\n'
               '    # Source tables\n'
               '    sale = InvoiceItem()\n'
               '    invoice = Invoice()\n'
               '    product = Product()\n'
               '\n'
               '    # Table joins\n'
               '    invoice.join(sale.invoice)\n'
               '    product.join(sale.product)\n'
               '\n'
               '    # Result fields\n'
               '    product_id = query.Result(product.id)\n'
               '    product_model = query.Result(product.model)\n'
               '    product_name = query.Result(product.name)\n'
               '    quantity = query.Result(aggregate.Sum(sale.quantity), '
               'InvoiceItem.quantity)\n'
               '    net_amount = query.Result(aggregate.Sum(sale.net_amount), '
               'InvoiceItem.net_amount)\n'
               '  '),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=504,
          lineno=190,
          tokens=135,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='ProductSale',
          body='  vat_amount = query.Result(aggregate.Sum(sale.vat_amount), '
               'InvoiceItem.vat_amount)\n'
               '    gross_amount = '
               'query.Result(aggregate.Sum(sale.gross_amount), '
               'InvoiceItem.gross_amount)\n'
               '\n'
               '    # Conditions\n'
               '    model = query.Condition(product.model)\n'
               '    active = query.Condition(product.active)\n'
               '    seller = query.Condition(invoice.seller)\n'
               '    customer = query.Condition(invoice.customer)\n'
               '    issued_date = query.Condition(invoice.issued_date)\n'
               '\n'
               '    # Group by\n'
               '    _group_by = (product.id, product.model, product.name)\n'
               '\n'
               '    # Order by\n'
               "    _order_by = ('product_name', '+product_model', "
               "'-net_amount')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=505,
          lineno=221,
          tokens=182,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='TestDatabaseModel',
          body='class TestDatabaseModel(database.Database):\n'
               '    """ Test database model\n'
               '    """\n'
               '\n'
               '    # Tables\n'
               '    user = User()\n'
               '    # NOTE: Create twice to test single initialization in '
               '__new__\n'
               '    user = User()\n'
               '    group = Group()\n'
               '    group_user = GroupUser()\n'
               '    role = Role()\n'
               '    group_role = GroupRole()\n'
               '    activation = Activation()\n'
               '    product = Product()\n'
               '    invoice = Invoice()\n'
               '    invoice_item = InvoiceItem()\n'
               '    payment = Payment()\n'
               '\n'
               '    # Queries\n'
               '    user_contact = UserContact()\n'
               '    # NOTE: Create twice to test single initialization in '
               '__new__\n'
               '    user_contact = UserContact()\n'
               '    product_sale = ProductSale()\n'
               '\n'
               '    # Stored procedures\n'
               '    fn_set_last_modified = procedure.Procedure(\n'
               "        language='plpgsql',\n"
               '        argument_list=(),\n'
               "        result='trigger AS $$',\n"
               "        body='''\\\n"
               'new.last_modified := NOW();\n'
               'RETURN new;\n'
               "''')"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=506,
          lineno=4,
          tokens=77,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import dblayerimport dblayer.backend.postgresqlfrom '
               'dblayer.model import database, table, column, index, '
               'constraintfrom dblayer.model import database, table, column, '
               'index, constraintfrom dblayer.model import query, aggregate, '
               'function, trigger, procedurefrom dblayer.model import query, '
               'aggregate, function, trigger, procedurefrom dblayer.test '
               'import constantsfrom dblayer.test import constants'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=507,
          lineno=1,
          tokens=9,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Data model used for the unit test cases\n'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=508,
          lineno=15,
          tokens=10,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Adds a slug field with the proper constraints\n    '),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=509,
          lineno=41,
          tokens=13,
          depth=8,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Full text search document to find users by all of their text '
               'attributes'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=510,
          lineno=54,
          tokens=6,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' User associated to group\n    '),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=511,
          lineno=72,
          tokens=6,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Role associated to group\n    '),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=512,
          lineno=81,
          tokens=41,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Activation attempt\n'
               '    Secret activation code needs to be presented.Timestamp of '
               'the activation e-mail sent to the user.The user is deleted if '
               'not activated before this time limit.Successful activation '
               'sets this field to True.'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=513,
          lineno=92,
          tokens=42,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Product or service\n'
               '    Base (parent) product or serviceOnly active products '
               'should be orderedModel number or other internal product '
               'identifier for fast searchingOfficial name of the productLast '
               'modification date and timefn_set_last_modified'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=514,
          lineno=114,
          tokens=32,
          depth=8,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Strictly serially incremented invoice number, generated only '
               'as the very last step.Date of the last payment which was '
               'sufficient to fully pay this invoice in FIFO order.'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=515,
          lineno=130,
          tokens=35,
          depth=8,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='The invoice this item is belonging to.Product or service '
               'sold.First day of service if applicable.Last day of service if '
               'applicable.Quantity sold if applicable.Custom notes for this '
               'item if any.'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=516,
          lineno=146,
          tokens=43,
          depth=8,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Invoice this payment is for.Actual user paying for the '
               'invoice. It should match the user on the invoice.Effective '
               'date of payment.Amount payed. It is accounted against the '
               'gross amount of the invoice.Commission percentage'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=517,
          lineno=156,
          tokens=7,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Contact details of the users\n    '),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=518,
          lineno=173,
          tokens=64,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Sales by product based on the invoices\n'
               '    ##class InvoicePaymentView(view.View):##    """ Total '
               'payments by invoice##class ProductIncomeView(view.View):##    '
               '""" Actual income by product based both on the invoices and '
               'the payments##class UserPaymentView(view.View):##    """ Total '
               'income and debt per user'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=519,
          lineno=222,
          tokens=46,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Test database model\n'
               '    # NOTE: Create twice to test single initialization in '
               '__new__# NOTE: Create twice to test single initialization in '
               '__new__\\\n'
               'new.last_modified := NOW();\n'
               'RETURN new;\n'
               '### Generate database abstraction layer'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=520,
          lineno=262,
          tokens=13,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# NOTE: Create twice to test single initialization in __new__'),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=521,
          lineno=258,
          tokens=106,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='generate',
          body="def generate(module_path='abstraction.py',\n"
               '             database_model_class=TestDatabaseModel,\n'
               "             abstraction_class_name='TestDatabase'):\n"
               '    test_database_model = '
               'database_model_class(abstraction_class_name)\n'
               '    # NOTE: Create twice to test single initialization in '
               '__new__\n'
               '    test_database_model = '
               'database_model_class(abstraction_class_name)\n'
               '    source = '
               'test_database_model.generate(dblayer.backend.postgresql)\n'
               "    with open(module_path, 'wt') as module_file:\n"
               "        module_file.write(source.replace('\\r\\n', '\\n'))"),
 Fragment(document_cs='a91444ee6997608a80333b86672f6ec376739d770e411e757e1f7f1cd5003976',
          id=522,
          lineno=1,
          tokens=230,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Functions: generate\n'
               '  Classes: Activation Group GroupRole GroupUser Invoice '
               'InvoiceItem Payment Product ProductSale Role SlugMixin '
               'TestDatabaseModel User UserContact\n'
               '  Variables and usages: BeforeInsertOrUpdateRow Boolean Check '
               'Condition Database Date Datetime Decimal Float ForeignKey '
               'Index Integer Match PrimaryKey Procedure Query RXP_EMAIL '
               'RXP_IDENTIFIER Result SearchDocument Sum Table Text Unique '
               '_group_by _order_by abstraction_class_name activation active '
               'aggregate amount argument_list backend base body column '
               'commission_percent constants constraint customer database '
               'database_model_class dblayer default digits double due_date '
               'email expression first_day first_name fn_set_last_modified '
               'full_text function gross_amount group group_role group_user '
               'index invoice invoice_item issued issued_date join language '
               'last_day last_modified last_name maxlength model module_file '
               'module_path name net_amount notes null open paid_date passed '
               'payment payment_date phone postgresql precision predecessor '
               'procedure product product_id product_model product_name '
               'product_sale quantity query real_name_index '
               'referenced_table_class replace result role sale scale secret '
               'seller serial set_last_modified slug source table test '
               'test_database_model trigger unique_email unique_group_role '
               'unique_group_user unique_name unique_serial unique_slug user '
               'user_contact valid_until validate_email validate_slug '
               'vat_amount vat_percent write\n'),
 Fragment(document_cs='a9a3d71d8635cb81ed0958d57e37488133eafadf085b86d00a83054dbda31070',
          id=523,
          lineno=12,
          tokens=245,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='GMLExporter',
          body='class GMLExporter:\n'
               '\n'
               '    def __init__(self, model):\n'
               '        assert isinstance(model, database.Database)\n'
               '        self.model = model\n'
               '\n'
               '    def export(self, filepath):\n'
               '\n'
               '        model = self.model\n'
               '        assert isinstance(model, database.Database)\n'
               '\n'
               '        g = networkx.MultiDiGraph()\n'
               '\n'
               '        for table in model._table_list:\n'
               '            if 0:\n'
               '                assert isinstance(table, table_model.Table)\n'
               '            title = table._name.upper()\n'
               '            column_label_list = [\n'
               "                '%s:%s%s%s' % (\n"
               '                    column.name,\n'
               '                    column.__class__.__name__,\n'
               "                    ' NULL' if column.null else '',\n"
               "                    '->' if isinstance(column, "
               "column_model.ForeignKey) else '')\n"
               '                for column in table._column_list]\n'
               "            label = '%s\\n\\n%s' % (title, "
               "'\\n'.join(column_label_list))\n"
               '            g.add_node(id(table), label=label)\n'
               '\n'
               '        for table in model._table_list:\n'
               '            for fk_column in table._column_list:\n'
               '                if isinstance(fk_column, '
               'column_model.ForeignKey):\n'
               '                    g.add_edge(\n'
               '                        id(table),\n'
               '                        id(fk_column.referenced_table),\n'
               '                        label=fk_column.name)\n'
               '\n'
               '        networkx.write_gml(g, filepath)'),
 Fragment(document_cs='a9a3d71d8635cb81ed0958d57e37488133eafadf085b86d00a83054dbda31070',
          id=524,
          lineno=7,
          tokens=36,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import networkxfrom dblayer.model import database, table as '
               'table_model, column as column_modelfrom dblayer.model import '
               'database, table as table_model, column as column_model'),
 Fragment(document_cs='a9a3d71d8635cb81ed0958d57e37488133eafadf085b86d00a83054dbda31070',
          id=525,
          lineno=1,
          tokens=26,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Helpers to export the database graph in GraphML format\n'
               '\n'
               'Requires the NetworkX library: http://networkx.lanl.gov/\n'
               '\n'),
 Fragment(document_cs='a9a3d71d8635cb81ed0958d57e37488133eafadf085b86d00a83054dbda31070',
          id=526,
          lineno=14,
          tokens=21,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, model):\n'
               '        assert isinstance(model, database.Database)\n'
               '        self.model = model'),
 Fragment(document_cs='a9a3d71d8635cb81ed0958d57e37488133eafadf085b86d00a83054dbda31070',
          id=527,
          lineno=18,
          tokens=216,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='export',
          body='def export(self, filepath):\n'
               '\n'
               '        model = self.model\n'
               '        assert isinstance(model, database.Database)\n'
               '\n'
               '        g = networkx.MultiDiGraph()\n'
               '\n'
               '        for table in model._table_list:\n'
               '            if 0:\n'
               '                assert isinstance(table, table_model.Table)\n'
               '            title = table._name.upper()\n'
               '            column_label_list = [\n'
               "                '%s:%s%s%s' % (\n"
               '                    column.name,\n'
               '                    column.__class__.__name__,\n'
               "                    ' NULL' if column.null else '',\n"
               "                    '->' if isinstance(column, "
               "column_model.ForeignKey) else '')\n"
               '                for column in table._column_list]\n'
               "            label = '%s\\n\\n%s' % (title, "
               "'\\n'.join(column_label_list))\n"
               '            g.add_node(id(table), label=label)\n'
               '\n'
               '        for table in model._table_list:\n'
               '            for fk_column in table._column_list:\n'
               '                if isinstance(fk_column, '
               'column_model.ForeignKey):\n'
               '                    g.add_edge(\n'
               '                        id(table),\n'
               '                        id(fk_column.referenced_table),\n'
               '                        label=fk_column.name)\n'
               '\n'
               '        networkx.write_gml(g, filepath)'),
 Fragment(document_cs='a9a3d71d8635cb81ed0958d57e37488133eafadf085b86d00a83054dbda31070',
          id=528,
          lineno=1,
          tokens=69,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: GMLExporter\n'
               '  Methods: __init__ export\n'
               '  Variables and usages: Database ForeignKey MultiDiGraph Table '
               '_column_list _name _table_list add_edge add_node column '
               'column_label_list column_model database dblayer filepath '
               'fk_column join label model name networkx null referenced_table '
               'table table_model title upper write_gml\n'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=529,
          lineno=15,
          tokens=181,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Database',
          body='class Database:\n'
               '    """ Base class for database models\n'
               '    """\n'
               '\n'
               '    # Flag indicating that the model has been initialized\n'
               '    _initialized = False\n'
               '\n'
               '    # List of initialized table models in the database\n'
               '    _table_list = ()\n'
               '\n'
               '    # List of initialized stored procedure definitions in the '
               'database\n'
               '    _procedure_list = ()\n'
               '\n'
               '    # Name of the abstraction layer class\n'
               "    _abstraction_class_name = ''\n"
               '\n'
               '    def __new__(cls, *args, **kws):\n'
               '        # Initialize the class only once\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               '        return super(Database, cls).__new__(cls)\n'
               '\n'
               '    @classmethod\n'
               '    def initialize(cls):\n'
               '        """ Initialize the model objects and resolve all '
               'cross-dependencies\n'
               '        """\n'
               '        cls._initialized = True\n'
               '\n'
               '        # Assign name to tables and collect them\n'
               '        cls._table_list = []\n'
               '        cls._procedure_list = []\n'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=530,
          lineno=47,
          tokens=224,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Database',
          body='        for name in dir(cls):\n'
               '            value = getattr(cls, name)\n'
               '\n'
               '            if isinstance(value, table.Table):\n'
               "                assert value._database_class is None, 'Table "
               "already bound to a database class!'\n"
               '                value.__class__._table_name = name\n'
               '                value._name = name\n'
               '                value._database_class = cls\n'
               '                cls._table_list.append(value)\n'
               '\n'
               '            elif isinstance(value, procedure.BaseProcedure):\n'
               '                value.name = name\n'
               '                value.database_class = cls\n'
               '                cls._procedure_list.append(value)\n'
               '\n'
               '        # Sort them by definition order\n'
               '        cls._table_list.sort(key=table.Table._sort_key)\n'
               '        '
               'cls._procedure_list.sort(key=procedure.Procedure.sort_key)\n'
               '\n'
               '        # Connect all foreign keys by looking up the '
               'referenced tables\n'
               '        table_map = dict(\n'
               '            (table_instance.__class__.__name__, '
               'table_instance)\n'
               '            for table_instance in cls._table_list)\n'
               '        assert len(table_map) == len(cls._table_list), (\n'
               "            'Some of the table classes were used more than "
               "once to construct the database model!')\n"
               '        for table_instance in cls._table_list:\n'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=531,
          lineno=73,
          tokens=232,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Database',
          body='            for fk_column in table_instance._column_list:\n'
               '                if isinstance(fk_column, column.ForeignKey):\n'
               '                    referenced_table = '
               'table_map.get(fk_column.referenced_table_class.__name__)\n'
               '                    assert referenced_table, (\n'
               "                            'Could not find referenced "
               "database table for foreign key: %s.%s' %\n"
               '                            '
               '(table_instance.__class__.__name__, fk_column.name))\n'
               '                    fk_column.referenced_table = '
               'referenced_table\n'
               '\n'
               '    def __init__(self, abstraction_class_name):\n'
               '        self._abstraction_class_name = abstraction_class_name\n'
               '\n'
               '    def __str__(self):\n'
               "        return '<%s Database>' % self.__class__.__name__\n"
               '\n'
               '    def __repr__(self):\n'
               "        return '%s.%s(%r)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               '            self._abstraction_class_name)\n'
               '\n'
               '    def generate(self, backend, options=None):\n'
               '        """ Generate database abstraction layer module for use '
               'with the given\n'
               '        database server specific backend module\n'
               '        """\n'
               '        return generator.generate(self, backend, '
               'self._abstraction_class_name, options)\n'
               '\n'
               '    @classmethod\n'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=532,
          lineno=100,
          tokens=216,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Database',
          body='    def pretty_format_class(cls):\n'
               '        """ Formats source code defining the database model, '
               'including all the tables used in it\n'
               '        """\n'
               '        # Initialize the class only once\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               "        line_list = '''\\\n"
               'import dblayer\n'
               'import dblayer.backend.postgresql\n'
               'from dblayer.model import database, table, query\n'
               'from dblayer.model import column, index, constraint, '
               'aggregate, function, trigger, procedure\n'
               "'''.split('\\n')\n"
               '        append_line = line_list.append\n'
               '\n'
               '        for obj in cls._table_list:\n'
               '            assert isinstance(obj, table.Table)\n'
               '            append_line(obj.__class__.pretty_format_class())\n'
               "            append_line('')\n"
               '\n'
               "        append_line('class %s(database.Database):' % "
               'cls.__name__)\n'
               '\n'
               '        if cls.__doc__:\n'
               "            if '\\n' in cls.__doc__:\n"
               '                append_line(\'    """%s"""\' % cls.__doc__)\n'
               '            else:\n'
               '                append_line(\'    """ %s """\' % '
               'cls.__doc__.strip())\n'
               '        else:\n'
               "            append_line('')\n"),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=533,
          lineno=129,
          tokens=87,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Database',
          body='\n'
               '        for obj in cls._table_list:\n'
               '            assert isinstance(obj, table.Table)\n'
               "            append_line('    %s = %s()' % (obj._name, "
               'obj.__class__.__name__))\n'
               '\n'
               '        for obj in cls._procedure_list:\n'
               '            assert isinstance(obj, procedure.Procedure)\n'
               "            append_line('    %s = %r' % (obj.name, obj))\n"
               '\n'
               "        return '\\n'.join(line_list)"),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=534,
          lineno=11,
          tokens=32,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer.generator import generatorfrom dblayer.generator '
               'import generatorfrom dblayer.model import table, column, '
               'procedurefrom dblayer.model import table, column, procedure'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=535,
          lineno=1,
          tokens=70,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for database models\n'
               '\n'
               'Database models are used to collect the tables, views and '
               'queries building\n'
               'up a single database or schema. It is used to generate the '
               'code for the\n'
               'database abstraction layer used by the actual application. It '
               'is not used\n'
               'directly to access the database, it only represents the model '
               'of the database\n'
               'or schema.\n'
               '\n'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=536,
          lineno=16,
          tokens=42,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for database models\n'
               '    # Flag indicating that the model has been initialized# '
               'List of initialized table models in the database# List of '
               'initialized stored procedure definitions in the database# Name '
               'of the abstraction layer class'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=537,
          lineno=32,
          tokens=6,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Initialize the class only once'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=538,
          lineno=40,
          tokens=75,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Initialize the model objects and resolve all '
               'cross-dependencies\n'
               '        # Assign name to tables and collect themTable already '
               'bound to a database class!# Sort them by definition order# '
               'Connect all foreign keys by looking up the referenced '
               'tablesSome of the table classes were used more than once to '
               'construct the database model!Could not find referenced '
               'database table for foreign key: %s.%s'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=539,
          lineno=94,
          tokens=19,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Generate database abstraction layer module for use with the '
               'given\n'
               '        database server specific backend module\n'
               '        '),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=540,
          lineno=101,
          tokens=71,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats source code defining the database model, including '
               'all the tables used in it\n'
               '        # Initialize the class only once\\\n'
               'import dblayer\n'
               'import dblayer.backend.postgresql\n'
               'from dblayer.model import database, table, query\n'
               'from dblayer.model import column, index, constraint, '
               'aggregate, function, trigger, procedure\n'
               'class %s(database.Database):'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=541,
          lineno=31,
          tokens=43,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__new__',
          body='def __new__(cls, *args, **kws):\n'
               '        # Initialize the class only once\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               '        return super(Database, cls).__new__(cls)'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=542,
          lineno=39,
          tokens=222,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='initialize',
          body='def initialize(cls):\n'
               '        """ Initialize the model objects and resolve all '
               'cross-dependencies\n'
               '        """\n'
               '        cls._initialized = True\n'
               '\n'
               '        # Assign name to tables and collect them\n'
               '        cls._table_list = []\n'
               '        cls._procedure_list = []\n'
               '        for name in dir(cls):\n'
               '            value = getattr(cls, name)\n'
               '\n'
               '            if isinstance(value, table.Table):\n'
               "                assert value._database_class is None, 'Table "
               "already bound to a database class!'\n"
               '                value.__class__._table_name = name\n'
               '                value._name = name\n'
               '                value._database_class = cls\n'
               '                cls._table_list.append(value)\n'
               '\n'
               '            elif isinstance(value, procedure.BaseProcedure):\n'
               '                value.name = name\n'
               '                value.database_class = cls\n'
               '                cls._procedure_list.append(value)\n'
               '\n'
               '        # Sort them by definition order\n'
               '        cls._table_list.sort(key=table.Table._sort_key)\n'
               '        '
               'cls._procedure_list.sort(key=procedure.Procedure.sort_key)\n'
               '\n'
               '        # Connect all foreign keys by looking up the '
               'referenced tables\n'
               '        table_map = dict(\n'
               '            (table_instance.__class__.__name__, '
               'table_instance)\n'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=543,
          lineno=69,
          tokens=138,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='initialize',
          body='            for table_instance in cls._table_list)\n'
               '        assert len(table_map) == len(cls._table_list), (\n'
               "            'Some of the table classes were used more than "
               "once to construct the database model!')\n"
               '        for table_instance in cls._table_list:\n'
               '            for fk_column in table_instance._column_list:\n'
               '                if isinstance(fk_column, column.ForeignKey):\n'
               '                    referenced_table = '
               'table_map.get(fk_column.referenced_table_class.__name__)\n'
               '                    assert referenced_table, (\n'
               "                            'Could not find referenced "
               "database table for foreign key: %s.%s' %\n"
               '                            '
               '(table_instance.__class__.__name__, fk_column.name))\n'
               '                    fk_column.referenced_table = '
               'referenced_table'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=544,
          lineno=81,
          tokens=21,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, abstraction_class_name):\n'
               '        self._abstraction_class_name = abstraction_class_name'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=545,
          lineno=84,
          tokens=20,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__str__',
          body='def __str__(self):\n'
               "        return '<%s Database>' % self.__class__.__name__"),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=546,
          lineno=87,
          tokens=47,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s(%r)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               '            self._abstraction_class_name)'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=547,
          lineno=93,
          tokens=48,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='generate',
          body='def generate(self, backend, options=None):\n'
               '        """ Generate database abstraction layer module for use '
               'with the given\n'
               '        database server specific backend module\n'
               '        """\n'
               '        return generator.generate(self, backend, '
               'self._abstraction_class_name, options)'),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=548,
          lineno=100,
          tokens=215,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='pretty_format_class',
          body='def pretty_format_class(cls):\n'
               '        """ Formats source code defining the database model, '
               'including all the tables used in it\n'
               '        """\n'
               '        # Initialize the class only once\n'
               '        if not cls._initialized:\n'
               '            cls.initialize()\n'
               '\n'
               "        line_list = '''\\\n"
               'import dblayer\n'
               'import dblayer.backend.postgresql\n'
               'from dblayer.model import database, table, query\n'
               'from dblayer.model import column, index, constraint, '
               'aggregate, function, trigger, procedure\n'
               "'''.split('\\n')\n"
               '        append_line = line_list.append\n'
               '\n'
               '        for obj in cls._table_list:\n'
               '            assert isinstance(obj, table.Table)\n'
               '            append_line(obj.__class__.pretty_format_class())\n'
               "            append_line('')\n"
               '\n'
               "        append_line('class %s(database.Database):' % "
               'cls.__name__)\n'
               '\n'
               '        if cls.__doc__:\n'
               "            if '\\n' in cls.__doc__:\n"
               '                append_line(\'    """%s"""\' % cls.__doc__)\n'
               '            else:\n'
               '                append_line(\'    """ %s """\' % '
               'cls.__doc__.strip())\n'
               '        else:\n'
               "            append_line('')\n"),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=549,
          lineno=129,
          tokens=87,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='pretty_format_class',
          body='\n'
               '        for obj in cls._table_list:\n'
               '            assert isinstance(obj, table.Table)\n'
               "            append_line('    %s = %s()' % (obj._name, "
               'obj.__class__.__name__))\n'
               '\n'
               '        for obj in cls._procedure_list:\n'
               '            assert isinstance(obj, procedure.Procedure)\n'
               "            append_line('    %s = %r' % (obj.name, obj))\n"
               '\n'
               "        return '\\n'.join(line_list)"),
 Fragment(document_cs='adf6df94dcc6d67b7d478d696faba2d31d5844b0e4540ba9184e42598c596b24',
          id=550,
          lineno=1,
          tokens=109,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: Database\n'
               '  Methods: __init__ __new__ __repr__ __str__ generate '
               'initialize pretty_format_class\n'
               '  Variables and usages: BaseProcedure ForeignKey Procedure '
               'Table _abstraction_class_name _column_list _database_class '
               '_initialized _name _procedure_list _sort_key _table_list '
               '_table_name abstraction_class_name append append_line args '
               'backend classmethod column database_class dblayer fk_column '
               'generator getattr join line_list model name options procedure '
               'referenced_table referenced_table_class rsplit sort sort_key '
               'split strip table table_instance table_map value\n'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=551,
          lineno=5,
          tokens=130,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseFunction',
          body='class BaseFunction:\n'
               '    """ Base class for functions\n'
               '    """\n'
               '\n'
               '    def __init__(self, *args):\n'
               '        self.args = args\n'
               '\n'
               '        assert self.__class__ is not BaseFunction, (\n'
               "            'Only subclasses of BaseFunction can be "
               "instantiated!')\n"
               '\n'
               '    def __str__(self):\n'
               "        return '<%s%r>' % (self.__class__.__name__, "
               'tuple(self.args))\n'
               '\n'
               '    def __repr__(self):\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(map(repr, self.args)))"),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=552,
          lineno=27,
          tokens=31,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Custom',
          body='class Custom(BaseFunction):\n'
               '    """ Custom function\n'
               '    \n'
               "    It is useful for inspected databases, where we don't have "
               'expressions in parsed format.\n'
               '    \n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=553,
          lineno=37,
          tokens=41,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Var',
          body='class Var(BaseFunction):\n'
               '    """ Variable reference\n'
               '    \n'
               '    It is useful for triggers and domains, where the variable '
               'name\n'
               '    is determined by the SQL server ("new" or "value").\n'
               '    \n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=554,
          lineno=48,
          tokens=40,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Not',
          body='class Not(BaseFunction):\n'
               '    """ Logical NOT of its parameters\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a):\n'
               '        BaseFunction.__init__(self, a)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=555,
          lineno=59,
          tokens=21,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='And',
          body='class And(BaseFunction):\n'
               '    """ Logical AND of its parameters\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=556,
          lineno=67,
          tokens=21,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Or',
          body='class Or(BaseFunction):\n'
               '    """ Logical OR of its parameters\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=557,
          lineno=77,
          tokens=46,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Equal',
          body='class Equal(BaseFunction):\n'
               '    """ True if its two parameters are equal\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=558,
          lineno=88,
          tokens=48,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='NotEqual',
          body='class NotEqual(BaseFunction):\n'
               '    """ True if its two parameters are not equal\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=559,
          lineno=99,
          tokens=51,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='LessThan',
          body='class LessThan(BaseFunction):\n'
               '    """ True if the first parameter is less than the second '
               'one\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=560,
          lineno=110,
          tokens=54,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='LessThanOrEqual',
          body='class LessThanOrEqual(BaseFunction):\n'
               '    """ True if the first parameter is less or equal than the '
               'second one\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=561,
          lineno=121,
          tokens=51,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='GreaterThan',
          body='class GreaterThan(BaseFunction):\n'
               '    """ True if the first parameter is greater than the second '
               'one\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=562,
          lineno=132,
          tokens=54,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='GreaterThanOrEqual',
          body='class GreaterThanOrEqual(BaseFunction):\n'
               '    """ True if the first parameter is greater than or equal '
               'the second one\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=563,
          lineno=143,
          tokens=55,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='In',
          body='class In(BaseFunction):\n'
               '    """ True if its first parameter is in member of the '
               'expression passed as its second parameter\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=564,
          lineno=154,
          tokens=56,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='NotIn',
          body='class NotIn(BaseFunction):\n'
               '    """ True if its first parameter is in member of the '
               'expression passed as its second parameter\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=565,
          lineno=167,
          tokens=35,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Neg',
          body='class Neg(BaseFunction):\n'
               '    """ Negate a single numeric value\n'
               '    """\n'
               '\n'
               '    def __init__(self, a):\n'
               '        BaseFunction.__init__(self, a)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=566,
          lineno=175,
          tokens=16,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Add',
          body='class Add(BaseFunction):\n'
               '    """ Add any number of numeric values\n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=567,
          lineno=180,
          tokens=20,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Sub',
          body='class Sub(BaseFunction):\n'
               '    """ Subtract any number of numeric values from the first '
               'one\n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=568,
          lineno=185,
          tokens=16,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Mul',
          body='class Mul(BaseFunction):\n'
               '    """ Multiply any number of numeric values\n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=569,
          lineno=190,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Div',
          body='class Div(BaseFunction):\n'
               '    """ Divide the first numeric value with the subsequent '
               'ones\n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=570,
          lineno=199,
          tokens=29,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Concat',
          body='class Concat(BaseFunction):\n'
               '    """ Concatenates any number of values, also converts them '
               'to strings\n'
               '    \n'
               '    Returns a string.\n'
               '    \n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=571,
          lineno=207,
          tokens=52,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Left',
          body='class Left(BaseFunction):\n'
               '    """ Take the leftmost characters of a string (string, '
               'count)\n'
               '    \n'
               '    Returns a string.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, text, length):\n'
               '        BaseFunction.__init__(self, text, length)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=572,
          lineno=218,
          tokens=52,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Right',
          body='class Right(BaseFunction):\n'
               '    """ Take the rightmost characters of a string (string, '
               'count)\n'
               '    \n'
               '    Returns a string.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, text, length):\n'
               '        BaseFunction.__init__(self, text, length)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=573,
          lineno=229,
          tokens=76,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Substring',
          body='class Substring(BaseFunction):\n'
               '    """ Extract substring (string, first_character[, count])\n'
               '    \n'
               '    Returns a string.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, text, position, length=None):\n'
               '        if length is None:\n'
               '            BaseFunction.__init__(self, text, position)\n'
               '        else:\n'
               '            BaseFunction.__init__(self, text, position, '
               'length)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=574,
          lineno=243,
          tokens=46,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Contains',
          body='class Contains(BaseFunction):\n'
               '    """ Checks whether a substring is in text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, text, substring):\n'
               '        BaseFunction.__init__(self, text, substring)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=575,
          lineno=254,
          tokens=46,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Like',
          body='class Like(BaseFunction):\n'
               '    """ Checks whether a LIKE pattern matches text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, text, pattern):\n'
               '        BaseFunction.__init__(self, text, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=576,
          lineno=265,
          tokens=49,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='NotLike',
          body='class NotLike(BaseFunction):\n'
               '    """ Checks whether a LIKE pattern does not match text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, text, pattern):\n'
               '        BaseFunction.__init__(self, text, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=577,
          lineno=276,
          tokens=46,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Match',
          body='class Match(BaseFunction):\n'
               '    """ Checks whether a regular expression matches text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, text, pattern):\n'
               '        BaseFunction.__init__(self, text, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=578,
          lineno=287,
          tokens=50,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='NotMatch',
          body='class NotMatch(BaseFunction):\n'
               '    """ Checks whether a regular expression does not matche '
               'text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, text, pattern):\n'
               '        BaseFunction.__init__(self, text, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=579,
          lineno=298,
          tokens=102,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='FullTextSearch',
          body='class FullTextSearch(BaseFunction):\n'
               '    """ Performs full text search\n'
               '    \n'
               '    For optimal performance the expression should be a column '
               'with a \n'
               '    full text search index on it, but it also works for any '
               'expression\n'
               '    resulting in a string or a value can be converted to a '
               'string.\n'
               '    \n'
               '    The pattern is like: word1 & word2\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    """\n'
               '\n'
               '    def __init__(self, column, pattern):\n'
               '        BaseFunction.__init__(self, column, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=580,
          lineno=317,
          tokens=25,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Coalesce',
          body='class Coalesce(BaseFunction):\n'
               '    """ Results in the first not-NULL expression or NULL if '
               'all are NULL\n'
               '    """'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=581,
          lineno=1,
          tokens=10,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Functions can be used in result expressions of queries\n'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=582,
          lineno=6,
          tokens=6,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for functions\n    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=583,
          lineno=13,
          tokens=9,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseFunction can be instantiated!'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=584,
          lineno=28,
          tokens=23,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Custom function\n'
               '    \n'
               "    It is useful for inspected databases, where we don't have "
               'expressions in parsed format.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=585,
          lineno=38,
          tokens=33,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Variable reference\n'
               '    \n'
               '    It is useful for triggers and domains, where the variable '
               'name\n'
               '    is determined by the SQL server ("new" or "value").\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=586,
          lineno=49,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Logical NOT of its parameters\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=587,
          lineno=60,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Logical AND of its parameters\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=588,
          lineno=68,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Logical OR of its parameters\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=589,
          lineno=78,
          tokens=15,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' True if its two parameters are equal\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=590,
          lineno=89,
          tokens=16,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' True if its two parameters are not equal\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=591,
          lineno=100,
          tokens=19,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' True if the first parameter is less than the second one\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=592,
          lineno=111,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' True if the first parameter is less or equal than the second '
               'one\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=593,
          lineno=122,
          tokens=19,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' True if the first parameter is greater than the second one\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=594,
          lineno=133,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' True if the first parameter is greater than or equal the '
               'second one\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=595,
          lineno=144,
          tokens=24,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' True if its first parameter is in member of the expression '
               'passed as its second parameter\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=596,
          lineno=155,
          tokens=24,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' True if its first parameter is in member of the expression '
               'passed as its second parameter\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=597,
          lineno=168,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Negate a single numeric value\n    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=598,
          lineno=176,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Add any number of numeric values\n    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=599,
          lineno=181,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Subtract any number of numeric values from the first one\n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=600,
          lineno=186,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Multiply any number of numeric values\n    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=601,
          lineno=191,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Divide the first numeric value with the subsequent ones\n'
               '    # TODO: Pow, Exp, Log, ...'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=602,
          lineno=200,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Concatenates any number of values, also converts them to '
               'strings\n'
               '    \n'
               '    Returns a string.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=603,
          lineno=208,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Take the leftmost characters of a string (string, count)\n'
               '    \n'
               '    Returns a string.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=604,
          lineno=219,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Take the rightmost characters of a string (string, count)\n'
               '    \n'
               '    Returns a string.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=605,
          lineno=230,
          tokens=18,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Extract substring (string, first_character[, count])\n'
               '    \n'
               '    Returns a string.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=606,
          lineno=244,
          tokens=15,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Checks whether a substring is in text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=607,
          lineno=255,
          tokens=15,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Checks whether a LIKE pattern matches text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=608,
          lineno=266,
          tokens=17,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Checks whether a LIKE pattern does not match text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=609,
          lineno=277,
          tokens=15,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Checks whether a regular expression matches text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=610,
          lineno=288,
          tokens=18,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Checks whether a regular expression does not matche text\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=611,
          lineno=299,
          tokens=69,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Performs full text search\n'
               '    \n'
               '    For optimal performance the expression should be a column '
               'with a \n'
               '    full text search index on it, but it also works for any '
               'expression\n'
               '    resulting in a string or a value can be converted to a '
               'string.\n'
               '    \n'
               '    The pattern is like: word1 & word2\n'
               '    \n'
               '    Returns a boolean.\n'
               '    \n'
               '    '),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=612,
          lineno=318,
          tokens=26,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Results in the first not-NULL expression or NULL if all are '
               'NULL\n'
               '    # TODO: If-Else, Case-Else'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=613,
          lineno=9,
          tokens=39,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, *args):\n'
               '        self.args = args\n'
               '\n'
               '        assert self.__class__ is not BaseFunction, (\n'
               "            'Only subclasses of BaseFunction can be "
               "instantiated!')"),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=614,
          lineno=15,
          tokens=26,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__str__',
          body='def __str__(self):\n'
               "        return '<%s%r>' % (self.__class__.__name__, "
               'tuple(self.args))'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=615,
          lineno=18,
          tokens=50,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(map(repr, self.args)))"),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=616,
          lineno=55,
          tokens=18,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a):\n        BaseFunction.__init__(self, a)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=617,
          lineno=84,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=618,
          lineno=95,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=619,
          lineno=106,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=620,
          lineno=117,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=621,
          lineno=128,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=622,
          lineno=139,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=623,
          lineno=150,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=624,
          lineno=161,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a, b):\n'
               '        BaseFunction.__init__(self, a, b)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=625,
          lineno=171,
          tokens=18,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, a):\n        BaseFunction.__init__(self, a)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=626,
          lineno=214,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, text, length):\n'
               '        BaseFunction.__init__(self, text, length)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=627,
          lineno=225,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, text, length):\n'
               '        BaseFunction.__init__(self, text, length)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=628,
          lineno=236,
          tokens=48,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, text, position, length=None):\n'
               '        if length is None:\n'
               '            BaseFunction.__init__(self, text, position)\n'
               '        else:\n'
               '            BaseFunction.__init__(self, text, position, '
               'length)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=629,
          lineno=250,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, text, substring):\n'
               '        BaseFunction.__init__(self, text, substring)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=630,
          lineno=261,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, text, pattern):\n'
               '        BaseFunction.__init__(self, text, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=631,
          lineno=272,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, text, pattern):\n'
               '        BaseFunction.__init__(self, text, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=632,
          lineno=283,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, text, pattern):\n'
               '        BaseFunction.__init__(self, text, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=633,
          lineno=294,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, text, pattern):\n'
               '        BaseFunction.__init__(self, text, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=634,
          lineno=311,
          tokens=22,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, column, pattern):\n'
               '        BaseFunction.__init__(self, column, pattern)'),
 Fragment(document_cs='b2446f64e32fbe3d2af67a1f4e14d2481b051d343890a408eda30d6400f0130c',
          id=635,
          lineno=1,
          tokens=80,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: Add And BaseFunction Coalesce Concat Contains '
               'Custom Div Equal FullTextSearch GreaterThan GreaterThanOrEqual '
               'In Left LessThan LessThanOrEqual Like Match Mul Neg Not '
               'NotEqual NotIn NotLike NotMatch Or Right Sub Substring Var\n'
               '  Methods: __init__ __repr__ __str__\n'
               '  Variables and usages: args column join length pattern '
               'position repr rsplit substring text tuple\n'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=636,
          lineno=7,
          tokens=190,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseIndex',
          body='class BaseIndex:\n'
               '    """ Base class for database indexes models\n'
               '    """\n'
               '\n'
               '    # Serial number to record the order of column definitions\n'
               '    __definition_serial__ = 0\n'
               '\n'
               '    # Reference to the table class containing this column\n'
               '    # NOTE: Set by __new__ of the table definition class\n'
               '    table_class = None\n'
               '\n'
               '    # Reference to the table instance containing this column '
               'or None for model columns\n'
               '    # NOTE: Filled in by Table.__init__ as part of cloning the '
               'columns from the class to the instance\n'
               '    table = None\n'
               '\n'
               '    # Name of the constraint\n'
               '    # NOTE: Set by __new__ in the table definition class\n'
               "    name = ''\n"
               '\n'
               '    # List of the member columns\n'
               '    columns = ()\n'
               '\n'
               '    # Indicates that this model object is added implicitly by '
               'some other model object\n'
               '    implicit = False\n'
               '\n'
               '    @staticmethod\n'
               '    def sort_key(obj):\n'
               '        return obj.__definition_serial__\n'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=637,
          lineno=35,
          tokens=193,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseIndex',
          body='\n'
               '    def __init__(self, *columns):\n'
               '        assert self.__class__ is not BaseIndex, (\n'
               "            'Only subclasses of BaseIndex can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        # Verify\n'
               "        assert columns, 'This index must be applied to at "
               "least one column!'\n"
               '        self.columns = columns\n'
               '\n'
               '    def __str__(self):\n'
               "        return '<%s Index: %s.%s on %s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name,\n'
               "            ', '.join(column.name for column in "
               'self.columns))\n'
               '\n'
               '    def __repr__(self):\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(column.name for column in "
               'self.columns))\n'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=638,
          lineno=59,
          tokens=132,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseIndex',
          body='\n'
               '    def clone(self, table):\n'
               '        """ Clone this index for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.columns = [getattr(table, column.name) for '
               'column in self.columns]\n'
               '        clone.table = table\n'
               '        return clone\n'
               '\n'
               '    def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        """ Returns list of (name, definition) tuples for the '
               'implicit definitions\n'
               '        required on the table model class level\n'
               '        \n'
               '        """\n'
               '        return []'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=639,
          lineno=80,
          tokens=16,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Index',
          body='class Index(BaseIndex):\n'
               '    """ Regular B-Tree based index\n'
               '    """'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=640,
          lineno=85,
          tokens=32,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='FullTextSearchIndex',
          body='class FullTextSearchIndex(BaseIndex):\n'
               '    """ Full text search index\n'
               '    \n'
               '    This kind of index is automatically applied to a '
               'SearchDocument columns.\n'
               '    \n'
               '    """'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=641,
          lineno=4,
          tokens=10,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer import utilfrom dblayer import util'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=642,
          lineno=8,
          tokens=115,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for database indexes models\n'
               '    # Serial number to record the order of column definitions# '
               'Reference to the table class containing this column# NOTE: Set '
               'by __new__ of the table definition class# Reference to the '
               'table instance containing this column or None for model '
               'columns# NOTE: Filled in by Table.__init__ as part of cloning '
               'the columns from the class to the instance# Name of the '
               'constraint# NOTE: Set by __new__ in the table definition '
               'class# List of the member columns# Indicates that this model '
               'object is added implicitly by some other model object'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=643,
          lineno=38,
          tokens=25,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseIndex can be instantiated!# Record the '
               'definition orderThis index must be applied to at least one '
               'column!'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=644,
          lineno=48,
          tokens=13,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='<%s Index: %s.%s on %s>'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=645,
          lineno=61,
          tokens=30,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Clone this index for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        '),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=646,
          lineno=73,
          tokens=24,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns list of (name, definition) tuples for the implicit '
               'definitions\n'
               '        required on the table model class level\n'
               '        \n'
               '        '),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=647,
          lineno=81,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Regular B-Tree based index\n    '),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=648,
          lineno=86,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Full text search index\n'
               '    \n'
               '    This kind of index is automatically applied to a '
               'SearchDocument columns.\n'
               '    \n'
               '    '),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=649,
          lineno=33,
          tokens=12,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='sort_key',
          body='def sort_key(obj):\n        return obj.__definition_serial__'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=650,
          lineno=36,
          tokens=77,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, *columns):\n'
               '        assert self.__class__ is not BaseIndex, (\n'
               "            'Only subclasses of BaseIndex can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        # Verify\n'
               "        assert columns, 'This index must be applied to at "
               "least one column!'\n"
               '        self.columns = columns'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=651,
          lineno=47,
          tokens=60,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__str__',
          body='def __str__(self):\n'
               "        return '<%s Index: %s.%s on %s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name,\n'
               "            ', '.join(column.name for column in self.columns))"),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=652,
          lineno=54,
          tokens=51,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s(%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               "            ', '.join(column.name for column in self.columns))"),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=653,
          lineno=60,
          tokens=84,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='clone',
          body='def clone(self, table):\n'
               '        """ Clone this index for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'columns to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.columns = [getattr(table, column.name) for '
               'column in self.columns]\n'
               '        clone.table = table\n'
               '        return clone'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=654,
          lineno=72,
          tokens=44,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='get_implicit_definition_list_for_table_class',
          body='def get_implicit_definition_list_for_table_class(self, '
               'table_class):\n'
               '        """ Returns list of (name, definition) tuples for the '
               'implicit definitions\n'
               '        required on the table model class level\n'
               '        \n'
               '        """\n'
               '        return []'),
 Fragment(document_cs='c8e0d7b146196d2b9e040e5dec9d13775a7545be14e879b200d0a40ecbf6810a',
          id=655,
          lineno=1,
          tokens=63,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: BaseIndex FullTextSearchIndex Index\n'
               '  Methods: __init__ __repr__ __str__ clone '
               'get_implicit_definition_list_for_table_class sort_key\n'
               '  Variables and usages: column columns dblayer '
               'get_next_definition_serial getattr implicit join name rsplit '
               'staticmethod table table_class update util\n'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=656,
          lineno=7,
          tokens=206,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseTrigger',
          body='class BaseTrigger:\n'
               '    """ Base class for database triggers\n'
               '    """\n'
               '\n'
               '    # Serial number to record the order of trigger '
               'definitions\n'
               '    __definition_serial__ = 0\n'
               '\n'
               '    # Reference to the table class containing this trigger\n'
               '    # NOTE: Set by __new__ of the table definition class\n'
               '    table_class = None\n'
               '\n'
               '    # Reference to the table instance containing this trigger '
               'or None for model triggers\n'
               '    # NOTE: Filled in by Table.__init__ as part of cloning the '
               'triggers from the class to the instance\n'
               '    table = None\n'
               '\n'
               '    # Name of the trigger\n'
               '    # NOTE: Set by __new__ of the table definition class\n'
               "    name = ''\n"
               '\n'
               '    # Indicates that this model object is added implicitly by '
               'some other model object\n'
               '    implicit = False\n'
               '\n'
               '    def __str__(self):\n'
               "        return '<%s Trigger: %s.%s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name)\n'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=657,
          lineno=34,
          tokens=225,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseTrigger',
          body='\n'
               '    def __repr__(self):\n'
               "        return '%s.%s(%r%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               '            self.procedure_name,\n'
               "            ''.join(', %r' % parameter for parameter in "
               'self.procedure_parameters))\n'
               '\n'
               '    @staticmethod\n'
               '    def sort_key(obj):\n'
               '        return obj.__definition_serial__\n'
               '\n'
               '    def __init__(self, procedure_name, '
               '*procedure_parameters):\n'
               '        assert self.__class__ is not BaseTrigger, (\n'
               "            'Only subclasses of BaseTrigger can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        self.procedure_name = procedure_name\n'
               '        self.procedure_parameters = procedure_parameters\n'
               '\n'
               '    def clone(self, table):\n'
               '        """ Clone this trigger for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'triggers to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.table = table\n'
               '        return clone'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=658,
          lineno=68,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BeforeInsertRow',
          body='class BeforeInsertRow(BaseTrigger):\n'
               '    """ Trigger executed before inserting a database row\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=659,
          lineno=73,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BeforeUpdateRow',
          body='class BeforeUpdateRow(BaseTrigger):\n'
               '    """ Trigger executed before updating a database row\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=660,
          lineno=78,
          tokens=22,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BeforeInsertOrUpdateRow',
          body='class BeforeInsertOrUpdateRow(BaseTrigger):\n'
               '    """ Trigger executed before inserting or updating a '
               'database row\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=661,
          lineno=83,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BeforeDeleteRow',
          body='class BeforeDeleteRow(BaseTrigger):\n'
               '    """ Trigger executed before deleting a database row\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=662,
          lineno=88,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BeforeInsertStatement',
          body='class BeforeInsertStatement(BaseTrigger):\n'
               '    """ Trigger executed before executing an insert statement\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=663,
          lineno=93,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BeforeUpdateStatement',
          body='class BeforeUpdateStatement(BaseTrigger):\n'
               '    """ Trigger executed before executing an update statement\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=664,
          lineno=98,
          tokens=22,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BeforeInsertOrUpdateStatement',
          body='class BeforeInsertOrUpdateStatement(BaseTrigger):\n'
               '    """ Trigger executed before executing an insert or update '
               'statement\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=665,
          lineno=103,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BeforeDeleteStatement',
          body='class BeforeDeleteStatement(BaseTrigger):\n'
               '    """ Trigger executed before executing a delete statement\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=666,
          lineno=108,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='AfterInsertRow',
          body='class AfterInsertRow(BaseTrigger):\n'
               '    """ Trigger executed before inserting a database row\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=667,
          lineno=113,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='AfterUpdateRow',
          body='class AfterUpdateRow(BaseTrigger):\n'
               '    """ Trigger executed before updating a database row\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=668,
          lineno=118,
          tokens=22,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='AfterInsertOrUpdateRow',
          body='class AfterInsertOrUpdateRow(BaseTrigger):\n'
               '    """ Trigger executed before inserting or updating a '
               'database row\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=669,
          lineno=123,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='AfterDeleteRow',
          body='class AfterDeleteRow(BaseTrigger):\n'
               '    """ Trigger executed before deleting a database row\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=670,
          lineno=128,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='AfterInsertStatement',
          body='class AfterInsertStatement(BaseTrigger):\n'
               '    """ Trigger executed before executing an insert statement\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=671,
          lineno=133,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='AfterUpdateStatement',
          body='class AfterUpdateStatement(BaseTrigger):\n'
               '    """ Trigger executed before executing an update statement\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=672,
          lineno=138,
          tokens=22,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='AfterInsertOrUpdateStatement',
          body='class AfterInsertOrUpdateStatement(BaseTrigger):\n'
               '    """ Trigger executed before executing an insert or update '
               'statement\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=673,
          lineno=143,
          tokens=19,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='AfterDeleteStatement',
          body='class AfterDeleteStatement(BaseTrigger):\n'
               '    """ Trigger executed before executing a delete statement\n'
               '    """'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=674,
          lineno=4,
          tokens=10,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer import utilfrom dblayer import util'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=675,
          lineno=1,
          tokens=3,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger definitions\n'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=676,
          lineno=8,
          tokens=108,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for database triggers\n'
               '    # Serial number to record the order of trigger '
               'definitions# Reference to the table class containing this '
               'trigger# NOTE: Set by __new__ of the table definition class# '
               'Reference to the table instance containing this trigger or '
               'None for model triggers# NOTE: Filled in by Table.__init__ as '
               'part of cloning the triggers from the class to the instance# '
               'Name of the trigger# NOTE: Set by __new__ of the table '
               'definition class# Indicates that this model object is added '
               'implicitly by some other model object'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=677,
          lineno=48,
          tokens=14,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseTrigger can be instantiated!# Record '
               'the definition order'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=678,
          lineno=57,
          tokens=30,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Clone this trigger for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'triggers to the table instance.\n'
               '        \n'
               '        '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=679,
          lineno=69,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before inserting a database row\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=680,
          lineno=74,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before updating a database row\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=681,
          lineno=79,
          tokens=11,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before inserting or updating a database row\n'
               '    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=682,
          lineno=84,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before deleting a database row\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=683,
          lineno=89,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before executing an insert statement\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=684,
          lineno=94,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before executing an update statement\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=685,
          lineno=99,
          tokens=11,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before executing an insert or update '
               'statement\n'
               '    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=686,
          lineno=104,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before executing a delete statement\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=687,
          lineno=109,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before inserting a database row\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=688,
          lineno=114,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before updating a database row\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=689,
          lineno=119,
          tokens=11,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before inserting or updating a database row\n'
               '    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=690,
          lineno=124,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before deleting a database row\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=691,
          lineno=129,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before executing an insert statement\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=692,
          lineno=134,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before executing an update statement\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=693,
          lineno=139,
          tokens=11,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before executing an insert or update '
               'statement\n'
               '    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=694,
          lineno=144,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Trigger executed before executing a delete statement\n    '),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=695,
          lineno=29,
          tokens=45,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__str__',
          body='def __str__(self):\n'
               "        return '<%s Trigger: %s.%s>' % (\n"
               '            self.__class__.__name__,\n'
               '            self.table_class.__name__ if self.table_class else '
               "'?',\n"
               '            self.name)'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=696,
          lineno=35,
          tokens=63,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body='def __repr__(self):\n'
               "        return '%s.%s(%r%s)' % (\n"
               "            self.__class__.__module__.rsplit('.', 1)[-1],\n"
               '            self.__class__.__name__,\n'
               '            self.procedure_name,\n'
               "            ''.join(', %r' % parameter for parameter in "
               'self.procedure_parameters))'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=697,
          lineno=43,
          tokens=12,
          depth=4,
          parent_id=None,
          category='function',
          summary=False,
          name='sort_key',
          body='def sort_key(obj):\n        return obj.__definition_serial__'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=698,
          lineno=46,
          tokens=73,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, procedure_name, *procedure_parameters):\n'
               '        assert self.__class__ is not BaseTrigger, (\n'
               "            'Only subclasses of BaseTrigger can be "
               "instantiated!')\n"
               '\n'
               '        # Record the definition order\n'
               '        self.__definition_serial__ = '
               'util.get_next_definition_serial()\n'
               '\n'
               '        self.procedure_name = procedure_name\n'
               '        self.procedure_parameters = procedure_parameters'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=699,
          lineno=56,
          tokens=67,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='clone',
          body='def clone(self, table):\n'
               '        """ Clone this trigger for a table instance\n'
               '        \n'
               '        NOTE: It is called by Table.__init__ to bound the '
               'triggers to the table instance.\n'
               '        \n'
               '        """\n'
               '        clone = self.__class__(None)\n'
               '        clone.__dict__.update(self.__dict__)\n'
               '        clone.table = table\n'
               '        return clone'),
 Fragment(document_cs='cd94fb9896ce80023e90de04e04777dc2ce2af02eaffb5b10c5c23ffbc66a510',
          id=700,
          lineno=1,
          tokens=104,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: AfterDeleteRow AfterDeleteStatement '
               'AfterInsertOrUpdateRow AfterInsertOrUpdateStatement '
               'AfterInsertRow AfterInsertStatement AfterUpdateRow '
               'AfterUpdateStatement BaseTrigger BeforeDeleteRow '
               'BeforeDeleteStatement BeforeInsertOrUpdateRow '
               'BeforeInsertOrUpdateStatement BeforeInsertRow '
               'BeforeInsertStatement BeforeUpdateRow BeforeUpdateStatement\n'
               '  Methods: __init__ __repr__ __str__ clone sort_key\n'
               '  Variables and usages: dblayer get_next_definition_serial '
               'implicit join name parameter procedure_name '
               'procedure_parameters rsplit staticmethod table table_class '
               'update util\n'),
 Fragment(document_cs='cf5372a5921b5b10226c21fa19bd6d3043e80726c50eedc02e53ff11e50243d1',
          id=701,
          lineno=4,
          tokens=16,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import datetimeimport itertoolsimport randomfrom dblayer '
               'import constantsfrom dblayer import constants'),
 Fragment(document_cs='cf5372a5921b5b10226c21fa19bd6d3043e80726c50eedc02e53ff11e50243d1',
          id=702,
          lineno=12,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the next serial used to sort model definition '
               'instances\n'
               '    '),
 Fragment(document_cs='cf5372a5921b5b10226c21fa19bd6d3043e80726c50eedc02e53ff11e50243d1',
          id=703,
          lineno=18,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns a new random database ID value\n    '),
 Fragment(document_cs='cf5372a5921b5b10226c21fa19bd6d3043e80726c50eedc02e53ff11e50243d1',
          id=704,
          lineno=11,
          tokens=31,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='get_next_definition_serial',
          body='def get_next_definition_serial(iterator=itertools.count()):\n'
               '    """ Returns the next serial used to sort model definition '
               'instances\n'
               '    """\n'
               '    return next(iterator)'),
 Fragment(document_cs='cf5372a5921b5b10226c21fa19bd6d3043e80726c50eedc02e53ff11e50243d1',
          id=705,
          lineno=17,
          tokens=32,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='get_random_id',
          body='def get_random_id(random=random.SystemRandom()):\n'
               '    """ Returns a new random database ID value\n'
               '    """\n'
               '    return random.randrange(*constants.DATABASE_ID_RANGE)'),
 Fragment(document_cs='cf5372a5921b5b10226c21fa19bd6d3043e80726c50eedc02e53ff11e50243d1',
          id=706,
          lineno=23,
          tokens=40,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='log',
          body='def log(msg, *args):\n'
               '    """ Log\n'
               '    """\n'
               '    print\n'
               "    '%s: %s' % (\n"
               "        datetime.datetime.now().isoformat(' '),\n"
               '        msg % args)'),
 Fragment(document_cs='cf5372a5921b5b10226c21fa19bd6d3043e80726c50eedc02e53ff11e50243d1',
          id=707,
          lineno=1,
          tokens=39,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Functions: get_next_definition_serial get_random_id log\n'
               '  Variables and usages: DATABASE_ID_RANGE SystemRandom args '
               'constants count datetime dblayer isoformat iterator itertools '
               'next print random randrange\n'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=708,
          lineno=7,
          tokens=62,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='BaseAggregate',
          body='class BaseAggregate(function.BaseFunction):\n'
               '    """ Base class for aggregates\n'
               '    """\n'
               '\n'
               '    def __init__(self, *args):\n'
               '        function.BaseFunction.__init__(self, *args)\n'
               '\n'
               '        assert self.__class__ is not BaseAggregate, (\n'
               "            'Only subclasses of BaseAggregate can be "
               "instantiated!')"),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=709,
          lineno=18,
          tokens=7,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Count',
          body='class Count(BaseAggregate):\n    pass'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=710,
          lineno=22,
          tokens=7,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Min',
          body='class Min(BaseAggregate):\n    pass'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=711,
          lineno=26,
          tokens=7,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Max',
          body='class Max(BaseAggregate):\n    pass'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=712,
          lineno=30,
          tokens=7,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Sum',
          body='class Sum(BaseAggregate):\n    pass'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=713,
          lineno=34,
          tokens=7,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='Avg',
          body='class Avg(BaseAggregate):\n    pass'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=714,
          lineno=4,
          tokens=12,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='from dblayer.model import functionfrom dblayer.model import '
               'function'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=715,
          lineno=1,
          tokens=12,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Aggregate functions can be used in to aggregate data in '
               'queries\n'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=716,
          lineno=8,
          tokens=6,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Base class for aggregates\n    '),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=717,
          lineno=15,
          tokens=9,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='Only subclasses of BaseAggregate can be instantiated!'),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=718,
          lineno=11,
          tokens=45,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(self, *args):\n'
               '        function.BaseFunction.__init__(self, *args)\n'
               '\n'
               '        assert self.__class__ is not BaseAggregate, (\n'
               "            'Only subclasses of BaseAggregate can be "
               "instantiated!')"),
 Fragment(document_cs='cf66af962d77f8d93d11e54e2c8606982b7ccc7ffe9d5929ad4d8a9a55b623ce',
          id=719,
          lineno=1,
          tokens=31,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: Avg BaseAggregate Count Max Min Sum\n'
               '  Methods: __init__\n'
               '  Variables and usages: BaseFunction args dblayer function '
               'model\n'),
 Fragment(document_cs='d6abc8d12b5491b7f0f549ea44e35f1349f1e833194fb399424d45ab0bf469a2',
          id=720,
          lineno=1,
          tokens=97,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='.idea\n'
               '__pycache__\n'
               '*.py[co]\n'
               '*,cover\n'
               '*.coverage\n'
               '*.bak\n'
               '*.log\n'
               '*~\n'
               '\n'
               '# Specific directories and files\n'
               'var\n'
               'var/*\n'
               'lib/build\n'
               'lib/build/*\n'
               'lib/dist\n'
               'lib/dist/*\n'
               'lib/dblayer.egg-info\n'
               'lib/dblayer.egg-info/*\n'
               'etc/config.py\n'
               '\n'
               '# Generated files\n'
               'lib/dblayer/test/abstraction.py\n'
               'lib/dblayer/test/model.gml\n'
               'lib/dblayer/test/inspected_*.py\n'),
 Fragment(document_cs='d6abc8d12b5491b7f0f549ea44e35f1349f1e833194fb399424d45ab0bf469a2',
          id=721,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='db052c640915adc0f19b3bd51b5d3680341635e506dd41ad3679af9fe1458f42',
          id=722,
          lineno=1,
          tokens=8,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Subpackage for implementing database backends\n'),
 Fragment(document_cs='db052c640915adc0f19b3bd51b5d3680341635e506dd41ad3679af9fe1458f42',
          id=723,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='deacbf85f173df51347b04404592bae017c91a2128f2a57b744acdc41fcaa939',
          id=724,
          lineno=1,
          tokens=4,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' PostgreSQL database backend\n'),
 Fragment(document_cs='deacbf85f173df51347b04404592bae017c91a2128f2a57b744acdc41fcaa939',
          id=725,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='df68932999e367a739a435fdcc3953007fca0b37402c25f5c3e4b56c5dcb0ab5',
          id=726,
          lineno=11,
          tokens=43,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='DatabaseAbstraction',
          body='class DatabaseAbstraction(database.DatabaseAbstraction):\n'
               '\n'
               "    def _connect(self, dsn, client_encoding='UTF8'):\n"
               '        self.connection = psycopg2.connect(dsn)\n'
               '        self.connection.set_client_encoding(client_encoding)'),
 Fragment(document_cs='df68932999e367a739a435fdcc3953007fca0b37402c25f5c3e4b56c5dcb0ab5',
          id=727,
          lineno=1,
          tokens=21,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import psycopg2import psycopg2.extensionsfrom '
               'dblayer.backend.base import databasefrom dblayer.backend.base '
               'import database'),
 Fragment(document_cs='df68932999e367a739a435fdcc3953007fca0b37402c25f5c3e4b56c5dcb0ab5',
          id=728,
          lineno=6,
          tokens=9,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='### Force returning of unicode string from the database'),
 Fragment(document_cs='df68932999e367a739a435fdcc3953007fca0b37402c25f5c3e4b56c5dcb0ab5',
          id=729,
          lineno=13,
          tokens=33,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='_connect',
          body="def _connect(self, dsn, client_encoding='UTF8'):\n"
               '        self.connection = psycopg2.connect(dsn)\n'
               '        self.connection.set_client_encoding(client_encoding)'),
 Fragment(document_cs='df68932999e367a739a435fdcc3953007fca0b37402c25f5c3e4b56c5dcb0ab5',
          id=730,
          lineno=1,
          tokens=40,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: DatabaseAbstraction\n'
               '  Methods: _connect\n'
               '  Variables and usages: UNICODE UNICODEARRAY backend base '
               'client_encoding connect connection database dblayer extensions '
               'psycopg2 register_type set_client_encoding\n'),
 Fragment(document_cs='e0592e9706e0ee8a80c03b6c282f011a920a47a9aadb1cb736172ca3255816d0',
          id=731,
          lineno=1,
          tokens=22,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='[egg_info]\n'
               'tag_svn_revision = 0\n'
               "tag_build = ''\n"
               'tag_date = 0\n'),
 Fragment(document_cs='e0592e9706e0ee8a80c03b6c282f011a920a47a9aadb1cb736172ca3255816d0',
          id=732,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='e946a3bf114908c9688259c88154ee8fb184cfe9152951e815041f045566653a',
          id=733,
          lineno=1,
          tokens=6,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Classes to build database models\n'),
 Fragment(document_cs='e946a3bf114908c9688259c88154ee8fb184cfe9152951e815041f045566653a',
          id=734,
          lineno=1,
          tokens=0,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body=''),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=735,
          lineno=25,
          tokens=13,
          depth=2,
          parent_id=None,
          category='class',
          summary=False,
          name='{{table.__class__.__name__}}Record(record.Record)',
          body='class {{table.__class__.__name__}}Record(record.Record):'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=736,
          lineno=106,
          tokens=13,
          depth=2,
          parent_id=None,
          category='class',
          summary=False,
          name='{{abstraction_class_name}}(database.DatabaseAbstraction)',
          body='class '
               '{{abstraction_class_name}}(database.DatabaseAbstraction):'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=737,
          lineno=13,
          tokens=27,
          depth=2,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import timeimport dblayerfrom dblayer import constants, '
               'utilfrom dblayer import constants, utilfrom '
               '{{backend.__name__}} import'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=738,
          lineno=116,
          tokens=15,
          depth=2,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='importfrom {{backend.__name__}}.clausesimport Clausesfrom'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=739,
          lineno=1,
          tokens=89,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' {{abstraction_class_name}} - generated database abstraction '
               'layer\n'
               '\n'
               'Database model: {{database.__class__.__name__}}\n'
               'Backend server: {{backend.__name__}}\n'
               "Generated   on: {{now.isoformat(' ').rsplit('.', 1)[0]}}\n"
               '\n'
               'NOTE: It is a generated database abstraction layer. Please do '
               'not modify.\n'
               '      All your changes will be lost next time this code is '
               'generated!\n'
               '      Please add your code in a subclass.\n'
               '\n'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=740,
          lineno=26,
          tokens=132,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' {{table.__class__.__name__}} record\n'
               '    \n'
               '    %for column in accessible_column_list:\n'
               '    %if column.doc:\n'
               '    * {{column.name}}: {{column.doc}}\n'
               '    %else:\n'
               '    * {{column.name}}: Undocumented\n'
               '    %end\n'
               '      %if column.null:\n'
               '      Nullable, default: {{repr(column.default)}}\n'
               '      %else:\n'
               '      %if column.default is None:\n'
               '      Required\n'
               '      %else:\n'
               '      Required, default: {{repr(column.default)}}\n'
               '      %end\n'
               '      %end\n'
               '    \n'
               '    %end\n'
               '    ### Runtime model information# Name of the corresponding '
               'database table storing the actual records# Column information'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=741,
          lineno=67,
          tokens=117,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates {{table.__class__.__name__}} record in memory\n'
               '        \n'
               '        %for column in accessible_column_list:\n'
               '        %if column.doc:\n'
               '        * {{column.name}}: {{column.doc}}\n'
               '        %else:\n'
               '        * {{column.name}}: Undocumented\n'
               '        %end\n'
               '          %if column.null:\n'
               '          Nullable, default: {{repr(column.default)}}\n'
               '          %else:\n'
               '          %if column.default is None:\n'
               '          Required\n'
               '          %else:\n'
               '          Required, default: {{repr(column.default)}}\n'
               '          %end\n'
               '          %end\n'
               '        \n'
               '        %end\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=742,
          lineno=91,
          tokens=20,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns a tuple with the field values of this '
               '{{table.__class__.__name__}} record\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=743,
          lineno=98,
          tokens=23,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns a dictionary with the field values of this '
               '{{table.__class__.__name__}} record\n'
               '        ### Database abstraction'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=744,
          lineno=107,
          tokens=64,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Database abstraction layer\n'
               '    \n'
               '    Database model: {{database.__class__.__name__}}\n'
               '    Backend server: {{backend.__name__}}\n'
               "    Generated   on: {{now.isoformat(' ').rsplit('.', 1)[0]}}\n"
               '    \n'
               '    # Database backend module, required by the methods in the '
               'DatabaseAbstraction base class'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=745,
          lineno=126,
          tokens=70,
          depth=1,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# SQL statement for the savepoint set before each indentity '
               'insert statementbefore_identity_insert# SQL statement to '
               'release a savepoint after a successful identity '
               'insertbefore_identity_insert# SQL statement for rolling back '
               'to the savepoint after a failing insert '
               'statementbefore_identity_insert### Creating in-memory records '
               '- override them to provide custom record classes### Selecting '
               'from the database'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=746,
          lineno=159,
          tokens=95,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Retrieves a {{table.__class__.__name__}} record or None if '
               'not found\n'
               '        The {{table.__class__.__name__}} table does not have a '
               'primary key, so no way to find a record by primary key '
               'value!Cannot pass a where condition while searching for a '
               'record by its primary key value (id)!Cannot pass '
               'parameter_tuple while searching for a record by its primary '
               'key value (id)!{{format.quote_name(table._primary_key.name)}} '
               '= %s'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=747,
          lineno=205,
          tokens=14,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Retrieves list of {{table.__class__.__name__}} records\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=748,
          lineno=229,
          tokens=14,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Iterates on {{table.__class__.__name__}} records\n        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=749,
          lineno=255,
          tokens=15,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Counts {{table.__class__.__name__}} records in the database\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=750,
          lineno=303,
          tokens=28,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Finds {{table.__class__.__name__}} record by field values, '
               'returns None if not found\n'
               '        Query execution time: %dms'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=751,
          lineno=355,
          tokens=22,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Finds {{table.__class__.__name__}} records by field values\n'
               '        Query execution time: %dms'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=752,
          lineno=407,
          tokens=27,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Finds {{table.__class__.__name__}} records by field values '
               'and iterates on them\n'
               '        Query execution time: %dms'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=753,
          lineno=460,
          tokens=48,
          depth=3,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Counds {{table.__class__.__name__}} records by field values\n'
               '\n'
               '        The record ordering is ignored, but can be passed to '
               'provide\n'
               '        compatible method signature with the actual find '
               'methods.\n'
               '        \n'
               '        Query execution time: %dms'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=754,
          lineno=562,
          tokens=25,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes the {{query.__class__.__name__}} query and returns '
               'the resulting records\n'
               '        Query execution time: %dms'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=755,
          lineno=615,
          tokens=27,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes the {{query.__class__.__name__}} query and iterates '
               'on the resulting records\n'
               '        Query execution time: %dms'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=756,
          lineno=669,
          tokens=56,
          depth=7,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Executes the {{query.__class__.__name__}} query and counts '
               'the resulting records\n'
               '\n'
               '        The record ordering is ignored, but can be passed to '
               'provide\n'
               '        compatible method signature with the actual query '
               'methods.\n'
               '        \n'
               '        Query execution time: %dms### Inserting into the '
               'database'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=757,
          lineno=719,
          tokens=22,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Inserts single {{table.__class__.__name__}} record into the '
               '{{table._name}} database table\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=758,
          lineno=724,
          tokens=27,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Inserts multiple {{table.__class__.__name__}} records into '
               'the {{table._name}} database table\n'
               '        ### Updating into the database'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=759,
          lineno=739,
          tokens=22,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Updates single {{table.__class__.__name__}} record into the '
               '{{table._name}} database table\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=760,
          lineno=744,
          tokens=27,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Updates multiple {{table.__class__.__name__}} records into '
               'the {{table._name}} database table\n'
               '        ### Deleting from the database'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=761,
          lineno=759,
          tokens=22,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Deletes single {{table.__class__.__name__}} record from the '
               '{{table._name}} database table\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=762,
          lineno=764,
          tokens=22,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Deletes multiple {{table.__class__.__name__}} records from '
               'the {{table._name}} database table\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=763,
          lineno=769,
          tokens=14,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Truncates table {{table._name}} in the database\n        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=764,
          lineno=779,
          tokens=49,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Truncates all the tables in the database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'reversed(database._table_list) if table._creatable and '
               'table._primary_key)}}\n'
               '        \n'
               '        ### Creating and dropping stored procedures'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=765,
          lineno=796,
          tokens=16,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates stored procedure {{table.__class__.__name__}} in the '
               'database\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=766,
          lineno=805,
          tokens=26,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Drops stored procedure {{table.__class__.__name__}} from the '
               'database\n'
               '        ### Creating and dropping all the stored procedures at '
               'once'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=767,
          lineno=817,
          tokens=30,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates all the stored procedures into the database\n'
               '        \n'
               "        {{'\\n        '.join(procedure.name for procedure in "
               'database._procedure_list)}}\n'
               '        \n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=768,
          lineno=829,
          tokens=35,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Drops all the stored procedures from the database\n'
               '        \n'
               "        {{'\\n        '.join(procedure.name for procedure in "
               'database._procedure_list)}}\n'
               '        \n'
               '        ### Creating and dropping triggers'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=769,
          lineno=847,
          tokens=20,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates trigger {{table.__class__.__name__}}.{{trigger.name}} '
               'in the database\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=770,
          lineno=856,
          tokens=32,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Drops trigger {{table.__class__.__name__}}.{{trigger.name}} '
               'from the database\n'
               '        ### Creating and dropping the triggers of all the '
               'tables at once'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=771,
          lineno=871,
          tokens=42,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates the triggers for all the tables in the database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'database._table_list if table._creatable and '
               'table._trigger_list)}}\n'
               '        \n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=772,
          lineno=887,
          tokens=49,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Drops the triggers for all the tables from the database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'reversed(database._table_list) if table._creatable and '
               'table._trigger_list)}}\n'
               '        \n'
               '        ### Creating and dropping tables'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=773,
          lineno=907,
          tokens=15,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates table {{table.__class__.__name__}} in the database\n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=774,
          lineno=916,
          tokens=27,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Drops table {{table.__class__.__name__}} from the database\n'
               '        ### Creating, dropping and truncating all the tables '
               'at once'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=775,
          lineno=929,
          tokens=36,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates all the tables and views into the database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'database._table_list if table._creatable)}}\n'
               '        \n'
               '        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=776,
          lineno=943,
          tokens=41,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Drops all the tables and views from the database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'reversed(database._table_list) if table._creatable)}}\n'
               '        \n'
               '        ### Creating languages'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=777,
          lineno=959,
          tokens=19,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates all the procedural languages used in the procedures '
               'defined\n'
               '        ### Creating and dropping the database structure'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=778,
          lineno=971,
          tokens=7,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Creates the whole database structure\n        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=779,
          lineno=982,
          tokens=7,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Drops the whole database structure\n        '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=780,
          lineno=64,
          tokens=44,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='__init__',
          body='def __init__(\n'
               '        self,\n'
               "        {{',\\n        '.join('%s=%r' % (column.name, (None if "
               'column.has_custom_default else column.default)) for column in '
               'accessible_column_list)}}):'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=781,
          lineno=90,
          tokens=54,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='tuple',
          body='def tuple(self):\n'
               '        """ Returns a tuple with the field values of this '
               '{{table.__class__.__name__}} record\n'
               '        """\n'
               '        return (\n'
               "            {{',\\n            '.join('self.%s' % column.name "
               'for column in accessible_column_list)}})'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=782,
          lineno=97,
          tokens=61,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='dict',
          body='def dict(self):\n'
               '        """ Returns a dictionary with the field values of this '
               '{{table.__class__.__name__}} record\n'
               '        """\n'
               '        return dict(\n'
               "            {{',\\n            '.join('%s=self.%s' % "
               '(column.name, column.name) for column in '
               'accessible_column_list)}})'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=783,
          lineno=152,
          tokens=204,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='get_{{table.',
          body='def get_{{table._name}}(\n'
               '        self,\n'
               '        id=None,\n'
               '        where=None,\n'
               '        parameter_tuple=(),\n'
               '        order_by=(),\n'
               '        offset=None):\n'
               '        """ Retrieves a {{table.__class__.__name__}} record or '
               'None if not found\n'
               '        """\n'
               '        if id is not None:\n'
               '            %if table._primary_key is None:\n'
               "            raise ValueError('The {{table.__class__.__name__}} "
               'table does not have a primary key, so no way to find a record '
               "by primary key value!')\n"
               '            %else:\n'
               '            %if constants.DEBUG:\n'
               '            if where is not None:\n'
               "                raise ValueError('Cannot pass a where "
               'condition while searching for a record by its primary key '
               "value (id)!')\n"
               '            if parameter_tuple:\n'
               "                raise ValueError('Cannot pass parameter_tuple "
               "while searching for a record by its primary key value (id)!')\n"
               '            %end\n'
               '            parameter_tuple = (id, )\n'
               '            where = '
               "'{{format.quote_name(table._primary_key.name)}} = %s'\n"
               '            %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=784,
          lineno=198,
          tokens=37,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='get_',
          body='\n'
               '        \n'
               '    def get_{{table._name}}_list(\n'
               '        self,\n'
               "        where='',\n"
               '        parameter_tuple=(),\n'
               '        order_by=(),\n'
               '        limit=None,\n'
               '        offset=None):'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=785,
          lineno=222,
          tokens=37,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='get_',
          body='\n'
               '    \n'
               '    def get_{{table._name}}_iter(\n'
               '        self,\n'
               "        where='',\n"
               '        parameter_tuple=(),\n'
               '        order_by=(),\n'
               '        limit=None,\n'
               '        offset=None):'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=786,
          lineno=251,
          tokens=128,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='get_{{table._name}}',
          body='def get_{{table._name}}_count(\n'
               '        self,\n'
               "        where='',\n"
               '        parameter_tuple=()):\n'
               '        """ Counts {{table.__class__.__name__}} records in the '
               'database\n'
               '        """\n'
               '        if not isinstance(where, str):\n'
               '            where = self._format.format_expression(where)\n'
               '        \n'
               '        clauses = self.Clauses(\n'
               '            table_list=({{repr(table._table_name)}}, ),\n'
               "            field_list=('COUNT(*)', ),\n"
               '            where=where)\n'
               '            \n'
               '        sql = self._format.format_select(clauses)\n'
               '        \n'
               '        with self.cursor() as cursor:\n'
               '            return self.execute_and_fetch_one(cursor, sql)[0]'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=787,
          lineno=292,
          tokens=62,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='find_',
          body='\n'
               '    \n'
               '    def find_{{table_name}}(\n'
               '        self,\n'
               '        %if constants.DEBUG:\n'
               '        %for name in table_column_name_list:\n'
               '        {{name}}=NA,\n'
               '        %end\n'
               '        %end\n'
               '        order_by=(),\n'
               '        offset=None,\n'
               '        where=None,\n'
               '        **runtime_conditions):'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=788,
          lineno=343,
          tokens=68,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='find_',
          body='\n'
               '        \n'
               '    def find_{{table_name}}_list(\n'
               '        self,\n'
               '        %if constants.DEBUG:\n'
               '        %for name in table_column_name_list:\n'
               '        {{name}}=NA,\n'
               '        %end\n'
               '        %end\n'
               '        order_by=(),\n'
               '        limit=None,\n'
               '        offset=None,\n'
               '        where=None,\n'
               '        **runtime_conditions):'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=789,
          lineno=395,
          tokens=15,
          depth=7,
          parent_id=None,
          category='function',
          summary=False,
          name='find_',
          body='end\n'
               '            \n'
               '        return record_list\n'
               '        \n'
               '    def find_{{table_name}}'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=790,
          lineno=448,
          tokens=68,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='find_',
          body='\n'
               '            \n'
               '    def find_{{table_name}}_count(\n'
               '        self,\n'
               '        %if constants.DEBUG:\n'
               '        %for name in table_column_name_list:\n'
               '        {{name}}=NA,\n'
               '        %end\n'
               '        %end\n'
               '        order_by=None,\n'
               '        limit=None,\n'
               '        offset=None,\n'
               '        where=None,\n'
               '        **runtime_conditions):'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=791,
          lineno=549,
          tokens=133,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='query_{{query_name}}',
          body='def query_{{query_name}}_list(\n'
               '        self,\n'
               '        %if constants.DEBUG:\n'
               '        %for name in condition_name_list:\n'
               '        {{name}}=NA,\n'
               '        %end\n'
               '        %end\n'
               '        order_by={{repr(query._order_by)}},\n'
               '        limit=None,\n'
               '        offset=None,\n'
               '        where=None,\n'
               '        having=None,\n'
               '        **runtime_conditions):\n'
               '        """ Executes the {{query.__class__.__name__}} query '
               'and returns the resulting records\n'
               '        """\n'
               '        %if constants.DEBUG:\n'
               '        %for name in condition_name_list:\n'
               '        runtime_conditions[{{repr(name)}}] = {{name}}\n'
               '        %end\n'
               '        \n'
               '        %end\n'
               '      '),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=792,
          lineno=570,
          tokens=121,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='query_{{query_name}}',
          body='  sql, parameter_tuple = self._format.format_query(\n'
               '            self.{{query_constant_prefix}}_TABLE_LIST,\n'
               '            self.{{query_constant_prefix}}_FIELD_LIST,\n'
               '            '
               'self.{{query_constant_prefix}}_WHERE_CONDITION_MAP,\n'
               '            '
               'self.{{query_constant_prefix}}_HAVING_CONDITION_MAP,\n'
               '            self.{{query_constant_prefix}}_GROUP_BY,\n'
               '            self.{{query_constant_prefix}}_ORDER_BY_MAP,\n'
               '            where,\n'
               '            having,\n'
               '            runtime_conditions,\n'
               '            order_by,\n'
               '            limit,\n'
               '            offset)\n'
               '        \n'
               '        record_class = self.new_{{query_name}}    \n'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=793,
          lineno=585,
          tokens=136,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='query_{{query_name}}',
          body='        with self.cursor() as cursor:\n'
               '            %if constants.LOG_SQL_ANALYSIS:\n'
               '            self.log_analysis(cursor, sql, parameter_tuple)\n'
               '            %end\n'
               '            %if constants.PROFILE_QUERIES:\n'
               '            start_time = time.time()\n'
               '            %end\n'
               '            record_list = [\n'
               '                record_class(*row) \n'
               '                for row in self.execute_and_fetch_iter(cursor, '
               'sql, parameter_tuple)]\n'
               '            %if constants.PROFILE_QUERIES:\n'
               '            end_time = time.time()\n'
               "            util.log('Query execution time: %dms', "
               'int((end_time - start_time) * 1000 + 0.5))\n'
               '            %end\n'
               '            \n'
               '        return record_list'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=794,
          lineno=602,
          tokens=138,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='query_{{query_name}}',
          body='def query_{{query_name}}_iter(\n'
               '        self,\n'
               '        %if constants.DEBUG:\n'
               '        %for name in condition_name_list:\n'
               '        {{name}}=NA,\n'
               '        %end\n'
               '        %end\n'
               '        order_by={{repr(query._order_by)}},\n'
               '        limit=None,\n'
               '        offset=None,\n'
               '        where=None,\n'
               '        having=None,\n'
               '        **runtime_conditions):\n'
               '        """ Executes the {{query.__class__.__name__}} query '
               'and iterates on the resulting records\n'
               '        """\n'
               '        %if constants.DEBUG:\n'
               '        %for name in condition_name_list:\n'
               '        runtime_conditions[{{repr(name)}}] = {{name}}\n'
               '        %end\n'
               '        \n'
               '        %end\n'
               '        sql, parameter'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=795,
          lineno=623,
          tokens=148,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='query_{{query_name}}',
          body='_tuple = self._format.format_query(\n'
               '            self.{{query_constant_prefix}}_TABLE_LIST,\n'
               '            self.{{query_constant_prefix}}_FIELD_LIST,\n'
               '            '
               'self.{{query_constant_prefix}}_WHERE_CONDITION_MAP,\n'
               '            '
               'self.{{query_constant_prefix}}_HAVING_CONDITION_MAP,\n'
               '            self.{{query_constant_prefix}}_GROUP_BY,\n'
               '            self.{{query_constant_prefix}}_ORDER_BY_MAP,\n'
               '            where,\n'
               '            having,\n'
               '            runtime_conditions,\n'
               '            order_by,\n'
               '            limit,\n'
               '            offset)\n'
               '        \n'
               '        record_class = self.new_{{query_name}}\n'
               '        %if constants.LOG_SQL_ANALYSIS:\n'
               '        with self.cursor() as cursor:\n'
               '            self.log_analysis(cursor, sql, parameter_tuple)\n'
               '        %else:\n'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=796,
          lineno=642,
          tokens=129,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='query_{{query_name}}',
          body='        with self.cursor(named=True) as cursor:\n'
               '        %end\n'
               '            %if constants.PROFILE_QUERIES:\n'
               '            start_time = time.time()\n'
               '            row_list = '
               'list(self.execute_and_fetch_iter(cursor, sql, '
               'parameter_tuple))\n'
               '            end_time = time.time()\n'
               "            util.log('Query execution time: %dms', "
               'int((end_time - start_time) * 1000 + 0.5))\n'
               '            for row in row_list:\n'
               '                yield record_class(*row)\n'
               '            %else:\n'
               '            for row in self.execute_and_fetch_iter(cursor, '
               'sql, parameter_tuple):\n'
               '                yield record_class(*row)\n'
               '            %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=797,
          lineno=656,
          tokens=240,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='query_{{query_name}}',
          body='def query_{{query_name}}_count(\n'
               '        self,\n'
               '        %if constants.DEBUG:\n'
               '        %for name in condition_name_list:\n'
               '        {{name}}=NA,\n'
               '        %end\n'
               '        %end\n'
               '        order_by=None,\n'
               '        limit=None,\n'
               '        offset=None,\n'
               '        where=None,\n'
               '        having=None,\n'
               '        **runtime_conditions):\n'
               '        """ Executes the {{query.__class__.__name__}} query '
               'and counts the resulting records\n'
               '\n'
               '        The record ordering is ignored, but can be passed to '
               'provide\n'
               '        compatible method signature with the actual query '
               'methods.\n'
               '        \n'
               '        """\n'
               '        %if constants.DEBUG:\n'
               '        %for name in condition_name_list:\n'
               '        runtime_conditions[{{repr(name)}}] = {{name}}\n'
               '        %end\n'
               '\n'
               '        %end\n'
               '        sql, parameter_tuple = self._format.format_query(\n'
               '            self.{{query_constant_prefix}}_TABLE_LIST,\n'
               "            ('COUNT(*)', ),\n"
               '            '
               'self.{{query_constant_prefix}}_WHERE_CONDITION_MAP,\n'
               '            '
               'self.{{query_constant_prefix}}_HAVING_CONDITION_MAP,\n'
               '            self.{{query_constant_prefix}}_GROUP_BY,\n'
               '            {},\n'
               '            where,\n'
               '            having,\n'
               '            runtime_conditions,\n'
               '            (),\n'
               '            limit,\n'
               '            offset)\n'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=798,
          lineno=694,
          tokens=126,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='query_{{query_name}}',
          body='        \n'
               '        with self.cursor() as cursor:\n'
               '            %if constants.LOG_SQL_ANALYSIS:\n'
               '            self.log_analysis(cursor, sql, parameter_tuple)\n'
               '            %end\n'
               '            %if constants.PROFILE_QUERIES:\n'
               '            start_time = time.time()\n'
               '            %end\n'
               '            row = self.execute_and_fetch_one(cursor, sql, '
               'parameter_tuple)\n'
               '            %if constants.PROFILE_QUERIES:\n'
               '            end_time = time.time()\n'
               "            util.log('Query execution time: %dms', "
               'int((end_time - start_time) * 1000 + 0.5))\n'
               '            %end\n'
               '            \n'
               '        return row[0]'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=799,
          lineno=718,
          tokens=68,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='add_{{table.',
          body='def add_{{table._name}}(self, record, generate_id=True):\n'
               '        """ Inserts single {{table.__class__.__name__}} record '
               'into the {{table._name}} database table\n'
               '        """\n'
               '        self.add_record(self.new_{{table._name}}, record, '
               'generate_id, {{repr(table._primary_key.serial)}})'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=800,
          lineno=723,
          tokens=72,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='add_{{table._name}}',
          body='def add_{{table._name}}_list(self, record_list, '
               'generate_id=True):\n'
               '        """ Inserts multiple {{table.__class__.__name__}} '
               'records into the {{table._name}} database table\n'
               '        """\n'
               '        self.add_record_list(self.new_{{table._name}}, '
               'record_list, generate_id, {{repr(table._primary_key.serial)}})'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=801,
          lineno=738,
          tokens=52,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='update_',
          body='def update_{{table._name}}(self, record):\n'
               '        """ Updates single {{table.__class__.__name__}} record '
               'into the {{table._name}} database table\n'
               '        """\n'
               '        self.update_record(self.new_{{table._name}}, record)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=802,
          lineno=743,
          tokens=56,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='update_{{table._name}}',
          body='def update_{{table._name}}_list(self, record_list):\n'
               '        """ Updates multiple {{table.__class__.__name__}} '
               'records into the {{table._name}} database table\n'
               '        """\n'
               '        self.update_record_list(self.new_{{table._name}}, '
               'record_list)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=803,
          lineno=758,
          tokens=56,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='delete_',
          body='def delete_{{table._name}}(self, record_or_id):\n'
               '        """ Deletes single {{table.__class__.__name__}} record '
               'from the {{table._name}} database table\n'
               '        """\n'
               '        self.delete_record(self.new_{{table._name}}, '
               'record_or_id)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=804,
          lineno=763,
          tokens=60,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='delete_{{table._name}}',
          body='def delete_{{table._name}}_list(self, record_or_id_list):\n'
               '        """ Deletes multiple {{table.__class__.__name__}} '
               'records from the {{table._name}} database table\n'
               '        """\n'
               '        self.delete_record_list(self.new_{{table._name}}, '
               'record_or_id_list)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=805,
          lineno=768,
          tokens=62,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='truncate_',
          body='def truncate_{{table._name}}(self):\n'
               '        """ Truncates table {{table._name}} in the database\n'
               '        """\n'
               '        statement_list = '
               '{{repr(format.format_truncate_table(table, database))}}\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute_statement_list(cursor, '
               'statement_list)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=806,
          lineno=778,
          tokens=91,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='truncate_all_tables',
          body='def truncate_all_tables(self):\n'
               '        """ Truncates all the tables in the database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'reversed(database._table_list) if table._creatable and '
               'table._primary_key)}}\n'
               '        \n'
               '        """\n'
               '        statement_list = '
               '{{repr(format.format_truncate_table_list(database._table_list, '
               'database))}}\n'
               '        \n'
               '        with self.cursor() as cursor:\n'
               '            self.execute_statement_list(cursor, '
               'statement_list)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=807,
          lineno=795,
          tokens=71,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='create_procedure_',
          body='def create_procedure_{{procedure.name}}(self, '
               'ignore_errors=False):\n'
               '        """ Creates stored procedure '
               '{{table.__class__.__name__}} in the database\n'
               '        """\n'
               '        statement_list = '
               '{{repr(format.format_create_procedure(procedure))}}\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute_statement_list(cursor, '
               'statement_list, ignore_errors)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=808,
          lineno=804,
          tokens=71,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='drop_procedure_',
          body='def drop_procedure_{{procedure.name}}(self, '
               'ignore_errors=False):\n'
               '        """ Drops stored procedure '
               '{{table.__class__.__name__}} from the database\n'
               '        """\n'
               '        statement_list = '
               '{{repr(format.format_drop_procedure(procedure))}}\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute_statement_list(cursor, '
               'statement_list, ignore_errors)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=809,
          lineno=816,
          tokens=71,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='create_all_procedures',
          body='def create_all_procedures(self, ignore_errors=False):\n'
               '        """ Creates all the stored procedures into the '
               'database\n'
               '        \n'
               "        {{'\\n        '.join(procedure.name for procedure in "
               'database._procedure_list)}}\n'
               '        \n'
               '        """\n'
               '        %for procedure in database._procedure_list:\n'
               '        '
               'self.create_procedure_{{procedure.name}}(ignore_errors)\n'
               '        %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=810,
          lineno=828,
          tokens=72,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='drop_all_procedures',
          body='def drop_all_procedures(self, ignore_errors=False):\n'
               '        """ Drops all the stored procedures from the database\n'
               '        \n'
               "        {{'\\n        '.join(procedure.name for procedure in "
               'database._procedure_list)}}\n'
               '        \n'
               '        """\n'
               '        %for procedure in reversed(database._procedure_list):\n'
               '        self.drop_procedure_{{procedure.name}}(ignore_errors)\n'
               '        %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=811,
          lineno=846,
          tokens=78,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='create_trigger_',
          body='def create_trigger_{{table._name}}_{{trigger.name}}(self, '
               'ignore_errors=False):\n'
               '        """ Creates trigger '
               '{{table.__class__.__name__}}.{{trigger.name}} in the database\n'
               '        """\n'
               '        statement_list = '
               '{{repr(format.format_create_trigger(trigger))}}\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute_statement_list(cursor, '
               'statement_list, ignore_errors)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=812,
          lineno=855,
          tokens=78,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='drop_trigger_',
          body='def drop_trigger_{{table._name}}_{{trigger.name}}(self, '
               'ignore_errors=False):\n'
               '        """ Drops trigger '
               '{{table.__class__.__name__}}.{{trigger.name}} from the '
               'database\n'
               '        """\n'
               '        statement_list = '
               '{{repr(format.format_drop_trigger(trigger))}}\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute_statement_list(cursor, '
               'statement_list, ignore_errors)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=813,
          lineno=870,
          tokens=114,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='create_all_triggers',
          body='def create_all_triggers(self, ignore_errors=False):\n'
               '        """ Creates the triggers for all the tables in the '
               'database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'database._table_list if table._creatable and '
               'table._trigger_list)}}\n'
               '        \n'
               '        """\n'
               '        %for table in database._table_list:\n'
               '        %if table._creatable:\n'
               '        %for trigger in table._trigger_list:\n'
               '        '
               'self.create_trigger_{{table._name}}_{{trigger.name}}(ignore_errors)\n'
               '        %end\n'
               '        %end\n'
               '        %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=814,
          lineno=886,
          tokens=117,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='drop_all_triggers',
          body='def drop_all_triggers(self, ignore_errors=False):\n'
               '        """ Drops the triggers for all the tables from the '
               'database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'reversed(database._table_list) if table._creatable and '
               'table._trigger_list)}}\n'
               '        \n'
               '        """\n'
               '        %for table in reversed(database._table_list):\n'
               '        %if table._creatable:\n'
               '        %for trigger in table._trigger_list:\n'
               '        '
               'self.drop_trigger_{{table._name}}_{{trigger.name}}(ignore_errors)\n'
               '        %end\n'
               '        %end\n'
               '        %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=815,
          lineno=906,
          tokens=70,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='create_table_',
          body='def create_table_{{table._name}}(self, ignore_errors=False):\n'
               '        """ Creates table {{table.__class__.__name__}} in the '
               'database\n'
               '        """\n'
               '        statement_list = '
               '{{repr(format.format_create_table(table, database))}}\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute_statement_list(cursor, '
               'statement_list, ignore_errors)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=816,
          lineno=915,
          tokens=70,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='drop_table_',
          body='def drop_table_{{table._name}}(self, ignore_errors=False):\n'
               '        """ Drops table {{table.__class__.__name__}} from the '
               'database\n'
               '        """\n'
               '        statement_list = '
               '{{repr(format.format_drop_table(table, database))}}\n'
               '        with self.cursor() as cursor:\n'
               '            self.execute_statement_list(cursor, '
               'statement_list, ignore_errors)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=817,
          lineno=928,
          tokens=88,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='create_all_tables',
          body='def create_all_tables(self, ignore_errors=False):\n'
               '        """ Creates all the tables and views into the '
               'database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'database._table_list if table._creatable)}}\n'
               '        \n'
               '        """\n'
               '        %for table in database._table_list:\n'
               '        %if table._creatable:\n'
               '        self.create_table_{{table._name}}(ignore_errors)\n'
               '        %end\n'
               '        %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=818,
          lineno=942,
          tokens=91,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='drop_all_tables',
          body='def drop_all_tables(self, ignore_errors=False):\n'
               '        """ Drops all the tables and views from the database\n'
               '        \n'
               "        {{'\\n        '.join(table._name for table in "
               'reversed(database._table_list) if table._creatable)}}\n'
               '        \n'
               '        """\n'
               '        %for table in reversed(database._table_list):\n'
               '        %if table._creatable:\n'
               '        self.drop_table_{{table._name}}(ignore_errors)\n'
               '        %end\n'
               '        %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=819,
          lineno=958,
          tokens=73,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='create_all_languages',
          body='def create_all_languages(self, ignore_errors=True):\n'
               '        """ Creates all the procedural languages used in the '
               'procedures defined\n'
               '        """\n'
               "        %language_set = set(['plpgsql']) | "
               'set(procedure.language for procedure in '
               'database._procedure_list)\n'
               '        %for language in sorted(language_set):\n'
               '        self.create_language({{repr(language)}}, '
               'ignore_errors)\n'
               '        %end'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=820,
          lineno=970,
          tokens=52,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='create_structure',
          body='def create_structure(self, ignore_errors=False):\n'
               '        """ Creates the whole database structure\n'
               '        """\n'
               '        self.create_all_languages()\n'
               '        \n'
               '        self.create_all_tables(ignore_errors)\n'
               '        self.create_all_procedures(ignore_errors)\n'
               '        self.create_all_triggers(ignore_errors)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=821,
          lineno=981,
          tokens=45,
          depth=2,
          parent_id=None,
          category='function',
          summary=False,
          name='drop_structure',
          body='def drop_structure(self, ignore_errors=False):\n'
               '        """ Drops the whole database structure\n'
               '        """\n'
               '        self.drop_all_triggers(ignore_errors)\n'
               '        self.drop_all_procedures(ignore_errors)\n'
               '        self.drop_all_tables(ignore_errors)'),
 Fragment(document_cs='e97547f610cb75a3e8c41311a14da75a98d1cc9b67b661a23dcf5c3e6e477f17',
          id=822,
          lineno=1,
          tokens=571,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: '
               '{{abstraction_class_name}}(database.DatabaseAbstraction) '
               '{{table.__class__.__name__}}Record(record.Record)\n'
               '  Methods: __init__ add_{{table. add_{{table._name}} '
               'create_all_languages create_all_procedures create_all_tables '
               'create_all_triggers create_procedure_ create_structure '
               'create_table_ create_trigger_ delete_ delete_{{table._name}} '
               'dict drop_all_procedures drop_all_tables drop_all_triggers '
               'drop_procedure_ drop_structure drop_table_ drop_trigger_ find_ '
               'get_ get_{{table. get_{{table._name}} query_{{query_name}} '
               'truncate_ truncate_all_tables tuple update_ '
               'update_{{table._name}}\n'
               '  Variables and usages: Clauses DEBUG DataError '
               'DatabaseAbstraction DatabaseError Error IntegrityError '
               'InterfaceError InternalError LOG_SQL_ANALYSIS NA '
               'NotSupportedError OperationalError PROFILE_QUERIES '
               'ProgrammingError Record ValueError Warning _CONDITION_MAP '
               '_FIELD_LIST _GROUP_BY _HAVING_CONDITION_MAP _ORDER_BY_MAP '
               '_SQL_IDENTITY_INSERT_RELEASE_SAVEPOINT '
               '_SQL_IDENTITY_INSERT_ROLLBACK_SAVEPOINT '
               '_SQL_IDENTITY_INSERT_SAVEPOINT _TABLE_LIST '
               '_WHERE_CONDITION_MAP _column_default_map _column_list '
               '_column_name_list _condition_list _count _creatable _format '
               '_group_by _iter _list _name _nullable_column_name_set '
               '_order_by _primary_key _procedure_list '
               '_quoted_column_name_list _table_list _table_name _trigger_list '
               '_writable abstraction_class_name accessible '
               'accessible_column_list add_ add_record add_record_list '
               'argument_name backend clauses column condition_info '
               'condition_name_list constants create create_language cursor '
               'database dblayer default delete delete_record '
               'delete_record_list drop else end_time error '
               'execute_and_fetch_iter execute_and_fetch_one '
               'execute_statement_list field_info field_list format '
               'format_create_procedure format_create_table '
               'format_create_trigger format_drop_procedure format_drop_table '
               'format_drop_trigger format_expression format_order_by '
               'format_query format_query_condition_map '
               'format_query_order_by_map format_release_savepoint '
               'format_result format_rollback_to_savepoint format_savepoint '
               'format_select format_table_condition_map '
               'format_table_order_by_map format_truncate_table '
               'format_truncate_table_list formatted_order_by '
               'formatting_function_name generate_id get_record '
               'get_record_iter get_record_list get_table_list '
               'has_custom_default having ignore_errors import insert items '
               'join language language_set limit log_analysis name named new_ '
               'offset options order_by parameter_tuple procedure property '
               'query query_ query_constant_prefix query_field_list '
               'query_group_by query_having_condition_map query_name '
               'query_order_by_map query_table_list query_where_condition_map '
               'quote_name record record_class record_list record_or_id '
               'record_or_id_list repr reversed row_list runtime_conditions '
               'serial sorted sql_expression start_time statement_list suffix '
               'table table_column_name_list table_condition_map '
               'table_constant_prefix table_info table_list table_name '
               'table_order_by_map table_quoted_column_list time trigger '
               'update update_record update_record_list upper util '
               'value_expression where\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=823,
          lineno=4,
          tokens=15,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import datetimeimport dblayerfrom dblayer import constantsfrom '
               'dblayer import constants'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=824,
          lineno=1,
          tokens=7,
          depth=2,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Functions formatting pieces of SQL statements\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=825,
          lineno=12,
          tokens=5,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='### Quoting and escaping'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=826,
          lineno=15,
          tokens=32,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Quotes a table or field name for use in SQL statements\n'
               '    Names must not contain double quotes!Names must not '
               'contain special characters which need to be escaped!'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=827,
          lineno=25,
          tokens=14,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Quotes aliased table or field name for use in SQL statements\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=828,
          lineno=31,
          tokens=6,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Quotes a column reference\n    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=829,
          lineno=37,
          tokens=23,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Quotes a literal value for use in SQL statements\n'
               '    Cannot quote literal value: %r### Handling of parameter '
               'placeholders'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=830,
          lineno=59,
          tokens=34,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Replaces ? with the parameter placeholder acceptable by the '
               'database server\n'
               '    # NOTE: It does not replace inside string literals### '
               'Formatting of column definitions based on the database model'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=831,
          lineno=71,
          tokens=14,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Appends the DEFAULT and NOT NULL common type modifiers as '
               'needed\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=832,
          lineno=88,
          tokens=11,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns column type definition for the given custom column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=833,
          lineno=97,
          tokens=17,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns column type definition for the given primary key '
               'column\n'
               '    BIGSERIAL PRIMARY KEY'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=834,
          lineno=109,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns column type definition for the given foreign key '
               'column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=835,
          lineno=122,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given boolean '
               'column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=836,
          lineno=135,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given integer '
               'column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=837,
          lineno=153,
          tokens=14,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given float or '
               'double column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=838,
          lineno=170,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given decimal '
               'column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=839,
          lineno=191,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given boolean '
               'column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=840,
          lineno=208,
          tokens=12,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given date column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=841,
          lineno=221,
          tokens=17,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given datetime '
               'column\n'
               '    TIMESTAMP WITHOUT TIME ZONE'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=842,
          lineno=234,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given search '
               'document column\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=843,
          lineno=243,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the column type definition for the given column\n'
               '    ### Formatting of index creation based on the database '
               'model'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=844,
          lineno=271,
          tokens=26,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of a regular B-Tree based index\n'
               '    CREATE INDEX %s ON %s USING btree(%s);'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=845,
          lineno=284,
          tokens=133,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of a full text search index\n'
               '    COALESCE(new.%s, '
               "'')%s_%s_update_triggerfn_%s_%s_update_trigger\\\n"
               'CREATE FUNCTION %(procedure_name)s () RETURNS trigger AS $$\n'
               'BEGIN\n'
               '  new.%(search_document_column_name)s := '
               'to_tsvector(%(document_expression)s);\n'
               '  RETURN new;\n'
               'END\n'
               '$$ LANGUAGE plpgsql;\\\n'
               'CREATE INDEX %(index_name)s ON %(table_name)s \\\n'
               'USING gin(%(search_document_column_name)s);\\\n'
               'CREATE TRIGGER %(trigger_name)s \\\n'
               'BEFORE INSERT OR UPDATE \\\n'
               'ON %(table_name)s \\\n'
               'FOR EACH ROW \\\n'
               'EXECUTE PROCEDURE %(procedure_name)s ();'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=846,
          lineno=329,
          tokens=18,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of an index\n'
               '    ### Formatting of index removal based on the database '
               'model'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=847,
          lineno=347,
          tokens=14,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the statements to drop a regular B-Tree based index\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=848,
          lineno=357,
          tokens=34,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the statements to drop a full text search index\n'
               '    %s_%s_update_triggerfn_%s_%s_update_triggerDROP TRIGGER %s '
               'ON %s;'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=849,
          lineno=376,
          tokens=18,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of an index\n'
               '    ### Formatting of procedure definitions based on the '
               'database model'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=850,
          lineno=394,
          tokens=50,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the list of tuples of SQL statements and '
               'parameter_tuple to create a stored procedure\n'
               '    \\\n'
               'CREATE FUNCTION %(name)s (%(argument_list)s) RETURNS '
               '%(result)s\n'
               'BEGIN\n'
               '  %(body)s\n'
               'END\n'
               '$$ LANGUAGE %(language)s;'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=851,
          lineno=417,
          tokens=35,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the list of tuples of SQL statements and '
               'parameter_tuple to drop a stored procedure\n'
               '    DROP FUNCTION %s (%s);### Formatting of trigger '
               'definitions based on the database model'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=852,
          lineno=431,
          tokens=59,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the list of tuples of SQL statements and '
               'parameter_tuple to create a trigger\n'
               '    \\\n'
               'CREATE TRIGGER %(trigger_name)s \\\n'
               '%(timing)s %(event)s \\\n'
               'ON %(table_name)s \\\n'
               'FOR EACH %(scope)s \\\n'
               'EXECUTE PROCEDURE %(procedure_name)s '
               '(%(procedure_parameters)s);'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=853,
          lineno=477,
          tokens=37,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the list of tuples of SQL statements and '
               'parameter_tuple to drop a trigger\n'
               '    DROP TRIGGER %s ON %s%s;### Formatting of constraint '
               'definitions based on the database model'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=854,
          lineno=492,
          tokens=10,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of a primary key constraint\n    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=855,
          lineno=502,
          tokens=82,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of a foreign key constraint\n'
               '    # NOTE: We need to look up the cloned foreign key column '
               'by name to get the right object hereThe referenced table for '
               'foreign key column %s.%s has not been determined!Referenced '
               'table %r does not have a primary key column!FOREIGN KEY (%s) '
               'REFERENCES %s (%s) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE '
               'NO ACTION'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=856,
          lineno=527,
          tokens=10,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of a unique index constraint\n    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=857,
          lineno=537,
          tokens=9,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of a check constraint\n    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=858,
          lineno=547,
          tokens=18,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the definition of a constraint\n'
               '    ### Formatting of SQL statements based on the database '
               'model'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=859,
          lineno=567,
          tokens=62,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the list of tuples of SQL statements and '
               'parameter_tuple to create a table\n'
               '    # Collect list of column definitions# Collect list of '
               'constraint definitions# SQL CREATE TABLE statement and '
               'parameter_tupleCREATE TABLE %s (\\n%s) WITH (OIDS=FALSE);# '
               'Format CREATE INDEX statements# Prepare the parameter '
               'placeholders'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=860,
          lineno=613,
          tokens=29,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the list of tuples of SQL statements and '
               'parameter_tuple to drop a table\n'
               '    # Format DROP INDEX statements# Format statements to drop '
               'the table'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=861,
          lineno=634,
          tokens=17,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the list of tuples of SQL statements and '
               'parameter_tuple to truncate a table\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=862,
          lineno=643,
          tokens=33,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns the list of tuples of SQL statements and '
               'parameter_tuple to truncate multiple tables\n'
               '    ### Formatting SQL statements runtime (no database model '
               'available, only the record classes)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=863,
          lineno=655,
          tokens=66,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats the FROM clause of SQL SELECT statements\n'
               '    \n'
               '    Considers JOINs of all supported kind. Returns list of '
               'cross joined groups.\n'
               '    \n'
               '    # Single table, no aliases# New cross join group# Join to '
               'an existing cross join groupUnknown join type: %rTrying to '
               'append a new join to an empty cross join group!'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=864,
          lineno=706,
          tokens=42,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a SELECT SQL statement with the given clauses\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    SQL SELECT statements must have a field list!SQL SELECT '
               'statements must have source table(s) to select from!'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=865,
          lineno=754,
          tokens=102,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a INSERT SQL statement with the given clauses\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    SQL INSERT statements must have a field list!SQL INSERT '
               'statements do not have a where clause!SQL INSERT statements do '
               'not have a group_by clause!SQL INSERT statements do not have a '
               'having clause!SQL INSERT statements do not have an order_by '
               'clause!SQL INSERT statements do not have a limit clause!SQL '
               'INSERT statements do not have an offset clause!SQL INSERT '
               'statements can only work on a single table!'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=866,
          lineno=789,
          tokens=121,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a UPDATE SQL statement with the given clauses\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    SQL UPDATE statements must have a field list!SQL UPDATE '
               'statements should have a where clause! (Otherwise they would '
               'be dangerous.) Use a TRUE condition if you intentionally want '
               'to update all the records.SQL UPDATE statements do not have a '
               'group_by clause!SQL UPDATE statements do not have a having '
               'clause!SQL UPDATE statements do not have an order_by '
               'clause!SQL UPDATE statements do not have a limit clause!SQL '
               'UPDATE statements do not have an offset clause!SQL UPDATE '
               'statements can only work on a single table!'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=867,
          lineno=825,
          tokens=153,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a DELETE SQL statement with the given clauses\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    SQL DELETE statements do not have a field list!SQL DELETE '
               'statements should have a where clause! (Otherwise they would '
               'be dangerous.) Use a TRUE condition if you intentionally want '
               'to delete all the records or truncate the table instead.SQL '
               'DELETE statements do not have a group_by clause!SQL DELETE '
               'statements do not have a having clause!SQL DELETE statements '
               'do not have an order_by clause!SQL DELETE statements do not '
               'have a limit clause!SQL DELETE statements do not have an '
               'offset clause!SQL DELETE statements can only work on a single '
               'table!# NOTE: These functions should return None for SQL '
               'servers not needing# a savepoint to restore from an aborted '
               'transaction after failing queries'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=868,
          lineno=864,
          tokens=13,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a SAVEPOINT statement to preserve the current '
               'transaction state\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=869,
          lineno=870,
          tokens=26,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a RELEASE SAVEPOINT statement to free up resources '
               'for a\n'
               "    savepoint we don't want to rollback to anymore\n"
               '    \n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=870,
          lineno=878,
          tokens=31,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a ROLLBACK TO SAVEPOINT statement to roll back the\n'
               '    current transaction to a previous savepoint\n'
               '    \n'
               '    ROLLBACK TO SAVEPOINT '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=871,
          lineno=888,
          tokens=16,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a query result expression and defines its alias name\n'
               '    ### Functions and aggregates'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=872,
          lineno=1087,
          tokens=13,
          depth=5,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='(STRPOS(%s, %s) > 0)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=873,
          lineno=1179,
          tokens=8,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats an SQL function or aggregate\n    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=874,
          lineno=1231,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats an expression, which is either a column reference of '
               'a function\n'
               '    ### Formatting query conditions at runtime'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=875,
          lineno=1278,
          tokens=16,
          depth=1,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# NOTE: It can only be used with an sql_expression without '
               'parameter placeholders.'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=876,
          lineno=1286,
          tokens=16,
          depth=1,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# NOTE: It can only be used with an sql_expression without '
               'parameter placeholders.'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=877,
          lineno=1332,
          tokens=30,
          depth=6,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='%s @@ plainto_tsquery(?)# Keyword argument suffixes, SQL '
               'template and function to prepare# the expressions passed as '
               'parameters### Formatting query conditions'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=878,
          lineno=1362,
          tokens=55,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns formatted query condition\n'
               '    \n'
               '    Yields (argument_name, (suffix, formatting_function_name, '
               'value_expression))\n'
               '    tuples for each operator.\n'
               '    \n'
               '    # Equals to a given value# Name of the argument for this '
               'operator# Yield SQL argument name and SQL expression for this '
               'operator'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=879,
          lineno=1383,
          tokens=80,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns dictionaries mapping names of all possible query '
               'conditions\n'
               '    to the formatted SQL condition and parameter_tuple\n'
               '    \n'
               '    Returns (where_condition_map, having_condition_map)\n'
               '    \n'
               '    The returned dictionaries map all possible keyword '
               'argument names to\n'
               '    (suffix, sql_expression, prepare_value_function_name) '
               'tuples.\n'
               '    \n'
               '    # Process all the query conditions# Select the appropriate '
               'condition map# Append each possible operator for this '
               'condition'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=880,
          lineno=1410,
          tokens=21,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns a dictionary mapping all the possible ascending and '
               'descending \n'
               '    order by fields to their SQL expression\n'
               '    '),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=881,
          lineno=1424,
          tokens=56,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns formatted table column condition\n'
               '    \n'
               '    Yields (argument_name, (suffix, formatting_function_name, '
               'value_expression))\n'
               '    tuples for each operator.\n'
               '    \n'
               '    # Equals to a given value# Name of the argument for this '
               'operator# Yield SQL argument name and SQL expression for this '
               'operator'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=882,
          lineno=1445,
          tokens=62,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns dictionary mapping names of all possible column '
               'conditions\n'
               '    to the formatted SQL condition and parameter_tuple\n'
               '    \n'
               '    The returned dictionary maps all possible keyword argument '
               'names to\n'
               '    (suffix, sql_expression, prepare_value_function_name) '
               'tuples.\n'
               '    \n'
               '    # Process all the query conditions# Append each possible '
               'operator for this condition'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=883,
          lineno=1462,
          tokens=26,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Returns a dictionary mapping all the possible ascending and '
               'descending \n'
               '    order by columns to their SQL expression\n'
               '    ### Formatting queries at runtime'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=884,
          lineno=1490,
          tokens=185,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats a SELECT SQL statement at runtime for the actual '
               'conditions\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    Partial caching is done by the format_select function, but '
               'the evaluation\n'
               '    of the dynamic conditions cannot be cached. The actual '
               'runtime conditions\n'
               '    are the keywords parameters passed to the query method on '
               'the database\n'
               '    abstraction layer.\n'
               '    \n'
               '    Passing a tuple in the order_by parameter defines the '
               'record ordering.\n'
               "    Values can be condition names. Use '-' prefix for "
               'descending sort.\n'
               "    You can also use a redundant '+' prefix for ascending "
               'short.\n'
               '    \n'
               '    # Parse keyword parameters (actual runtime conditions) '
               'passed# Find the condition by nameQuery method received '
               'unknown condition: %s=%r# Format the condition# Append it to '
               'the clause# Where condition built up runtime# Having condition '
               'built up runtime# Join the conditions together# NOTE: The '
               'group_by expressions are formatted while the abstraction layer '
               'is generated.# Format order by items'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=885,
          lineno=1573,
          tokens=18,
          depth=4,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body=' Formats the items of an ORDER BY clause\n'
               '    Unparsable column order: %r'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=886,
          lineno=14,
          tokens=72,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='quote_name',
          body='def quote_name(name):\n'
               '    """ Quotes a table or field name for use in SQL '
               'statements\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert \'"\' not in name, \'Names must not contain '
               "double quotes!'\n"
               "        assert '\\\\' not in repr(name), (\n"
               "            'Names must not contain special characters which "
               "need to be escaped!')\n"
               '    return \'"%s"\' % name'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=887,
          lineno=24,
          tokens=43,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='quote_alias_name',
          body='def quote_alias_name(name, alias):\n'
               '    """ Quotes aliased table or field name for use in SQL '
               'statements\n'
               '    """\n'
               "    return '%s AS %s' % (quote_name(name), quote_name(alias))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=888,
          lineno=30,
          tokens=39,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='quote_table_column_name',
          body='def quote_table_column_name(table_name, column_name):\n'
               '    """ Quotes a column reference\n'
               '    """\n'
               "    return '%s.%s' % (quote_name(table_name), "
               'quote_name(column_name))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=889,
          lineno=36,
          tokens=196,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='quote_literal_value',
          body='def quote_literal_value(value):\n'
               '    """ Quotes a literal value for use in SQL statements\n'
               '    """\n'
               '    if value is None:\n'
               "        return 'NULL'\n"
               '    if isinstance(value, str):\n'
               '        return "E\'%s\'" % repr(value)[2: -1].replace("\'", '
               '"\'\'")\n'
               '    if isinstance(value, bool):\n'
               "        return 'true' if value else 'false'\n"
               '    if isinstance(value, (int, float)):\n'
               '        return str(value)\n'
               '    if isinstance(value, (datetime.time, datetime.date, '
               'datetime.datetime)):\n'
               '        return repr(value.isoformat())\n'
               '    if isinstance(value, datetime.timedelta):\n'
               "        return repr('%d day %f sec' % (value.days, "
               'value.seconds + 1e-6 * value.microseconds))\n'
               '    if isinstance(value, (tuple, list)):\n'
               "        return '(%s)' % (', '.join(map(quote_literal_value, "
               'value)))\n'
               "    raise ValueError('Cannot quote literal value: %r' % "
               '(value,))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=890,
          lineno=58,
          tokens=83,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='replace_parameter_placeholders',
          body='def replace_parameter_placeholders(sql):\n'
               '    """ Replaces ? with the parameter placeholder acceptable '
               'by the database server\n'
               '    """\n'
               '    # NOTE: It does not replace inside string literals\n'
               '    split_sql = sql.split("\'")\n'
               '    for i in range(0, len(split_sql), 2):\n'
               "        split_sql[i] = split_sql[i].replace('?', '%s')\n"
               '    return "\'".join(split_sql)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=891,
          lineno=70,
          tokens=111,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_default_not_null',
          body='def format_default_not_null(column, sql, parameter_list):\n'
               '    """ Appends the DEFAULT and NOT NULL common type modifiers '
               'as needed\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.BaseColumn)\n'
               '\n'
               '    if column.default is not None:\n'
               '        if isinstance(column.default, '
               'dblayer.model.function.BaseFunction):\n'
               "            sql.append('DEFAULT %s' % "
               'format_expression(column.default))\n'
               '        else:\n'
               "            sql.append('DEFAULT ?')\n"
               '            parameter_list.append(column.default)\n'
               '\n'
               '    if not column.null:\n'
               "        sql.append('NOT NULL')"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=892,
          lineno=87,
          tokens=44,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_custom_column',
          body='def format_custom_column(column):\n'
               '    """ Returns column type definition for the given custom '
               'column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.Custom)\n'
               '\n'
               '    return (column.sql_type, ())'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=893,
          lineno=96,
          tokens=63,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_primary_key_column',
          body='def format_primary_key_column(column):\n'
               '    """ Returns column type definition for the given primary '
               'key column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.PrimaryKey)\n'
               '\n'
               '    if column.serial:\n'
               "        return ('BIGSERIAL PRIMARY KEY', ())\n"
               '\n'
               "    return ('BIGINT NOT NULL', ())"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=894,
          lineno=108,
          tokens=79,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_foreign_key_column',
          body='def format_foreign_key_column(column):\n'
               '    """ Returns column type definition for the given foreign '
               'key column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.ForeignKey)\n'
               '\n'
               "    sql = ['BIGINT']\n"
               '    parameter_list = []\n'
               '    format_default_not_null(column, sql, parameter_list)\n'
               "    sql = ' '.join(sql)\n"
               '    return (sql, tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=895,
          lineno=121,
          tokens=77,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_boolean_column',
          body='def format_boolean_column(column):\n'
               '    """ Returns the column type definition for the given '
               'boolean column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.Boolean)\n'
               '\n'
               "    sql = ['BOOLEAN']\n"
               '    parameter_list = []\n'
               '    format_default_not_null(column, sql, parameter_list)\n'
               "    sql = ' '.join(sql)\n"
               '    return (sql, tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=896,
          lineno=134,
          tokens=124,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_integer_column',
          body='def format_integer_column(column):\n'
               '    """ Returns the column type definition for the given '
               'integer column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.Integer)\n'
               '\n'
               '    parameter_list = []\n'
               '    if not column.digits or column.digits <= 9:\n'
               "        sql = ['INTEGER']\n"
               '    elif column.digits <= 18:\n'
               "        sql = ['BIGINT']\n"
               '    else:\n'
               "        sql = ['NUMERIC(%d)' % column.digits]\n"
               '    format_default_not_null(column, sql, parameter_list)\n'
               "    sql = ' '.join(sql)\n"
               '    return (sql, tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=897,
          lineno=152,
          tokens=99,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_float_column',
          body='def format_float_column(column):\n'
               '    """ Returns the column type definition for the given float '
               'or double column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, dblayer.model.column.Float)\n'
               '\n'
               '    sql = []\n'
               '    parameter_list = []\n'
               '    if column.double:\n'
               "        sql = ['DOUBLE PRECISION']\n"
               '    else:\n'
               "        sql = ['REAL']\n"
               '    format_default_not_null(column, sql, parameter_list)\n'
               "    sql = ' '.join(sql)\n"
               '    return (sql, tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=898,
          lineno=169,
          tokens=143,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_decimal_column',
          body='def format_decimal_column(column):\n'
               '    """ Returns the column type definition for the given '
               'decimal column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.Decimal)\n'
               '\n'
               '    sql = []\n'
               '    parameter_list = []\n'
               '    if column.precision is not None:\n'
               '        if column.scale is not None:\n'
               "            sql = ['NUMERIC(%d, %d)' % (column.precision, "
               'column.scale)]\n'
               '        else:\n'
               "            sql = ['NUMERIC(%d)' % column.precision]\n"
               '    else:\n'
               '        assert not column.scale\n'
               "        sql = ['NUMERIC']\n"
               '    format_default_not_null(column, sql, parameter_list)\n'
               "    sql = ' '.join(sql)\n"
               '    return (sql, tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=899,
          lineno=190,
          tokens=103,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_text_column',
          body='def format_text_column(column):\n'
               '    """ Returns the column type definition for the given '
               'boolean column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, dblayer.model.column.Text)\n'
               '\n'
               '    sql = []\n'
               '    parameter_list = []\n'
               '    if column.maxlength:\n'
               "        sql = ['VARCHAR(%d)' % column.maxlength]\n"
               '    else:\n'
               "        sql = ['TEXT']\n"
               '    format_default_not_null(column, sql, parameter_list)\n'
               "    sql = ' '.join(sql)\n"
               '    return (sql, tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=900,
          lineno=207,
          tokens=77,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_date_column',
          body='def format_date_column(column):\n'
               '    """ Returns the column type definition for the given date '
               'column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, dblayer.model.column.Date)\n'
               '\n'
               "    sql = ['DATE']\n"
               '    parameter_list = []\n'
               '    format_default_not_null(column, sql, parameter_list)\n'
               "    sql = ' '.join(sql)\n"
               '    return (sql, tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=901,
          lineno=220,
          tokens=83,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_datetime_column',
          body='def format_datetime_column(column):\n'
               '    """ Returns the column type definition for the given '
               'datetime column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.Datetime)\n'
               '\n'
               "    sql = ['TIMESTAMP WITHOUT TIME ZONE']\n"
               '    parameter_list = []\n'
               '    format_default_not_null(column, sql, parameter_list)\n'
               "    sql = ' '.join(sql)\n"
               '    return (sql, tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=902,
          lineno=233,
          tokens=47,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_search_document_column',
          body='def format_search_document_column(column):\n'
               '    """ Returns the column type definition for the given '
               'search document column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.SearchDocument)\n'
               '\n'
               "    return ('tsvector', ())"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=903,
          lineno=242,
          tokens=54,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_column',
          body='def format_column(column):\n'
               '    """ Returns the column type definition for the given '
               'column\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(column, '
               'dblayer.model.column.BaseColumn)\n'
               '\n'
               '    formatter = '
               'COLUMN_FORMATTER_MAP[column.abstract_sql_column_type]\n'
               '    return formatter(column)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=904,
          lineno=270,
          tokens=110,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_create_btree_index',
          body='def format_create_btree_index(index):\n'
               '    """ Returns the definition of a regular B-Tree based '
               'index\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(index, '
               'dblayer.model.index.BaseIndex)\n'
               '\n'
               "    sql = 'CREATE INDEX %s ON %s USING btree(%s);' % (\n"
               "        quote_name('%s_%s' % (index.table._name, "
               'index.name)),\n'
               '        quote_name(index.table._name),\n'
               "        ', '.join(quote_name(column.name) for column in "
               'index.columns))\n'
               '    return [(sql, ())]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=905,
          lineno=283,
          tokens=215,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_create_full_text_search_index',
          body='def format_create_full_text_search_index(index):\n'
               '    """ Returns the definition of a full text search index\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(index, '
               'dblayer.model.index.FullTextSearchIndex)\n'
               '\n'
               '    document_expression = " || \' \' || ".join(\n'
               '        ("COALESCE(new.%s, \'\')" if column.null else '
               '"new.%s") % quote_name(column.name)\n'
               '        for column in index.columns)\n'
               '\n'
               '    variables = dict(\n'
               '        table_name=quote_name(index.table._name),\n'
               "        index_name=quote_name('%s_%s' % (index.table._name, "
               'index.name)),\n'
               "        trigger_name=quote_name('%s_%s_update_trigger' % "
               '(index.table._name, index.name)),\n'
               "        procedure_name=quote_name('fn_%s_%s_update_trigger' % "
               '(index.table._name, index.name)),\n'
               '        '
               'search_document_column_name=quote_name(index.name[:-6]),\n'
               '        document_expression=document_expression)\n'
               '\n'
               "    create_procedure_sql = '''\\\n"
               'CREATE FUNCTION %(procedure_name)s () RETURNS trigger AS $$\n'
               'BEGIN\n'
               '  new'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=906,
          lineno=304,
          tokens=142,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_create_full_text_search_index',
          body='.%(search_document_column_name)s := '
               'to_tsvector(%(document_expression)s);\n'
               '  RETURN new;\n'
               'END\n'
               "$$ LANGUAGE plpgsql;''' % variables\n"
               '\n'
               "    create_index_sql = '''\\\n"
               'CREATE INDEX %(index_name)s ON %(table_name)s \\\n'
               "USING gin(%(search_document_column_name)s);''' % variables\n"
               '\n'
               "    create_trigger_sql = '''\\\n"
               'CREATE TRIGGER %(trigger_name)s \\\n'
               'BEFORE INSERT OR UPDATE \\\n'
               'ON %(table_name)s \\\n'
               'FOR EACH ROW \\\n'
               "EXECUTE PROCEDURE %(procedure_name)s ();''' % variables\n"
               '\n'
               '    statements = [\n'
               '        (create_procedure_sql, ()),\n'
               '        (create_index_sql, ()),\n'
               '        (create_trigger_sql, ())]\n'
               '\n'
               '    return statements'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=907,
          lineno=328,
          tokens=54,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_create_index',
          body='def format_create_index(index):\n'
               '    """ Returns the definition of an index\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(index, '
               'dblayer.model.index.BaseIndex)\n'
               '\n'
               '    formatter = '
               'CREATE_INDEX_FORMATTER_MAP[index.__class__.__name__]\n'
               '    return formatter(index)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=908,
          lineno=346,
          tokens=76,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_drop_btree_index',
          body='def format_drop_btree_index(index):\n'
               '    """ Returns the statements to drop a regular B-Tree based '
               'index\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(index, '
               'dblayer.model.index.BaseIndex)\n'
               '\n'
               "    sql = 'DROP INDEX %s;' % quote_name('%s_%s' % "
               '(index.table._name, index.name))\n'
               '    return [(sql, ())]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=909,
          lineno=356,
          tokens=178,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_drop_full_text_search_index',
          body='def format_drop_full_text_search_index(index):\n'
               '    """ Returns the statements to drop a full text search '
               'index\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(index, '
               'dblayer.model.index.FullTextSearchIndex)\n'
               '\n'
               '    table_name = quote_name(index.table._name)\n'
               "    index_name = quote_name('%s_%s' % (index.table._name, "
               'index.name))\n'
               "    trigger_name = quote_name('%s_%s_update_trigger' % "
               '(index.table._name, index.name))\n'
               "    procedure_name = quote_name('fn_%s_%s_update_trigger' % "
               '(index.table._name, index.name))\n'
               '\n'
               '    statements = [\n'
               "        ('DROP TRIGGER %s ON %s;' % (trigger_name, "
               'table_name), ()),\n'
               "        ('DROP INDEX %s;' % index_name, ()),\n"
               "        ('DROP FUNCTION %s();' % procedure_name, ())]\n"
               '\n'
               '    return statements'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=910,
          lineno=375,
          tokens=54,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_drop_index',
          body='def format_drop_index(index):\n'
               '    """ Returns the definition of an index\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(index, '
               'dblayer.model.index.BaseIndex)\n'
               '\n'
               '    formatter = '
               'DROP_INDEX_FORMATTER_MAP[index.__class__.__name__]\n'
               '    return formatter(index)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=911,
          lineno=393,
          tokens=141,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_create_procedure',
          body='def format_create_procedure(procedure):\n'
               '    """ Returns the list of tuples of SQL statements and '
               'parameter_tuple to create a stored procedure\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(procedure, '
               'dblayer.model.procedure.BaseProcedure)\n'
               '\n'
               '    variables = dict(\n'
               '        name=quote_name(procedure.name),\n'
               '        language=quote_name(procedure.language),\n'
               "        argument_list=', '.join(procedure.argument_list),\n"
               '        result=procedure.result,\n'
               '        body=procedure.body)\n'
               '\n'
               "    sql = '''\\\n"
               'CREATE FUNCTION %(name)s (%(argument_list)s) RETURNS '
               '%(result)s\n'
               'BEGIN\n'
               '  %(body)s\n'
               'END\n'
               "$$ LANGUAGE %(language)s;''' % variables\n"
               '\n'
               '    return [(sql, ())]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=912,
          lineno=416,
          tokens=88,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_drop_procedure',
          body='def format_drop_procedure(procedure, cascade=False):\n'
               '    """ Returns the list of tuples of SQL statements and '
               'parameter_tuple to drop a stored procedure\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(procedure, '
               'dblayer.model.procedure.BaseProcedure)\n'
               '\n'
               "    sql = 'DROP FUNCTION %s (%s);' % (\n"
               '        quote_name(procedure.name),\n'
               "        ', '.join(procedure.argument_list))\n"
               '    return [(sql, ())]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=913,
          lineno=430,
          tokens=185,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_create_trigger',
          body='def format_create_trigger(trigger):\n'
               '    """ Returns the list of tuples of SQL statements and '
               'parameter_tuple to create a trigger\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(trigger, '
               'dblayer.model.trigger.BaseTrigger)\n'
               '\n'
               '    timing, event, scope = '
               'TRIGGER_FORMATTER_MAP[trigger.__class__.__name__]\n'
               '\n'
               '    variables = dict(\n'
               '        trigger_name=quote_name(trigger.name),\n'
               '        timing=timing,\n'
               '        event=event,\n'
               '        scope=scope,\n'
               '        table_name=quote_name(trigger.table._name),\n'
               '        procedure_name=quote_name(trigger.procedure_name),\n'
               "        procedure_parameters=', '.join(map(format_expression, "
               'trigger.procedure_parameters)))\n'
               '\n'
               "    sql = '''\\\n"
               'CREATE TRIGGER %(trigger_name)s \\\n'
               '%(timing)s %(event)s \\\n'
               'ON %(table_name)s \\\n'
               'FOR EACH %(scope)s \\\n'
               'EXECUTE PROCEDURE %(procedure_name)s '
               "(%(procedure_parameters)s);''' % variables\n"
               '    return [(sql, ())]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=914,
          lineno=476,
          tokens=91,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_drop_trigger',
          body='def format_drop_trigger(trigger, cascade=False):\n'
               '    """ Returns the list of tuples of SQL statements and '
               'parameter_tuple to drop a trigger\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(trigger, '
               'dblayer.model.trigger.BaseTrigger)\n'
               '\n'
               "    sql = 'DROP TRIGGER %s ON %s%s;' % (\n"
               '        quote_name(trigger.name),\n'
               '        quote_name(trigger.table._name),\n'
               "        ' CASCADE' if cascade else '')\n"
               '    return [(sql, ())]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=915,
          lineno=491,
          tokens=70,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_primary_key_constraint',
          body='def format_primary_key_constraint(constraint):\n'
               '    """ Returns the definition of a primary key constraint\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(constraint, '
               'dblayer.model.constraint.PrimaryKey)\n'
               '\n'
               "    sql = 'PRIMARY KEY (%s)' % (', "
               "'.join(quote_name(column.name) for column in "
               'constraint.columns))\n'
               '    return (sql, ())'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=916,
          lineno=501,
          tokens=236,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_foreign_key_constraint',
          body='def format_foreign_key_constraint(constraint):\n'
               '    """ Returns the definition of a foreign key constraint\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(constraint, '
               'dblayer.model.constraint.ForeignKey)\n'
               '\n'
               '    table = constraint.table\n'
               '\n'
               '    # NOTE: We need to look up the cloned foreign key column '
               'by name to get the right object here\n'
               '    fk_column_name = constraint.columns[0].name\n'
               '    fk_column = getattr(table, fk_column_name)\n'
               '\n'
               '    referenced_table = fk_column.referenced_table\n'
               "    assert referenced_table, 'The referenced table for foreign "
               "key column %s.%s has not been determined!' % "
               '(fk_column.table_class.__name__, fk_column.name)\n'
               '    pk_column = referenced_table._primary_key\n'
               "    assert pk_column, 'Referenced table %r does not have a "
               "primary key column!' % referenced_table._name\n"
               '    sql = (\n'
               "            'FOREIGN KEY (%s) REFERENCES %s (%s) MATCH SIMPLE "
               "'\n"
               "            'ON UPDATE NO ACTION ON DELETE NO ACTION' % (\n"
               '                quote_name(fk_column.name),\n'
               '                quote_name(referenced_table._name),\n'
               '                quote_name(pk_column.name)))\n'
               '    return (sql, ())'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=917,
          lineno=526,
          tokens=69,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_unique_constraint',
          body='def format_unique_constraint(constraint):\n'
               '    """ Returns the definition of a unique index constraint\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(constraint, '
               'dblayer.model.constraint.Unique)\n'
               '\n'
               "    sql = 'UNIQUE (%s)' % (', '.join(quote_name(column.name) "
               'for column in constraint.columns))\n'
               '    return (sql, ())'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=918,
          lineno=536,
          tokens=57,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_check_constraint',
          body='def format_check_constraint(constraint):\n'
               '    """ Returns the definition of a check constraint\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(constraint, '
               'dblayer.model.constraint.Check)\n'
               '\n'
               "    sql = 'CHECK %s' % "
               'format_expression(constraint.expression)\n'
               '    return (sql, ())'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=919,
          lineno=546,
          tokens=56,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_constraint',
          body='def format_constraint(constraint):\n'
               '    """ Returns the definition of a constraint\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(constraint, '
               'dblayer.model.constraint.BaseConstraint)\n'
               '\n'
               '    formatter = '
               'CONSTRAINT_FORMATTER_MAP[constraint.__class__.__name__]\n'
               '    return formatter(constraint)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=920,
          lineno=566,
          tokens=129,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_create_table',
          body='def format_create_table(table, database):\n'
               '    """ Returns the list of tuples of SQL statements and '
               'parameter_tuple to create a table\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(table, dblayer.model.table.Table)\n'
               '\n'
               '    quoted_table_name = quote_name(table._name)\n'
               '\n'
               '    definition_list = []\n'
               '    parameter_list = []\n'
               '\n'
               '    # Collect list of column definitions\n'
               '    for column in table._column_list:\n'
               '        definition, new_parameters = format_column(column)\n'
               '        definition_list.append(\n'
               "            '%s %s' % (\n"
               '                quote_name(column.name),\n'
               '                definition))\n'
               '        parameter_list.extend(new_parameters)\n'
               '\n'
               '    # Collect list of constraint definitions\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=921,
          lineno=587,
          tokens=183,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_create_table',
          body='    for constaint in table._constraint_list:\n'
               '        definition, new_parameters = '
               'format_constraint(constaint)\n'
               '        definition_list.append(\n'
               "            'CONSTRAINT %s %s' % (\n"
               "                quote_name('%s__%s' % (table._name, "
               'constaint.name)),\n'
               '                definition))\n'
               '        parameter_list.extend(new_parameters)\n'
               '\n'
               '    # SQL CREATE TABLE statement and parameter_tuple\n'
               "    sql = 'CREATE TABLE %s (\\n%s) WITH (OIDS=FALSE);' % (\n"
               '        quote_name(table._name), '
               "',\\n'.join(definition_list))\n"
               '    statements = [(sql, tuple(parameter_list))]\n'
               '\n'
               '    # Format CREATE INDEX statements\n'
               '    for index in table._index_list:\n'
               '        statements.extend(format_create_index(index))\n'
               '\n'
               '    # Prepare the parameter placeholders\n'
               '    statements = [\n'
               '        (replace_parameter_placeholders(sql), '
               'parameter_tuple)\n'
               '        for sql, parameter_tuple in statements]\n'
               '\n'
               '    return statements'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=922,
          lineno=612,
          tokens=122,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_drop_table',
          body='def format_drop_table(table, database, cascade=False):\n'
               '    """ Returns the list of tuples of SQL statements and '
               'parameter_tuple to drop a table\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(table, dblayer.model.table.Table)\n'
               '\n'
               '    statements = []\n'
               '\n'
               '    # Format DROP INDEX statements\n'
               '    for index in table._index_list:\n'
               '        statements.extend(format_drop_index(index))\n'
               '\n'
               '    # Format statements to drop the table\n'
               "    sql = 'DROP TABLE %s%s;' % (\n"
               '        quote_name(table._name),\n'
               "        ' CASCADE' if cascade else '')\n"
               '    statements.append((sql, ()))\n'
               '\n'
               '    return statements'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=923,
          lineno=633,
          tokens=64,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_truncate_table',
          body='def format_truncate_table(table, database):\n'
               '    """ Returns the list of tuples of SQL statements and '
               'parameter_tuple to truncate a table\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(table, dblayer.model.table.Table)\n'
               '\n'
               "    return [('TRUNCATE TABLE %s' % quote_name(table._name), "
               '())]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=924,
          lineno=642,
          tokens=88,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_truncate_table_list',
          body='def format_truncate_table_list(table_list, database):\n'
               '    """ Returns the list of tuples of SQL statements and '
               'parameter_tuple to truncate multiple tables\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        for table in table_list:\n'
               '            assert isinstance(table, '
               'dblayer.model.table.Table)\n'
               '\n'
               "    return [('TRUNCATE TABLE %s' % ', "
               "'.join(quote_name(table._name) for table in table_list if "
               'table._writable), ())]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=925,
          lineno=654,
          tokens=218,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_cross_join_group_list',
          body='def format_cross_join_group_list(clauses):\n'
               '    """ Formats the FROM clause of SQL SELECT statements\n'
               '    \n'
               '    Considers JOINs of all supported kind. Returns list of '
               'cross joined groups.\n'
               '    \n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               '\n'
               '    from_list = []\n'
               '    join_group = []\n'
               '\n'
               '    for source in clauses.table_list:\n'
               '\n'
               '        if isinstance(source, str):\n'
               '            # Single table, no aliases\n'
               '            if join_group:\n'
               "                from_list.append(' '.join(join_group))\n"
               '            join_group = [quote_name(source)]\n'
               '\n'
               '        elif len(source) == 2:\n'
               '            # New cross join group\n'
               '            table_name, alias_name = source\n'
               '            if join_group:\n'
               "                from_list.append(' '.join(join_group))\n"
               '            join_group = [quote_alias_name(table_name, '
               'alias_name)]\n'
               '\n'
               '        else:\n'
               '            # Join to an existing cross join group\n'
               '            (table_name,\n'
               '             alias_name,\n'
               '             join_type,\n'
               '             id_field_name,\n'
               '             referer_table_name,\n'
               '             fk_field_name) = source\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=926,
          lineno=689,
          tokens=122,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_cross_join_group_list',
          body='\n'
               '            if constants.DEBUG:\n'
               '                assert join_type in constants.JOIN_TYPES, '
               "'Unknown join type: %r' % (join_type,)\n"
               "                assert join_group, 'Trying to append a new "
               "join to an empty cross join group!'\n"
               '\n'
               "            join_group.append('%s %s ON %s = %s' % (\n"
               '                join_type,\n'
               '                quote_alias_name(table_name, alias_name),\n'
               '                quote_table_column_name(table_name, '
               'id_field_name),\n'
               '                quote_table_column_name(referer_table_name, '
               'fk_field_name)))\n'
               '\n'
               "    from_list.append(' '.join(join_group))\n"
               '\n'
               '    return from_list'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=927,
          lineno=705,
          tokens=244,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_select',
          body='def format_select(clauses, cache={}):\n'
               '    """ Formats a SELECT SQL statement with the given clauses\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               "        assert clauses.field_list, 'SQL SELECT statements must "
               "have a field list!'\n"
               "        assert clauses.table_list, 'SQL SELECT statements must "
               "have source table(s) to select from!'\n"
               '\n'
               '    sql = cache.get(clauses)\n'
               '    if sql is not None:\n'
               '        return sql\n'
               '\n'
               '    cross_join_group_list = '
               'format_cross_join_group_list(clauses)\n'
               '\n'
               '    sql = [\n'
               "        'SELECT',\n"
               "        ', '.join(clauses.field_list),\n"
               "        'FROM',\n"
               "        ', '.join(cross_join_group_list)]\n"
               '\n'
               '    if clauses.where:\n'
               "        sql.extend(('WHERE', clauses.where))\n"
               '\n'
               '    if clauses.group_by:\n'
               "        sql.extend(('GROUP BY', ', '.join(clauses.group_by)))\n"
               '\n'
               '    if clauses.having:\n'
               "        sql.extend(('HAVING', clauses.having))\n"
               '\n'
               '    if clauses.order_by:\n'
               "        sql.extend(('ORDER BY', ', '.join(clauses.order_by)))\n"
               '\n'
               '    if clauses.limit:\n'
               "        sql.extend(('LIMIT', str(clauses.limit)))\n"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=928,
          lineno=742,
          tokens=48,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_select',
          body='\n'
               '    if clauses.offset:\n'
               "        sql.extend(('OFFSET', str(clauses.offset)))\n"
               '\n'
               "    sql = ' '.join(sql)\n"
               '    sql = replace_parameter_placeholders(sql)\n'
               '\n'
               '    cache[clauses] = sql\n'
               "    return sql + ';'"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=929,
          lineno=753,
          tokens=210,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_insert',
          body='def format_insert(clauses, cache={}):\n'
               '    """ Formats a INSERT SQL statement with the given clauses\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               "        assert clauses.field_list, 'SQL INSERT statements must "
               "have a field list!'\n"
               "        assert not clauses.where, 'SQL INSERT statements do "
               "not have a where clause!'\n"
               "        assert not clauses.group_by, 'SQL INSERT statements do "
               "not have a group_by clause!'\n"
               "        assert not clauses.having, 'SQL INSERT statements do "
               "not have a having clause!'\n"
               "        assert not clauses.order_by, 'SQL INSERT statements do "
               "not have an order_by clause!'\n"
               "        assert not clauses.limit, 'SQL INSERT statements do "
               "not have a limit clause!'\n"
               "        assert not clauses.offset, 'SQL INSERT statements do "
               "not have an offset clause!'\n"
               "        assert len(clauses.table_list) == 1, 'SQL INSERT "
               "statements can only work on a single table!'\n"
               '\n'
               '    sql = cache.get(clauses)\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=930,
          lineno=771,
          tokens=103,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_insert',
          body='    if sql is not None:\n'
               '        return sql\n'
               '\n'
               '    sql = [\n'
               "        'INSERT INTO',\n"
               '        quote_name(clauses.table_list[0]),\n'
               "        '(%s)' % ', '.join(map(quote_name, "
               'clauses.field_list)),\n'
               "        'VALUES',\n"
               "        '(%s)' % ', '.join('?' * len(clauses.field_list))]\n"
               '\n'
               "    sql = ' '.join(sql) + ';'\n"
               '    sql = replace_parameter_placeholders(sql)\n'
               '\n'
               '    cache[clauses] = sql\n'
               '    return sql'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=931,
          lineno=788,
          tokens=229,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_update',
          body='def format_update(clauses, cache={}):\n'
               '    """ Formats a UPDATE SQL statement with the given clauses\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               "        assert clauses.field_list, 'SQL UPDATE statements must "
               "have a field list!'\n"
               "        assert clauses.where, 'SQL UPDATE statements should "
               'have a where clause! (Otherwise they would be dangerous.) Use '
               'a TRUE condition if you intentionally want to update all the '
               "records.'\n"
               "        assert not clauses.group_by, 'SQL UPDATE statements do "
               "not have a group_by clause!'\n"
               "        assert not clauses.having, 'SQL UPDATE statements do "
               "not have a having clause!'\n"
               "        assert not clauses.order_by, 'SQL UPDATE statements do "
               "not have an order_by clause!'\n"
               "        assert not clauses.limit, 'SQL UPDATE statements do "
               "not have a limit clause!'\n"
               "        assert not clauses.offset, 'SQL UPDATE statements do "
               "not have an offset clause!'\n"
               "        assert len(clauses.table_list) == 1, 'SQL UPDATE "
               "statements can only work on a single table!'\n"
               '\n'
               '    sql = cache.get(clauses)\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=932,
          lineno=806,
          tokens=93,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_update',
          body='    if sql is not None:\n'
               '        return sql\n'
               '\n'
               '    sql = [\n'
               "        'UPDATE',\n"
               '        quote_name(clauses.table_list[0]),\n'
               "        'SET',\n"
               "        ', '.join('%s=?' % quote_name(name) for name in "
               'clauses.field_list),\n'
               "        'WHERE',\n"
               '        clauses.where]\n'
               '\n'
               "    sql = ' '.join(sql) + ';'\n"
               '    sql = replace_parameter_placeholders(sql)\n'
               '\n'
               '    cache[clauses] = sql\n'
               '    return sql'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=933,
          lineno=824,
          tokens=236,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_delete',
          body='def format_delete(clauses, cache={}):\n'
               '    """ Formats a DELETE SQL statement with the given clauses\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(clauses, '
               'dblayer.backend.base.clauses.Clauses)\n'
               "        assert not clauses.field_list, 'SQL DELETE statements "
               "do not have a field list!'\n"
               "        assert clauses.where, 'SQL DELETE statements should "
               'have a where clause! (Otherwise they would be dangerous.) Use '
               'a TRUE condition if you intentionally want to delete all the '
               "records or truncate the table instead.'\n"
               "        assert not clauses.group_by, 'SQL DELETE statements do "
               "not have a group_by clause!'\n"
               "        assert not clauses.having, 'SQL DELETE statements do "
               "not have a having clause!'\n"
               "        assert not clauses.order_by, 'SQL DELETE statements do "
               "not have an order_by clause!'\n"
               "        assert not clauses.limit, 'SQL DELETE statements do "
               "not have a limit clause!'\n"
               "        assert not clauses.offset, 'SQL DELETE statements do "
               "not have an offset clause!'\n"
               "        assert len(clauses.table_list) == 1, 'SQL DELETE "
               "statements can only work on a single table!'\n"
               '\n'
               '    sql = cache.get(clauses)\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=934,
          lineno=842,
          tokens=70,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_delete',
          body='    if sql is not None:\n'
               '        return sql\n'
               '\n'
               '    sql = [\n'
               "        'DELETE FROM',\n"
               '        quote_name(clauses.table_list[0]),\n'
               "        'WHERE',\n"
               '        clauses.where]\n'
               '\n'
               "    sql = ' '.join(sql) + ';'\n"
               '    sql = replace_parameter_placeholders(sql)\n'
               '\n'
               '    cache[clauses] = sql\n'
               '    return sql'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=935,
          lineno=863,
          tokens=33,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_savepoint',
          body='def format_savepoint(name):\n'
               '    """ Formats a SAVEPOINT statement to preserve the current '
               'transaction state\n'
               '    """\n'
               "    return 'SAVEPOINT ' + quote_name(name);"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=936,
          lineno=869,
          tokens=48,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_release_savepoint',
          body='def format_release_savepoint(name):\n'
               '    """ Formats a RELEASE SAVEPOINT statement to free up '
               'resources for a\n'
               "    savepoint we don't want to rollback to anymore\n"
               '    \n'
               '    """\n'
               "    return 'RELEASE SAVEPOINT ' + quote_name(name);"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=937,
          lineno=877,
          tokens=50,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_rollback_to_savepoint',
          body='def format_rollback_to_savepoint(name):\n'
               '    """ Formats a ROLLBACK TO SAVEPOINT statement to roll back '
               'the\n'
               '    current transaction to a previous savepoint\n'
               '    \n'
               '    """\n'
               "    return 'ROLLBACK TO SAVEPOINT ' + quote_name(name);"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=938,
          lineno=887,
          tokens=58,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_result',
          body='def format_result(result):\n'
               '    """ Formats a query result expression and defines its '
               'alias name\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(result, '
               'dblayer.model.query.BaseQueryResult)\n'
               '\n'
               "    return '%s AS %s' % (format_expression(result.expression), "
               'quote_name(result.name))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=939,
          lineno=898,
          tokens=40,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_custom_function',
          body='def format_custom_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               '    return function.args[0]'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=940,
          lineno=906,
          tokens=42,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_var_function',
          body='def format_var_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               '    return quote_name(function.args[0])'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=941,
          lineno=914,
          tokens=48,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_function',
          body='def format_not_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               "    return '(NOT %s)' % format_expression(function.args[0])"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=942,
          lineno=922,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_and_function',
          body='def format_and_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) > 0\n'
               '\n'
               "    return '(%s)' % ' AND '.join(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=943,
          lineno=930,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_or_function',
          body='def format_or_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) > 0\n'
               '\n'
               "    return '(%s)' % ' OR '.join(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=944,
          lineno=938,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_equal_function',
          body='def format_equal_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s = %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=945,
          lineno=946,
          tokens=52,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_equal_function',
          body='def format_not_equal_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s <> %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=946,
          lineno=954,
          tokens=52,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_less_than_function',
          body='def format_less_than_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s < %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=947,
          lineno=962,
          tokens=54,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_less_than_or_equal_function',
          body='def format_less_than_or_equal_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s <= %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=948,
          lineno=970,
          tokens=52,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_greater_than_function',
          body='def format_greater_than_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s > %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=949,
          lineno=978,
          tokens=54,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_greater_than_or_equal_function',
          body='def format_greater_than_or_equal_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s >= %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=950,
          lineno=986,
          tokens=76,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_in_function',
          body='def format_in_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               '    a, b = function.args\n'
               '    b = tuple(b)\n'
               '    if b:\n'
               "        return '(%s IN %s)' % (format_expression(a), "
               'quote_literal_value(b))\n'
               "    return 'FALSE'"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=951,
          lineno=998,
          tokens=78,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_in_function',
          body='def format_not_in_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               '    a, b = function.args\n'
               '    b = tuple(b)\n'
               '    if b:\n'
               "        return '(%s NOT IN %s)' % (format_expression(a), "
               'quote_literal_value(b))\n'
               "    return 'TRUE'"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=952,
          lineno=1010,
          tokens=48,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_neg_function',
          body='def format_neg_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               "    return '(-%s)' % format_expression(function.args[0])"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=953,
          lineno=1018,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_add_function',
          body='def format_add_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) > 1\n'
               '\n'
               "    return '(%s)' % ' + '.join(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=954,
          lineno=1026,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_sub_function',
          body='def format_sub_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) > 1\n'
               '\n'
               "    return '(%s)' % ' - '.join(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=955,
          lineno=1034,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_mul_function',
          body='def format_mul_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) > 1\n'
               '\n'
               "    return '(%s)' % ' * '.join(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=956,
          lineno=1042,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_div_function',
          body='def format_div_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) > 1\n'
               '\n'
               "    return '(%s)' % ' / '.join(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=957,
          lineno=1050,
          tokens=52,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_concat_function',
          body='def format_concat_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) > 0\n'
               '\n'
               "    return 'CONCAT(%s)' % ', '.join(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=958,
          lineno=1058,
          tokens=52,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_left_function',
          body='def format_left_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return 'LEFT(%s, %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=959,
          lineno=1066,
          tokens=52,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_right_function',
          body='def format_right_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return 'RIGHT(%s, %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=960,
          lineno=1074,
          tokens=56,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_substring_function',
          body='def format_substring_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert 2 <= len(function.args) <= 3\n'
               '\n'
               "    return 'SUBSTR(%s)' % ', '.join(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=961,
          lineno=1082,
          tokens=57,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_contains_function',
          body='def format_contains_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(STRPOS(%s, %s) > 0)' % "
               'tuple(map(format_expression, function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=962,
          lineno=1090,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_like_function',
          body='def format_like_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s LIKE %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=963,
          lineno=1098,
          tokens=53,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_like_function',
          body='def format_not_like_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s NOT LIKE %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=964,
          lineno=1106,
          tokens=51,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_match_function',
          body='def format_match_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s ~ %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=965,
          lineno=1114,
          tokens=53,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_match_function',
          body='def format_not_match_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s !~ %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=966,
          lineno=1122,
          tokens=53,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_full_text_search_function',
          body='def format_full_text_search_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 2\n'
               '\n'
               "    return '(%s @@ %s)' % tuple(map(format_expression, "
               'function.args))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=967,
          lineno=1130,
          tokens=55,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_coalesce_function',
          body='def format_coalesce_function(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) > 0\n'
               '\n'
               "    return 'COALESCE(%s)' % ', "
               "'.join(tuple(map(format_expression, function.args)))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=968,
          lineno=1138,
          tokens=49,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_count_aggregate',
          body='def format_count_aggregate(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               "    return 'COUNT(%s)' % format_expression(function.args[0])"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=969,
          lineno=1146,
          tokens=49,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_min_aggregate',
          body='def format_min_aggregate(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               "    return 'MIN(%s)' % format_expression(function.args[0])"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=970,
          lineno=1154,
          tokens=49,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_max_aggregate',
          body='def format_max_aggregate(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               "    return 'MAX(%s)' % format_expression(function.args[0])"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=971,
          lineno=1162,
          tokens=49,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_sum_aggregate',
          body='def format_sum_aggregate(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               "    return 'SUM(%s)' % format_expression(function.args[0])"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=972,
          lineno=1170,
          tokens=50,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_avg_aggregate',
          body='def format_avg_aggregate(function):\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '        assert len(function.args) == 1\n'
               '\n'
               "    return 'AVG(%s)' % format_expression(function.args[0])"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=973,
          lineno=1178,
          tokens=53,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_function',
          body='def format_function(function):\n'
               '    """ Formats an SQL function or aggregate\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(function, '
               'dblayer.model.function.BaseFunction)\n'
               '\n'
               '    formatter = '
               'FUNCTION_FORMATTER_MAP[function.__class__.__name__]\n'
               '    return formatter(function)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=974,
          lineno=1230,
          tokens=119,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_expression',
          body='def format_expression(expression):\n'
               '    """ Formats an expression, which is either a column '
               'reference of a function\n'
               '    """\n'
               '    if isinstance(expression, '
               'dblayer.model.column.BaseColumn):\n'
               '        if expression.table is None:\n'
               '            return quote_name(expression.name)\n'
               '        return quote_table_column_name(expression.table._name, '
               'expression.name)\n'
               '\n'
               '    if isinstance(expression, '
               'dblayer.model.index.FullTextSearchIndex):\n'
               '        return quote_table_column_name(expression.table._name, '
               "expression.name + '_document')\n"
               '\n'
               '    if isinstance(expression, '
               'dblayer.model.function.BaseFunction):\n'
               '        return format_function(expression)\n'
               '\n'
               '    return quote_literal_value(expression)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=975,
          lineno=1249,
          tokens=44,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_eq_condition',
          body='def format_eq_condition(sql_expression, value):\n'
               '    if value is None:\n'
               "        return ('%s IS NULL' % sql_expression, ())\n"
               "    return ('%s = ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=976,
          lineno=1255,
          tokens=45,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_ne_condition',
          body='def format_ne_condition(sql_expression, value):\n'
               '    if value is None:\n'
               "        return ('%s IS NOT NULL' % sql_expression, ())\n"
               "    return ('%s <> ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=977,
          lineno=1261,
          tokens=25,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_gt_condition',
          body='def format_gt_condition(sql_expression, value):\n'
               "    return ('%s > ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=978,
          lineno=1265,
          tokens=25,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_lt_condition',
          body='def format_lt_condition(sql_expression, value):\n'
               "    return ('%s < ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=979,
          lineno=1269,
          tokens=25,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_ge_condition',
          body='def format_ge_condition(sql_expression, value):\n'
               "    return ('%s >= ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=980,
          lineno=1273,
          tokens=25,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_le_condition',
          body='def format_le_condition(sql_expression, value):\n'
               "    return ('%s <= ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=981,
          lineno=1277,
          tokens=65,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_range_condition',
          body='def format_range_condition(sql_expression, value):\n'
               '    # NOTE: It can only be used with an sql_expression without '
               'parameter placeholders.\n'
               '    lower_limit, upper_limit = value\n'
               '    return (\n'
               "        '%s >= ? AND %s < ?' % (sql_expression, "
               'sql_expression),\n'
               '        (lower_limit, upper_limit))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=982,
          lineno=1285,
          tokens=68,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_in_range_condition',
          body='def format_not_in_range_condition(sql_expression, value):\n'
               '    # NOTE: It can only be used with an sql_expression without '
               'parameter placeholders.\n'
               '    lower_limit, upper_limit = value\n'
               '    return (\n'
               "        '(%s < ? OR %s > ?)' % (sql_expression, "
               'sql_expression),\n'
               '        (lower_limit, upper_limit))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=983,
          lineno=1293,
          tokens=42,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_in_condition',
          body='def format_in_condition(sql_expression, value):\n'
               '    value = tuple(value)\n'
               '    if not value:\n'
               "        return ('FALSE', ())\n"
               "    return ('%s IN ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=984,
          lineno=1300,
          tokens=44,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_in_condition',
          body='def format_not_in_condition(sql_expression, value):\n'
               '    value = tuple(value)\n'
               '    if not value:\n'
               "        return ('TRUE', ())\n"
               "    return ('%s NOT IN ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=985,
          lineno=1307,
          tokens=25,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_like_condition',
          body='def format_like_condition(sql_expression, value):\n'
               "    return ('%s LIKE ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=986,
          lineno=1311,
          tokens=27,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_like_condition',
          body='def format_not_like_condition(sql_expression, value):\n'
               "    return ('%s NOT LIKE ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=987,
          lineno=1315,
          tokens=30,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_similar_to_condition',
          body='def format_similar_to_condition(sql_expression, value):\n'
               "    return ('%s SIMILAR TO ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=988,
          lineno=1319,
          tokens=32,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_similar_to_condition',
          body='def format_not_similar_to_condition(sql_expression, value):\n'
               "    return ('%s NOT SIMILAR TO ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=989,
          lineno=1323,
          tokens=25,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_match_condition',
          body='def format_match_condition(sql_expression, value):\n'
               "    return ('%s ~ ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=990,
          lineno=1327,
          tokens=27,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_not_match_condition',
          body='def format_not_match_condition(sql_expression, value):\n'
               "    return ('%s !~ ?' % sql_expression, (value,))"),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=991,
          lineno=1331,
          tokens=30,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_search_condition',
          body='def format_search_condition(sql_expression, value):\n'
               "    return ('%s @@ plainto_tsquery(?)' % sql_expression, "
               '(value,))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=992,
          lineno=1361,
          tokens=133,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_query_condition',
          body='def format_query_condition(condition):\n'
               '    """ Returns formatted query condition\n'
               '    \n'
               '    Yields (argument_name, (suffix, formatting_function_name, '
               'value_expression))\n'
               '    tuples for each operator.\n'
               '    \n'
               '    """\n'
               '    if 0:\n'
               '        assert isinstance(condition, '
               'dblayer.model.query.Result)\n'
               '\n'
               '    value_expression = '
               'format_expression(condition.expression)\n'
               '\n'
               '    # Equals to a given value\n'
               '    for suffix, formatting_function in '
               'QUERY_CONDITION_OPERATOR_LIST:\n'
               '        # Name of the argument for this operator\n'
               '        argument_name = condition.name + suffix\n'
               '\n'
               '        # Yield SQL argument name and SQL expression for this '
               'operator\n'
               '        yield (argument_name, (suffix, '
               'formatting_function.__name__, value_expression))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=993,
          lineno=1382,
          tokens=168,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_query_condition_map',
          body='def format_query_condition_map(query):\n'
               '    """ Returns dictionaries mapping names of all possible '
               'query conditions\n'
               '    to the formatted SQL condition and parameter_tuple\n'
               '    \n'
               '    Returns (where_condition_map, having_condition_map)\n'
               '    \n'
               '    The returned dictionaries map all possible keyword '
               'argument names to\n'
               '    (suffix, sql_expression, prepare_value_function_name) '
               'tuples.\n'
               '    \n'
               '    """\n'
               '    # Process all the query conditions\n'
               '    where_condition_map = {}\n'
               '    having_condition_map = {}\n'
               '    for condition in query._column_list + '
               'query._condition_list:\n'
               '\n'
               '        # Select the appropriate condition map\n'
               '        if condition.after_group_by:\n'
               '            condition_map = having_condition_map\n'
               '        else:\n'
               '            condition_map = where_condition_map\n'
               '\n'
               '        # Append each possible operator for this condition\n'
               '        '
               'condition_map.update(format_query_condition(condition))\n'
               '\n'
               '    return (where_condition_map, having_condition_map)'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=994,
          lineno=1409,
          tokens=114,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_query_order_by_map',
          body='def format_query_order_by_map(query):\n'
               '    """ Returns a dictionary mapping all the possible '
               'ascending and descending \n'
               '    order by fields to their SQL expression\n'
               '    """\n'
               '    order_by_map = {}\n'
               '    for query_result in query._column_list + '
               'query._condition_list:\n'
               '        name = query_result.name\n'
               '        sql_expression = '
               'format_expression(query_result.expression)\n'
               '        order_by_map[name] = sql_expression\n'
               "        order_by_map['+' + name] = sql_expression\n"
               "        order_by_map['-' + name] = sql_expression + ' DESC'\n"
               '    return order_by_map'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=995,
          lineno=1423,
          tokens=135,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_table_column_condition',
          body='def format_table_column_condition(column):\n'
               '    """ Returns formatted table column condition\n'
               '    \n'
               '    Yields (argument_name, (suffix, formatting_function_name, '
               'value_expression))\n'
               '    tuples for each operator.\n'
               '    \n'
               '    """\n'
               '    if 0:\n'
               '        assert isinstance(condition, '
               'dblayer.model.query.BaseColumn)\n'
               '\n'
               '    value_expression = format_expression(column)\n'
               '\n'
               '    # Equals to a given value\n'
               '    for suffix, formatting_function in '
               'QUERY_CONDITION_OPERATOR_LIST:\n'
               '        # Name of the argument for this operator\n'
               '        argument_name = column.name + suffix\n'
               '\n'
               '        # Yield SQL argument name and SQL expression for this '
               'operator\n'
               '        yield (argument_name, (suffix, '
               'formatting_function.__name__, value_expression))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=996,
          lineno=1444,
          tokens=104,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_table_condition_map',
          body='def format_table_condition_map(table):\n'
               '    """ Returns dictionary mapping names of all possible '
               'column conditions\n'
               '    to the formatted SQL condition and parameter_tuple\n'
               '    \n'
               '    The returned dictionary maps all possible keyword argument '
               'names to\n'
               '    (suffix, sql_expression, prepare_value_function_name) '
               'tuples.\n'
               '    \n'
               '    """\n'
               '    # Process all the query conditions\n'
               '    condition_map = {}\n'
               '    for column in table._column_list:\n'
               '        # Append each possible operator for this condition\n'
               '        '
               'condition_map.update(format_table_column_condition(column))\n'
               '\n'
               '    return condition_map'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=997,
          lineno=1461,
          tokens=105,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_table_order_by_map',
          body='def format_table_order_by_map(table):\n'
               '    """ Returns a dictionary mapping all the possible '
               'ascending and descending \n'
               '    order by columns to their SQL expression\n'
               '    """\n'
               '    order_by_map = {}\n'
               '    for column in table._column_list:\n'
               '        name = column.name\n'
               '        sql_expression = format_expression(column)\n'
               '        order_by_map[name] = sql_expression\n'
               "        order_by_map['+' + name] = sql_expression\n"
               "        order_by_map['-' + name] = sql_expression + ' DESC'\n"
               '    return order_by_map'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=998,
          lineno=1477,
          tokens=249,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_query',
          body='def format_query(\n'
               '        table_list,\n'
               '        field_list,\n'
               '        where_condition_map,\n'
               '        having_condition_map,\n'
               '        group_by,\n'
               '        order_by_map,\n'
               '        runtime_where_condition,\n'
               '        runtime_having_condition,\n'
               '        runtime_conditions,\n'
               '        order_by,\n'
               '        limit,\n'
               '        offset):\n'
               '    """ Formats a SELECT SQL statement at runtime for the '
               'actual conditions\n'
               '    \n'
               '    Returns (sql, parameter_tuple)\n'
               '    \n'
               '    Partial caching is done by the format_select function, but '
               'the evaluation\n'
               '    of the dynamic conditions cannot be cached. The actual '
               'runtime conditions\n'
               '    are the keywords parameters passed to the query method on '
               'the database\n'
               '    abstraction layer.\n'
               '    \n'
               '    Passing a tuple in the order_by parameter defines the '
               'record ordering.\n'
               "    Values can be condition names. Use '-' prefix for "
               'descending sort.\n'
               "    You can also use a redundant '+' prefix for ascending "
               'short.\n'
               '    \n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(runtime_conditions, dict)\n'
               '        assert isinstance(where_condition_map, dict)\n'
               '        assert isinstance(having_condition_map, dict)\n'
               '        assert isinstance(group_by, (tuple, list))\n'
               '\n'
               '    # Parse keyword parameters (actual runtime conditions) '
               'passed\n'
               '    where = []\n'
               '    having = []\n'
               '    parameter_list = []\n'
               '    for name, value in runtime_conditions.items():\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=999,
          lineno=1515,
          tokens=177,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_query',
          body='\n'
               '        if value is NA:\n'
               '            continue\n'
               '\n'
               '        # Find the condition by name\n'
               '        condition = where_condition_map.get(name)\n'
               '        if condition:\n'
               '            clause = where\n'
               '        else:\n'
               '            condition = having_condition_map.get(name)\n'
               '            if condition:\n'
               '                clause = having\n'
               '            else:\n'
               '                raise TypeError(\n'
               "                    'Query method received unknown condition: "
               "%s=%r' %\n"
               '                    (name, value))\n'
               '\n'
               '        # Format the condition\n'
               '        suffix, formatting_function, value_expression = '
               'condition\n'
               '        sql_expression, sql_parameters = '
               'formatting_function(value_expression, value)\n'
               '\n'
               '        # Append it to the clause\n'
               '        clause.append(sql_expression)\n'
               '        parameter_list.extend(sql_parameters)\n'
               '\n'
               '    # Where condition built up runtime\n'
               '    if runtime_where_condition is not None:\n'
               '        sql_expression = '
               'format_expression(runtime_where_condition)\n'
               '        where.append(sql_expression)\n'
               '\n'
               '    # Having condition built up runtime\n'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=1000,
          lineno=1546,
          tokens=167,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_query',
          body='    if runtime_having_condition is not None:\n'
               '        sql_expression = '
               'format_expression(runtime_having_condition)\n'
               '        having.append(sql_expression)\n'
               '\n'
               '    # Join the conditions together\n'
               "    where = ' AND '.join(where)\n"
               "    having = ' AND '.join(having)\n"
               '\n'
               '    # NOTE: The group_by expressions are formatted while the '
               'abstraction layer is generated.\n'
               '\n'
               '    # Format order by items\n'
               '    formatted_order_by = format_order_by(order_by_map, '
               'order_by)\n'
               '\n'
               '    clauses = dblayer.backend.base.clauses.Clauses(\n'
               '        table_list=table_list,\n'
               '        field_list=field_list,\n'
               '        where=where,\n'
               '        group_by=group_by,\n'
               '        having=having,\n'
               '        order_by=formatted_order_by,\n'
               '        limit=limit,\n'
               '        offset=offset)\n'
               '\n'
               '    return (format_select(clauses), tuple(parameter_list))'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=1001,
          lineno=1572,
          tokens=103,
          depth=1,
          parent_id=None,
          category='function',
          summary=False,
          name='format_order_by',
          body='def format_order_by(order_by_map, order_by):\n'
               '    """ Formats the items of an ORDER BY clause\n'
               '    """\n'
               '    if constants.DEBUG:\n'
               '        assert isinstance(order_by_map, dict)\n'
               '        assert isinstance(order_by, (tuple, list))\n'
               '\n'
               '    formatted_order_by = list(map(order_by_map.get, '
               'order_by))\n'
               '\n'
               '    if None in formatted_order_by:\n'
               '        raise ValueError(\n'
               "            'Unparsable column order: %r' %\n"
               '            order_by[formatted_order_by.index(None)])\n'
               '\n'
               '    return formatted_order_by'),
 Fragment(document_cs='ebae74d5b7eb11c27a18ce730775620fef7b4bdf7753276e926af075160e78af',
          id=1002,
          lineno=1,
          tokens=788,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Functions: format_add_function format_and_function '
               'format_avg_aggregate format_boolean_column '
               'format_check_constraint format_coalesce_function format_column '
               'format_concat_function format_constraint '
               'format_contains_function format_count_aggregate '
               'format_create_btree_index format_create_full_text_search_index '
               'format_create_index format_create_procedure '
               'format_create_table format_create_trigger '
               'format_cross_join_group_list format_custom_column '
               'format_custom_function format_date_column '
               'format_datetime_column format_decimal_column '
               'format_default_not_null format_delete format_div_function '
               'format_drop_btree_index format_drop_full_text_search_index '
               'format_drop_index format_drop_procedure format_drop_table '
               'format_drop_trigger format_eq_condition format_equal_function '
               'format_expression format_float_column '
               'format_foreign_key_column format_foreign_key_constraint '
               'format_full_text_search_function format_function '
               'format_ge_condition format_greater_than_function '
               'format_greater_than_or_equal_function format_gt_condition '
               'format_in_condition format_in_function format_insert '
               'format_integer_column format_le_condition format_left_function '
               'format_less_than_function format_less_than_or_equal_function '
               'format_like_condition format_like_function format_lt_condition '
               'format_match_condition format_match_function '
               'format_max_aggregate format_min_aggregate format_mul_function '
               'format_ne_condition format_neg_function '
               'format_not_equal_function format_not_function '
               'format_not_in_condition format_not_in_function '
               'format_not_in_range_condition format_not_like_condition '
               'format_not_like_function format_not_match_condition '
               'format_not_match_function format_not_similar_to_condition '
               'format_or_function format_order_by format_primary_key_column '
               'format_primary_key_constraint format_query '
               'format_query_condition format_query_condition_map '
               'format_query_order_by_map format_range_condition '
               'format_release_savepoint format_result format_right_function '
               'format_rollback_to_savepoint format_savepoint '
               'format_search_condition format_search_document_column '
               'format_select format_similar_to_condition format_sub_function '
               'format_substring_function format_sum_aggregate '
               'format_table_column_condition format_table_condition_map '
               'format_table_order_by_map format_text_column '
               'format_truncate_table format_truncate_table_list '
               'format_unique_constraint format_update format_var_function '
               'quote_alias_name quote_literal_value quote_name '
               'quote_table_column_name replace_parameter_placeholders\n'
               '  Variables and usages: Add AfterDeleteRow '
               'AfterDeleteStatement AfterInsertOrUpdateRow '
               'AfterInsertOrUpdateStatement AfterInsertRow '
               'AfterInsertStatement AfterUpdateRow AfterUpdateStatement And '
               'Avg BaseColumn BaseConstraint BaseFunction BaseIndex '
               'BaseProcedure BaseQueryResult BaseTrigger BeforeDeleteRow '
               'BeforeDeleteStatement BeforeInsertOrUpdateRow '
               'BeforeInsertOrUpdateStatement BeforeInsertRow '
               'BeforeInsertStatement BeforeUpdateRow BeforeUpdateStatement '
               'Boolean COLUMN_FORMATTER_MAP CONSTRAINT_FORMATTER_MAP '
               'CREATE_INDEX_FORMATTER_MAP Check Clauses Coalesce Concat '
               'Contains Count Custom DEBUG DROP_INDEX_FORMATTER_MAP Date '
               'Datetime Decimal Div Equal FUNCTION_FORMATTER_MAP Float '
               'ForeignKey FullTextSearch FullTextSearchIndex GreaterThan '
               'GreaterThanOrEqual In Index Integer JOIN_TYPES Left LessThan '
               'LessThanOrEqual Like Match Max Min Mul NA Neg Not NotEqual '
               'NotIn NotLike NotMatch Or PrimaryKey '
               'QUERY_CONDITION_OPERATOR_LIST Result Right SearchDocument Sub '
               'Substring Sum TRIGGER_FORMATTER_MAP Table Text TypeError '
               'Unique ValueError Var _column_list _condition_list '
               '_constraint_list _index_list _name _primary_key _writable '
               'abstract_sql_column_type after_group_by alias alias_name '
               'append args argument_list argument_name backend base body '
               'cache cascade clause clauses column column_name columns '
               'condition condition_map constaint constants constraint '
               'create_index_sql create_procedure_sql create_trigger_sql '
               'cross_join_group_list database date datetime days dblayer '
               'default definition definition_list digits document_expression '
               'double event expression extend field_list fk_column '
               'fk_column_name fk_field_name formatted_order_by formatter '
               'formatting_function from_list function getattr group_by having '
               'having_condition_map id_field_name index index_name isoformat '
               'items join join_group join_type language limit lower_limit '
               'maxlength microseconds model name new_parameters null offset '
               'order_by order_by_map parameter_list parameter_tuple pk_column '
               'precision procedure procedure_name procedure_parameters query '
               'query_result quoted_table_name range referenced_table '
               'referer_table_name replace repr result runtime_conditions '
               'runtime_having_condition runtime_where_condition scale scope '
               'search_document_column_name seconds serial source split '
               'split_sql sql_expression sql_parameters sql_type statements '
               'suffix table table_class table_list table_name time timedelta '
               'timing trigger trigger_name tuple update upper_limit value '
               'value_expression variables where where_condition_map\n'),
 Fragment(document_cs='ff1cb950dd3ca78b26d27ba1078671219d0c799b3378060140f75f0bc4fd8b6e',
          id=1003,
          lineno=43,
          tokens=23,
          depth=1,
          parent_id=None,
          category='class',
          summary=False,
          name='NA',
          body='class NA:\n'
               '    def __repr__(self):\n'
               "        return 'NA'\n"
               '\n'
               '    __str__ = __repr__'),
 Fragment(document_cs='ff1cb950dd3ca78b26d27ba1078671219d0c799b3378060140f75f0bc4fd8b6e',
          id=1004,
          lineno=4,
          tokens=2,
          depth=1,
          parent_id=None,
          category='dependency',
          summary=False,
          name='',
          body='import os'),
 Fragment(document_cs='ff1cb950dd3ca78b26d27ba1078671219d0c799b3378060140f75f0bc4fd8b6e',
          id=1005,
          lineno=6,
          tokens=98,
          depth=0,
          parent_id=None,
          category='documentation',
          summary=False,
          name='',
          body='# Enables various sanity checks useful for development# '
               'Encoding used to convert strings to unicode whenever needed# '
               'Full pathname of the code generator template directory# Range '
               'of database ID values (actual values are chosen randomly)# '
               'Number of rows should be loaded from the database at once# Log '
               'analysis of SQL statements before executing them# Measure the '
               'wall clock execution time of queries# Maximum number of '
               'retries on a failing single row INSERT query# Undefined '
               'singleton, used to detect missing parameters# while allowing '
               'None as a valid value'),
 Fragment(document_cs='ff1cb950dd3ca78b26d27ba1078671219d0c799b3378060140f75f0bc4fd8b6e',
          id=1006,
          lineno=44,
          tokens=11,
          depth=3,
          parent_id=None,
          category='function',
          summary=False,
          name='__repr__',
          body="def __repr__(self):\n        return 'NA'"),
 Fragment(document_cs='ff1cb950dd3ca78b26d27ba1078671219d0c799b3378060140f75f0bc4fd8b6e',
          id=1007,
          lineno=1,
          tokens=64,
          depth=0,
          parent_id=None,
          category='summary',
          summary=True,
          name='',
          body='  Classes: NA\n'
               '  Methods: __repr__\n'
               '  Variables and usages: CURSOR_ARRAYSIZE DATABASE_ID_RANGE '
               'DEBUG ENCODING GENERATOR_TEMPLATE_DIRECTORY_PATH INNER_JOIN '
               'JOIN_TYPES LEFT_JOIN LOG_SQL_ANALYSIS LOG_SQL_RESULT_ROWS '
               'LOG_SQL_STATEMENTS MAX_INSERT_RETRY_COUNT PROFILE_QUERIES '
               'dirname environ join path\n')]