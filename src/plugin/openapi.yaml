openapi: 3.0.1
info:
  title: AskYourCode
  description: Provide summarization and targeted search of a software project to aid in reasoning.
  version: 'v1'
servers:
  - url: https://plugin.askyourcode.ai
paths:
  /project:
    post:
      operationId: download
      summary: Download and index a software project for content retrieval.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/downloadRequest'
      responses:
        "200":
          description: Archive downloaded, indexing of its contents is in progress.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/downloadResponse'
  /project/{project_id}:
    delete:
      operationId: delete
      summary: Delete all information about a project.
      parameters:
        - in: path
          name: project_id
          schema:
            type: string
          required: true
          description: Project ID
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                type: string
  /project/{project_id}/summarize:
    get:
      operationId: summarize
      summary: Summarize the project, a directory, a file or code construct (class, method, function, variable).
      parameters:
        - in: path
          name: project_id
          schema:
            type: string
          required: true
          description: Project ID
        - in: query
          name: path
          schema:
            type: string
          required: false
          description: Matches the head of the file or folder path. Whole project if missing.
          example: README.md
        - in: query
          name: tail
          schema:
            type: string
          required: false
          description: Matches the tail of the file path. For example ".extension" or "filename.extension".
          example: .md
        - in: query
          name: name
          schema:
            type: string
          required: false
          description: Fully qualified or simple name of the code construct.
      responses:
        "200":
          description: Summary
          content:
            text/plain:
              schema:
                type: string
        "204":
          description: No match found
          content:
            text/plain:
              schema:
                type: string
  /project/{project_id}/search:
    get:
      operationId: search
      summary: Searches for documentation or a code construct (class, method, function, variable).
      parameters:
        - in: path
          name: project_id
          schema:
            type: string
          required: true
          description: Project ID
        - in: query
          name: path
          schema:
            type: string
          required: false
          description: Matches the head of the file or folder path. Whole project if missing.
          example: README.md
        - in: query
          name: tail
          schema:
            type: string
          required: false
          description: Matches the tail of the file path. For example ".extension" or "filename.extension".
          example: .md
        - in: query
          name: name
          schema:
            type: string
          required: false
          description: Fully qualified or simple name of the code construct.
        - in: query
          name: text
          schema:
            type: string
          required: false
          description: Free text search on the file contents.
      responses:
        "200":
          description: Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/searchResponse'
        "204":
          description: No match found

components:
  schemas:
    downloadRequest:
      type: object
      required:
        - url
      properties:
        url:
          type: string
          description: URL of the ZIP archive to download directly without authentication.
          required: true
    downloadResponse:
      type: object
      required:
        - project_id
      properties:
        project_id:
          type: string
          description: Project ID (GUID)
          required: true
        progress:
          type: integer
          description: Percentage progress of content indexing. Missing if the indexing has completed. Text based search results may be incomplete until indexing finishes.
    summarizeResponse:
      type: object
      required:
        - summary
      properties:
        results:
          type: string
          description: Summary
          required: true
    searchResponse:
      type: object
      required:
        - path
        - lineno
        - text
      properties:
        path:
          type: string
          description: Path of the file, where / is the root of the project.
        lineno:
          type: integer
          description: Line number to reconstruct the order of text fragments inside the same file.
        text:
          type: string
          description: Code or text fragment.
        name:
          type: string
          description: Name of the class, method, function or variable. (program code only)
        progress:
          type: integer
          description: Percentage progress of content indexing. Missing if the indexing has completed. Signifies an incomplete search if present.
